<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>TBS Manual</title>
    <style type="text/css">
<!--
.pagebreak {
	page-break-before:always;
}
.tbsname {
	font-size: 12px;
	font-weight: bolder;
	color: #4D3A81;
}
.norm {
	margin-left: 30px;
	padding: 5px;
	border: 1px solid #999999;
	margin-top: 12px;
	margin-bottom: 12px;
}
.decal {
	margin-left: 20px;
	padding: 2px;
	margin-top: 3px;
}
h1 {
	margin-top: 8px;
	margin-bottom: 8px;
	font-size: 16px;
}
h2 {
	font-weight:normal;
	font-size: 16px;
	text-decoration: underline;
	background-color: #6699CC;
	margin-top: 20px;
	margin-bottom: 20px;
}
h3 {
	margin-top: 20px;
	margin-bottom: 20px;
	font-weight:normal;
	font-size: 16px;
	text-decoration: underline;
}
h4 {
	text-decoration: underline;
	font-weight:normal;
	font-size: 12px;
	margin-top: 8px;
	margin-bottom: 6px;
}
h5 {
	font-weight: bold;
	font-size: 12px;
	margin-top: 3px;
	margin-bottom: 3px;
}
h6 {
	text-decoration: underline;
	font-weight:normal;
	font-size: 12px;
	margin-top: 8px;
	margin-bottom: 6px;
}
th {
	text-decoration: underline;
	text-align:left;
	vertical-align:top;
	font-weight:normal;
}
pre {
	font-size:12px;
}
.title-1c {
	font-weight: bold;
}
.txt-small {
	font-size: 10px;
}
.txt-code {
	font-family: "Courier New", Courier, mono;
	font-size: 12px;
}
.txt-tiny {
	font-size: 9px;
	margin-top:0;
	margin-bottom:0;
}
table {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
}
td {
	margin-top:0;
}
p {
	margin-top:4px;
}
body {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
}
.opt-name {
	color: #990000;
}
a.opt-name {
	color: #990000;
	text-decoration:none;
}
a.opt-name:hover {
	color: #990000;
	text-decoration:underline;
}
.opt-value {
	color: #000099;
}
.opt-html {
	color: #006600;
}
.opt-type {
	font-style: italic;
	color: #0033CC;
}
.border-0 {
	border: 1px solid #999999;
}
.border-1 {
	border: 1px solid #FF3399;
}
.border-2 {
	border: 1px solid #336699;
}
.border-3 {
	border: 1.5px solid #CC6600;
}
.border-sep {
	border-bottom-width: 1px;
	border-bottom-style: solid;
	border-bottom-color: #999999;
}
.versioning {
	background-color: #EAEAEA;
	margin: 12px 0 12px 0;
	padding: 0 0 2px 0;
}
.versioning > p {
	/* <p> inside a class "versioning" */
	margin: 0;
}
.list-mini {
	margin: 0;
	padding-left: 20px;
}
.blockzone {
	border: 1px dotted #666666;
	padding: 2px;
	margin: 2px;
}
.blocksep {
	border-left-width: 1px;
	border-left-style: dotted;
	border-left-color: #666666;
}
.contextual {
	padding: 1px;
	border: 1px dotted #6699CC;
}
.note {
	background-color: #D9FFD9; /* green */
	border: thin solid #00EC9F;
	padding: 2px;
	margin-top: 3px;
	margin-left: 20px;
}
.warning {
	background-color: #f4dfdf; /* light red */
}
-->
</style>
  </head>
  <body bgcolor="#FFFFFF">
    <div id="main-body">
      <div class="txt-tiny" style="display:inline-block; float:left;">
        <table class="txt-tiny" cellspacing="0" cellpadding="0" border="0">
          <tbody>
            <tr>
              <td width="50">Site:</td>
              <td><a href="http://www.tinybutstrong.com" target="_top">www.tinybutstrong.com</a></td>
            </tr>
            <tr>
              <td>Date:</td>
              <td>2022-02-13</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div style="margin:auto; width:500px; text-align:center;">
        <h1>TinyButStrong Documentation</h1>
        <div class="txt-tiny">version 3.13</div>
        <div style="margin-top:10px;">Template Engine for Pro and Beginners<br>
          PHP 8<br>
          PHP 7<br>
          PHP 5 </div>
      </div>
      <h2>Table of Contents:</h2>
      <div class="norm">
        <table cellspacing="0" border="0">
          <tbody>
            <tr class="title-1c">
              <td width="300"> Subject</td>
              <td>Description</td>
            </tr>
            <tr>
              <td>&nbsp;</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td><a href="#introduction" class="title-1c">• Introduction</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#principles">Basic principles</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#installation">Installation</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#examples">Mini examples</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td><a href="#php_side" class="title-1c">• PHP side</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;• To begin</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_instanciate">create
                  a new TBS object</a></td>
              <td> for working with templates</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_loadtemplate"><span
                    class="txt-small">method</span> LoadTemplate()</a></td>
              <td>load the contents of a template from a file</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_mergeblock"><span
                    class="txt-small">method</span> MergeBlock()</a></td>
              <td>merge a part of the template with a data source</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_show"><span
                    class="txt-small">method</span> Show()</a></td>
              <td>automatic processing and display of the result</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;• Advanced</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_getblocksource"><span
                    class="txt-small">method</span> GetBlockSource()</a></td>
              <td>returns the source of the definition of a block</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_mergefield"><span
                    class="txt-small">method</span> MergeField()</a></td>
              <td>merge a specific field with a value</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_setoption"><span
                    class="txt-small">method</span> SetOption()</a></td>
              <td>set TBS options</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_getoption"><span
                    class="txt-small">method</span> GetOption()</a></td>
              <td>get TBS options</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_resetvarref"><span
                    class="txt-small">method</span> ResetVarRef()</a></td>
              <td>reset the VarRef property</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_getvarrefitem"><span
                    class="txt-small">method</span> GetVarRefItem()</a></td>
              <td>get an item in the VarRef property</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_setvarrefitem"><span
                    class="txt-small">method</span> SetVarRefItem()</a></td>
              <td>set an item in the VarRef property</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_replacefields"><span
                    class="txt-small">method</span> ReplaceFields()</a></td>
              <td>replace simple fields with long fields</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_getattvalue"><span
                    class="txt-small">method</span> GetAttValue()</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_plugin"><span
                    class="txt-small">method</span> PlugIn()</a></td>
              <td>execute a plug-in's action </td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_varref"><span
                    class="txt-small">property</span> VarRef</a></td>
              <td>set variables to be merged with automatic fields</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_assigned"><span
                    class="txt-small">property</span> Assigned</a></td>
              <td>prepares information for a subsequent merging</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_source"><span
                    class="txt-small">property</span> Source</a></td>
              <td>returns the current contents of the result</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#php_tplvars"><span
                    class="txt-small">property</span> TplVars </a></td>
              <td>returns template variables </td>
            </tr>
            <tr id="v202_oop_plan">
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#php_oop">Object
                  Oriented Programming (OOP) </a></td>
              <td>to make TBS OOP friendly </td>
            </tr>
            <tr>
              <td><a href="#html_side" class="title-1c">• Template side</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;• TBS fields</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_field">Definition
                  and syntax</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_field_prm">Parameters</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_field_prm_order">Order
                  of processing parameters</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_field_auto">Automatic
                  fields</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_field_special">Special
                  automatic fields</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;• TBS blocks</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#html_block">Definition
                  and syntaxes </a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_prm">Parameters</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_section">Sections
                  of block</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_auto">Automatic
                  blocks </a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_parallel">Parallel
                  merge (dynamic columns) </a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_serial">Serial
                  display (in columns) </a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_subblock">Subblocks</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_subauto">Automatic
                  subblocks</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <a href="#html_block_dynsb">Subblocks
                  with dynamic queries</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp; • Miscellaneous</td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#html_subtemplate">Subtemplates</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#html_conditional">
                  Conditional display overview</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td><a href="#coding" class="title-1c">• Improve TBS by coding</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#coding_extended_methods">Extended
                  methods</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#coding_block_alias">Block
                  alias</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#plugins_db">Data Reader
                  Plug-ins</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#plugins_tbs">Other plug-ins</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td><a href="#summaries" class="title-1c">• Summary</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#appendix_field">TBS Field's
                  parameters</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#appendix_block">TBS Block's
                  parameters</a></td>
              <td>&nbsp;</td>
            </tr>
            <tr>
              <td>&nbsp;&nbsp;&nbsp;&nbsp;<a href="#appendix_specialname">Names
                  of Special Fields and Blocks</a></td>
              <td>&nbsp;</td>
            </tr>
          </tbody>
        </table>
      </div>
      <h2 id="introduction" class="pagebreak">Introduction:</h2>
      <p><strong>TinyButStrong</strong> (TBS) is a PHP class useful to develop
        an application in a clean way, separating PHP scripts and XML/HTML/Text
        files. With TBS, the files are generated dynamically by merging a
        template with data. It is called a Template Engine. </p>
      <p> The name TBS comes from the fact that this tool contains only 8
        functions and yet, it is very powerful. It allows you to merge templates
        with your PHP variables or your MySQL, PostgreSQL, or SQLite.</p>
      <p> TBS has been engineered so that you can develop your templates with
        ease using any visual editors (like Dreamweaver or FrontPage). But if
        you are used to designing your templates with a text editor, it is nice
        as well. TBS also enables you to create JavaScript dynamically.</p>
      <p> As the name of it tells, TBS is easy to use, strong and fast. It is
        completely <span style="color:#009900">°~° freeware °~°</span>. </p>
      <h3><a id="principles"></a>Basic principles:</h3>
      <p>On the HTML side (or other file type):</p>
      <p class="decal"> You design a page which does not necessarily contain any
        PHP scripts, nor any programming. In this page you place TBS tags in the
        places where you want to display the dynamic data. This page is called a
        'template'.</p>
      <p class="decal"> There are two types of tags: the <a href="#html_field">'fields'</a>
        which are used to display dynamic data items, and the <a href="#html_block">'blocks'</a>
        which are used to define an area, mostly in order to display records
        from a data source.</p>
      <p> On the PHP side:</p>
      <p class="decal"> You use an object TBS variable to manage the merge of
        your template with the data. At the end, TBS shows the result of the
        merge. </p>
      <h3><a id="installation"></a>Installation:</h3>
      <ol>
        <li>Copy the file <span class="opt-html">tbs_class.php</span> in a
          directory of your Web site.</li>
        <li>At the beginning of your PHP program, add the lines:
          <pre class="decal txt-code">include_once(<span class="opt-value">'tbs_class.php'</span>);
<span class="opt-name">$TBS</span> = new clsTinyButStrong;     </pre>
          <p><span class="txt-small">Remark: if the TBS file tbs_class.php is in
              a different directory than your application, then you have to
              precise the directory in front of the TBS file name.</span></p>
        </li>
      </ol>
      <h4>Explanations and technical details:</h4>
      <p>TinyButStrong is a library written in PHP, it's a component to be
        referenced in your own PHP programs. In technical terms, TinyButStrong
        is a PHP 'class' ; the name of this class is clsTinyButStrong.</p>
      <p> The variable $TBS that you add at the beginning of your PHP program
        enables you to execute the merge of your template from your PHP
        application. In technical terms, the variable $TBS is an 'instance' of
        the clsTinyButStrong class. </p>
      <h3><a id="examples"></a>Mini examples:</h3>
      <p>Example 1: </p>
      <table cellspacing="4" cellpadding="2" border="0">
        <tbody>
          <tr>
            <th width="320">Html Template</th>
            <th width="320">Php Program</th>
            <th>Result</th>
          </tr>
          <tr>
            <td valign="top">
              <pre class="opt-html">&lt;html&gt;
  &lt;body&gt;
    [onshow.message] 
  &lt;/body&gt;
&lt;/html&gt;
</pre></td>
            <td valign="top">
              <pre class="txt-code">&lt;?php
     
  include_once(<span class="opt-value">'tbs_class.php'</span>);
  <span class="opt-name">$TBS</span> = new clsTinyButStrong;
  <span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">'template.htm'</span>);

  $message = <span class="opt-value">'Hello'</span>;
  <span class="opt-name">$TBS</span>-&gt;Show();
</pre></td>
            <td valign="top">
              <pre class="opt-html">&lt;html&gt;
  &lt;body&gt;
    Hello
  &lt;/body&gt;
&lt;/html&gt;</pre>
            </td>
          </tr>
        </tbody>
      </table>
      <p>Example 2: </p>
      <table cellspacing="4" cellpadding="2" border="0">
        <tbody>
          <tr>
            <th width="320">Html Template</th>
            <th width="320">Php Program</th>
            <th>Result</th>
          </tr>
          <tr>
            <td valign="top">
              <pre class="opt-html">&lt;table&gt;
  &lt;tr&gt;&lt;td&gt;[blk.val;block=tr]&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;</pre>
            </td>
            <td valign="top">
              <pre class="txt-code">&lt;?

  include_once(<span class="opt-value">'tbs_class.php'</span>);
  <span class="opt-name">$TBS</span> = new clsTinyButStrong;
  <span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">'template.htm'</span>);

  $list = array(<span class="opt-value">'X'</span>,<span class="opt-value">'Y'</span>,<span
class="opt-value">'Z'</span>);
  <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'blk'</span>, $list);
  <span class="opt-name">$TBS</span>-&gt;Show();
</pre></td>
            <td valign="top">
              <pre class="opt-html">&lt;table&gt;
  &lt;tr&gt;&lt;td&gt;X&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;Y&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td&gt;Z&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;</pre>
            </td>
          </tr>
        </tbody>
      </table>
      <a id="php_side"></a>
      <h2>PHP side:</h2>
      <p>The merging of a template is done in a PHP program using an object
        variable declared as a <span class="opt-html">clsTinyButStrong</span>
        class.</p>
      <p> Example of statement:</p>
      <pre class="txt-code decal"><span class="opt-name">$TBS</span> = new clsTinyButStrong;</pre>
      <p>This object allows you to load a template, to handle the merging of it
        with data, and then to show the result.</p>
      <p> Example of PHP code: </p>
      <pre class="txt-code decal">include_once(<span class="opt-value">'tbs_class.php'</span>);
<span class="opt-name">$TBS</span> = new clsTinyButStrong;
<span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">'template.htm'</span>) ;
<span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'ctry','mysql','SELECT * FROM t_country'</span>);
<span class="opt-name">$TBS</span>-&gt;Show();</pre>
      <p>Here is the description of the TinyButStrong object: </p>
      <h3><a id="php_instanciate"></a>create a new TBS object:</h3>
      <div class="norm">
        <p>A TBS object is created as a new instance of the clsTinyButStrong
          class. A TBS object enables you to work with one or several templates
          using the object's methods and properties.</p>
        <p> Syntax to create a new TBS object as of version 3.8.0: <span class="txt-code"><span
              class="opt-name">$TBS</span> = new clsTinyButStrong({<span class="opt-type">array</span>
            <span class="opt-name">Options</span>})</span></p>
        <table cellspacing="0" cellpadding="5" border="0">
          <tbody>
            <tr>
              <th width="80">Argument</th>
              <th>Description</th>
            </tr>
            <tr>
              <td class="opt-name" align="left" valign="top">Options</td>
              <td align="left" valign="top">An array of options to set for the
                option of the template engine. See all available options at the
                <a href="#php_setoption">SetOption</a> section.</td>
            </tr>
          </tbody>
        </table>
        <p>Examples:</p>
        <pre class="decal txt-code"><span class="opt-name">$TBS1</span> = new clsTinyButStrong; <span
class="opt-html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                         // default behavior</span>
<span class="opt-name">$TBS2</span> = new clsTinyButStrong(<span class="opt-value"> array('chr_open'=&gt;</span><span
class="opt-value">'{', 'chr_close'=&gt;'}')</span> ); <span class="opt-html">// TBS tags will be like {var.x} instead of [var.x]</span>
<span class="opt-name">$TBS3</span> = new clsTinyButStrong(<span class="opt-value"> array('var_prefix'=&gt;</span><span
class="opt-value">'tbs_fct_')</span> );<span class="opt-html"> &nbsp;&nbsp;&nbsp;      // TBS will display only PHP global variables beginning with 'tbs_var_</span>'
<span class="opt-name">$TBS4</span> = new clsTinyButStrong(<span class="opt-value"> array('fct_prefix'=&gt;</span><span
class="opt-value">'tbs_fct_') </span>);<span class="opt-html">          // TBS will call only PHP function beginning with 'tbs_fct_'</span></pre>
        <div class="versioning">
          <p>Versioning:</p>
          <p>Before TBS version 3.8.0, the syntax to create a new TBS object
            was:<br>
            &nbsp;&nbsp;&nbsp;<span class="txt-code"><span class="opt-name">$TBS</span>
              = new clsTinyButStrong({string <span class="opt-name">chr_delim</span>
              {, string <span class="opt-name">var_prefix</span> {, string <span
                class="opt-name">fct_prefix</span>}}});</span><br>
            where: </p>
          <ul class="list-mini">
            <li><span class="opt-name"> chr_delim</span> is the concatenation of
              (the option <a href="#php_setoption_chr_open" class="opt-name">chr_open</a>
              + the string ',' + the option <a href="#php_setoption_chr_close"
                class="opt-name">chr_close</a>). For example: '{,}'</li>
            <li><span class="opt-name">var_prefix</span> is the value for the
              option <a href="#php_setoption_var_prefix" class="opt-name">var_prefix</a></li>
            <li><span class="opt-name">fct_prefix</span> is the value for the
              option <a href="#php_setoption_fct_prefix" class="opt-name">fct_prefix</a></li>
          </ul>
        </div>
        <h3><a id="php_loadtemplate"></a>method LoadTemplate():</h3>
        <div class="norm">
          <p>Loads a template for the merging process. The complete contents of
            the file is immediately stored in the <a href="#php_source">Source</a>
            property of the TBS object, then [onload] <a href="#html_field_auto">fields</a>
            and <a href="#html_block_auto">blocks</a> are merged. If the file
            is not found, then it will also be searched in the folder of the
            last loaded template (<span class="versioning">since TBS version
              3.2.0</span>).</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span
                class="opt-type">string</span> <span class="opt-name">File </span><span
                class="opt-name"><span style="color:#333333">[</span></span>, <span
                class="opt-type">string</span><span class="opt-name"> Charset <span
                  class="opt-value"> = ''</span><span style="color:#333333">]</span></span>)</span>
          </p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">File</td>
                <td align="left" valign="top">Local or absolute path of the file
                  to load.<br>
                  This value can be <span class="opt-value">null</span> or <span
                    class="opt-value">''</span> (empty string) for special
                  actions. See below for more details. </td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">Charset</td>
                <td align="left" valign="top">
                  <p>Optional. Will set the <a href="#php_setoption_charset" class="opt-name">charset</a>
                    option.</p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4>Scope of the file path:</h4>
          <p>If the file is not found then its' also searched into the directory
            of the last loaded template, or the last loaded subtemplate.</p>
          <p> <span class="versioning">Since TBS version 3.3.0</span>, the file
            also searched into the <a href="http://www.php.net/manual/en/ini.core.php#ini.include-path">include_path</a>.</p>
          <h4>Adding the file at the end of the current template:</h4>
          <p>You can use the keyword <span class="opt-value">'+'</span> for the
            argument <span class="opt-name">Charset</span> to have the file
            defined by <span class="opt-name">File</span> added to the end of
            the current template. The current charset will not be modified.</p>
          <h4>Special actions using argument File:</h4>
          <p><span class="versioning">Since TBS version 3.4.0.<br>
            </span> If <span class="opt-name">File</span> is <span class="opt-value">null</span>,
            then all default actions (Plug-ins, [onload] tags, and Charset) are
            applied without loading any file. <br>
            If <span class="opt-name">File</span> is <span class="opt-value">''</span>
            (empty string), then only the <a href="#php_setoption_charset" class="opt-name">charset</a>
            option is modified, without doing any other action. (deprecated
            since TBS version 3.8.0, use <a href="#php_setoption">SetOption()</a>
            instead)<br>
            In both cases, if <span class="opt-name">Charset</span> is <span class="opt-value">'+'</span>,
            then it will be ignored and the current charset will not be
            modified.</p>
          <p> Example:</p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Source = <span
class="opt-name">$template</span>; <span class="opt-html">// load the template from a string</span>
<span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">null</span>,<span
class="opt-value">'BIG5'</span>); <span class="opt-html">//  run plug-ins if any, and merges [onload] tags if any</span>
...
<span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">''</span>,<span
class="opt-value">false</span>); <span class="opt-html">// turn the charset to no-charset</span></pre>
        </div>
        <h3><a id="php_mergeblock"></a>method MergeBlock():</h3>
        <div class="norm">
          <p>Merges one or several <a href="#html_block">TBS blocks</a> with
            records coming from a data source.</p>
          <p>By default, this method returns the number of merged records (more
            exactly, it is the number of the last record), but it can also
            return the full merged record set (see argument <span class="opt-name">BlockName</span>).</p>
          <p><span class="versioning">Versioning: since TBS version 3.12.0,
              MergeBlock() return false if no block and no field have been
              merged. Before that it returned 0.</span></p>
          <p>TinyButStrong supports several data source types in native:</p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Php data:</th>
                <td>an array, a string, a number</td>
              </tr>
              <tr>
                <th width="80">Databases:</th>
                <td>MySQL ; PostgreSQL ; SQLite</td>
              </tr>
            </tbody>
          </table>
          <p> You can also add a new one: '<a href="#plugins_db">database
              plug-ins</a>'.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">mixed</span><span
                class="opt-name"></span> <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                class="opt-type">string</span><span class="opt-name"> BlockName</span>,
              <span class="opt-type">mixed</span> <span class="opt-name">Source<span
                  style="color:#333333"> [</span></span>, <span class="opt-type">string</span><span
                class="opt-name"> Query <span class="opt-value">= ''</span> <span
                  style="color:#333333">[, <span class="opt-type">mixed</span>
                  QryPrms = false]]</span></span>)</span> </p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">BlockName</td>
                <td align="left" valign="top">Indicates the name of the TBS <a
                    href="#html_block">block</a> to merge.<br>
                  You can merge several blocks with the same data by indicating
                  their names separated by commas.<br>
                  If you add <span class="opt-value"> '*'</span> as a block
                  name, then the method will return the full merged record set
                  as a PHP array, instead of the number of records.
                  <div class="versioning">Versioning: the keyword '*' is
                    supported since TBS version 3.0.</div>
                </td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">Source</td>
                <td align="left" valign="top">
                  <p>Indicates the data source to merge.<br>
                    The table below shows the possible values according to the
                    data source type.</p>
                </td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">Query</td>
                <td align="left" valign="top"> Optional. Indicates the SQL
                  statement which returns the records to merge.<br>
                  The table below shows the possible values according to the
                  data source type.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">QryPrms</td>
                <td align="left" valign="top">Optional. Extra parameters for the
                  query. Few data source types are taking this argument in
                  account.<br>
                  <div class="versioning">Versioning: the argument QryPrms is
                    supported since TBS version 3.7.0.</div>
                </td>
              </tr>
            </tbody>
          </table>
          <h4>Link between the block and the records:</h4>
          <div class="decal">
            <p>The MergeBlock() method searches in your template for the
              specified TBS block name. Then, the block is repeated as many
              times as there are records in the data source. </p>
            <p> To display the data of a record, you have to use a linked TBS
              Field. A TBS Field is linked when the name of it is composed of
              the block's name followed by a dot and a column's or a key's name
              in the record set. A linked field must be inside the block.</p>
            <p> Example: </p>
            <table class="decal">
              <tbody>
                <tr>
                  <td>Block's name: </td>
                  <td><span class="opt-value">block1</span></td>
                </tr>
                <tr>
                  <td>Columns returned by the query:</td>
                  <td><span class="opt-value">column1</span>,<span class="opt-value">
                      column2, </span><span class="opt-value">column3</span></td>
                </tr>
                <tr>
                  <td>Linked TBS Fields:</td>
                  <td><span class="opt-value">[block1.column1]</span>, <span class="opt-value">[block1.column2]</span>,
                    <span class="opt-value">[block1.column3]</span></td>
                </tr>
              </tbody>
            </table>
            <p>If no block's definition is found in the template (that is
              parameter <a class="opt-name" href="#html_field_prm_block">block</a>
              is never used on the block's fields), then the MergeBlock() method
              will merge the first record with all linked fields found in the
              template.</p>
            <p> You can also define more advanced blocks. For more information,
              refer to chapter <a href="#html_block">TBS Blocks</a>.</p>
          </div>
          <h4><a id="php_mergeblock_subnames"></a>Merging subnames</h4>
          <div class="decal">
            <p>In a TBS field, you can refer to an array item, a method or a
              property using subnames:</p>
            <table class="decal">
              <tbody>
                <tr>
                  <td>An item of an array</td>
                  <td><span class="opt-value">[block1.arr1.key1]</span></td>
                </tr>
                <tr>
                  <td>A property of an object:</td>
                  <td><span class="opt-value">[block1.obj1.propZ]</span></td>
                </tr>
                <tr>
                  <td>A method of an object</td>
                  <td><span class="opt-value">[block1.obj1.methA()]</span></td>
                </tr>
                <tr>
                  <td>A method of an object with argument :</td>
                  <td><span class="opt-value">[block1.obj1.methA(arg1)]</span></td>
                </tr>
                <tr>
                  <td>Cascading subnames:</td>
                  <td><span class="opt-value">[block1.arr1.key2.methA().PropZ]</span></td>
                </tr>
              </tbody>
            </table>
            <p>This assumes the parent's name of a subname refers to an array or
              an object.</p>
            <p>Remarks :</p>
            <ul>
              <li>Using lot of subnames can decrease performance since the
                parsing is <span title="">reassessed</span> on each record.</li>
              <li>Don't merge data having objects with methods that should not
                be called from a template. Because the template builder could
                invoke them erroneously.</li>
            </ul>
          </div>
          <h4><a id="php_mergeblock_mergeseveral"></a>Merging several blocks
            with the same data:</h4>
          <div class="decal">
            <p>You can merge several blocks with the same data by indicating
              their names separated by commas in the <span class="opt-name">BlockName</span>
              parameter. In this case, the query is opened only one time, and
              records are buffered to feed blocks.</p>
            <p> Example: <span class="opt-name"><span class="txt-code">$TBS</span></span><span
                class="txt-code">-&gt;MergeBlock(<span class="opt-value">'block1,block2,block3'</span>,<span
                  class="opt-value">'mysql'</span>,<span class="opt-value">'SELECT
                  * FROM MyTable'</span>);</span></p>
            <p> You cannot merge several blocks having the same names because
              they are considered by TBS has a one and only block composed of
              several sections. Nevertheless, you can use a tip to get a similar
              behavior. If you use parameter <a href="#html_block_prm_p1" class="opt-name">p1</a>
              without value in the block definition, that does forces TBS to
              consider the section as a new block break, like it does for <a href="#html_block_dynsb">subblocks</a>.</p>
            <p> Example: </p>
            <div class="decal">
              <table cellspacing="5" cellpadding="0" border="0">
                <tbody>
                  <tr>
                    <td>
                      <table cellspacing="0" cellpadding="1" border="1">
                        <tbody>
                          <tr style="font-weight:bold; background-color: #66CCFF;">
                            <td>Id</td>
                            <td>Name</td>
                          </tr>
                          <tr>
                            <td>[b.id;block=tr;p1]</td>
                            <td>[b.name]</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                    <td>
                      <table cellspacing="0" cellpadding="1" border="1">
                        <tbody>
                          <tr style="font-weight:bold; background-color: #FFCC66;">
                            <td>Id</td>
                            <td>Name</td>
                          </tr>
                          <tr>
                            <td>[b.id;block=tr;p1]</td>
                            <td>[b.name]</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                </tbody>
              </table>
              <p class="txt-code"><span class="opt-name"><span class="txt-code">$TBS</span></span>-&gt;MergeBlock(<span
                  class="opt-value">'b'</span>,<span class="opt-value">'mysql'</span>,<span
                  class="opt-value">'SELECT * FROM MyTable'</span>);</p>
            </div>
            <p class="versioning">Versioning: this tip is available since TBS
              version 3.4. </p>
          </div>
          <h4>Returning the full merged record set:</h4>
          <div class="decal">
            <p>In some cases, it may be useful for you to retrieve the full
              record set after the merge. For that, you simply have to ad the
              keyword <span class="opt-value">'*'</span> in the list of block's
              names. Use this feature with care, because it save the merged data
              in the memory which can take resources.</p>
            <p> Example: <span class="opt-name">$data</span> = <span class="opt-name"><span
                  class="txt-code">$TBS</span></span><span class="txt-code">-&gt;MergeBlock(<span
                  class="opt-value">'block1,*'</span>,<span class="opt-value">'mysql'</span>,<span
                  class="opt-value">'SELECT * FROM MaTable'</span>);</span></p>
          </div>
          <h4><a id="php_mergeblock_counting"></a>Counting the records:</h4>
          <div class="decal">
            <p>To display the number of the record in the template, use a TBS
              Field linked to the virtual column '<span class="opt-value">#'</span>.
              If you put this field outside the block, it will display the total
              number of records.</p>
            <p> Example: <span class="opt-value">[block1.#]</span></p>
            <p> The virtual column '<span class="opt-value">$'</span> will
              display the key of the current record if the data source is a Php
              array.</p>
            <p> Example: <span class="opt-value">[block1.$]</span></p>
          </div>
          <h4>Resource and Request arguments according to the data source type:</h4>
          <div class="decal">
            <table class="border-0" cellspacing="0" cellpadding="2">
              <tbody>
                <tr style="font-weight:bold; background-color: #B2B2B2;">
                  <td class="border-0" width="120">Data Source Type</td>
                  <td class="border-0" width="350">Source</td>
                  <td class="border-0">Query<span class="txt-code"><span class="opt-name"></span></span></td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Assigned <span class="txt-tiny">(*)</span></td>
                  <td class="border-0">The keyword <span class="opt-value">'assigned'</span>
                    or omitted</td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Text <span class="txt-tiny">(*)</span></td>
                  <td class="border-0">The keyword <span class="opt-value">'text'</span></td>
                  <td class="border-0">A text</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Number <span class="txt-tiny">(*)</span></td>
                  <td class="border-0">The keyword <span class="opt-value">'num'</span></td>
                  <td class="border-0">A number or a special array (see below)</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Clear<span class="txt-tiny"> (*)</span></td>
                  <td class="border-0">The keyword <span class="opt-value">'clear'</span></td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Conditional<span class="txt-tiny"> (*)</span></td>
                  <td class="border-0">The keyword <span class="opt-value">'cond'</span></td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td rowspan="3" class="border-0"> PHP Array <span class="txt-tiny">(*)</span></td>
                  <td class="border-0">A Php array</td>
                  <td class="border-0">-</td>
                </tr>
                <tr>
                  <td class="border-0" valign="top">The keyword <span class="opt-value">'array'</span></td>
                  <td class="border-0" valign="top">A Php Array</td>
                </tr>
                <tr>
                  <td class="border-0" valign="top">The keyword <span class="opt-value">'array'</span></td>
                  <td class="border-0" valign="top">A string that represents an
                    array contained or nested in a PHP global variable (see
                    below)</td>
                </tr>
                <tr>
                  <td class="border-0">PHP&nbsp;<a href="http://www.php.net/manual/en/class.arrayobject.php">ArrayObject</a></td>
                  <td rowspan="3" class="border-0" valign="top">A PHP object. <span
                      class="versioning">Supported since TBS version 3.5.0.</span></td>
                  <td rowspan="3" class="border-0" valign="top">-</td>
                </tr>
                <tr>
                  <td class="border-0">PHP&nbsp;<a href="http://www.php.net/manual/en/class.iterator.php">Iterator</a></td>
                </tr>
                <tr>
                  <td class="border-0">PHP&nbsp;<a href="http://www.php.net/manual/en/class.iteratoraggregate.php">IteratorAggregate</a></td>
                </tr>
                <tr valign="top">
                  <td class="border-0">PDO</td>
                  <td class="border-0">A <a href="http://www.php.net/manual/en/book.pdo.php">PDO</a>
                    object. <span class="versioning">Supported since TBS
                      version 3.7.0.</span></td>
                  <td class="border-0">An SQL statement. Optional argument <a href="#php_mergeblock"
                      class="opt-name">QryPrms</a> can be used like with <a href="http://www.php.net/manual/en/pdostatement.execute.php">PDOStatement-&gt;execute(QryPrms</a>).</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">Zend DB Adapter</td>
                  <td class="border-0">A <a href="http://framework.zend.com/manual/en/zend.db.adapter.html">Zend
                      DB Adapter</a> object. <span class="versioning">Supported
                      since TBS version 3.8.0.</span></td>
                  <td class="border-0">An SQL statement. Optional argument <a href="#php_mergeblock"
                      class="opt-name">QryPrms</a> can be used like with <a href="http://framework.zend.com/manual/en/zend.db.adapter.html#zend.db.adapter.transactions">$db-&gt;execute($sql,
                      $prms</a>).</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">MySQLi</td>
                  <td class="border-0">A <a href="http://www.php.net/manual/en/book.mysqli.php">MySQLi</a>
                    object. <span class="versioning">Supported since TBS
                      version 3.7.0.</span></td>
                  <td class="border-0">An SQL statement</td>
                </tr>
                <tr valign="top">
                  <td rowspan="2" class="border-0">MySQL</td>
                  <td class="border-0">A <a href="http://www.php.net/manual/en/book.mysql.php">MySql</a>
                    connection identifier or the keyword <span class="opt-value">'mysql'</span></td>
                  <td class="border-0">An SQL statement</td>
                </tr>
                <tr>
                  <td class="border-0">A MySql result identifier</td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td rowspan="2" class="border-0">PostgreSQL</td>
                  <td class="border-0">A <a href="http://www.php.net/manual/en/book.pgsql.php">PostgreSql</a>
                    connection identifier</td>
                  <td class="border-0">An SQL statement</td>
                </tr>
                <tr>
                  <td class="border-0">A PostgreSql result identifier</td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td rowspan="2" class="border-0">SQLite</td>
                  <td class="border-0">An <a href="http://www.php.net/manual/en/book.sqlite.php">SQLite</a>
                    connection identifier</td>
                  <td class="border-0">An SQLite statement</td>
                </tr>
                <tr>
                  <td class="border-0">An SQLite result identifier</td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td rowspan="3" class="border-0">SQLite3</td>
                  <td class="border-0">An <a href="http://php.net/manual/en/class.sqlite3.php">SQLite3</a>
                    object</td>
                  <td class="border-0">An SQLite statement. You can use the
                    optional argument <a href="#php_mergeblock" class="opt-name">QryPrms</a>
                    in order to <a href="http://php.net/manual/en/sqlite3stmt.bindvalue.php">bind
                      values</a>.<br>
                    <span class="txt-code">Exemple #1: array("value1",
                      "values2").<br>
                      Exemple #2: array(':p1'=&gt;"value1", 'p2' =&gt;
                      "value2").<br>
                      Exemple #3: array(':p1'=&gt;array("value1",
                      SQLITE3_TEXT)).</span></td>
                </tr>
                <tr valign="top">
                  <td class="border-0">An <a href="http://php.net/manual/en/class.sqlite3stmt.php">SQLite3Stmt</a>
                    object</td>
                  <td class="border-0">You can use the optional argument <a href="#php_mergeblock"
                      class="opt-name">Query</a> in order to <a href="http://php.net/manual/en/sqlite3stmt.bindvalue.php">bind
                      values</a>. See examples above.</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">An <a href="http://php.net/manual/en/class.sqlite3result.php">SQLite3Result</a>
                    object</td>
                  <td class="border-0">-</td>
                </tr>
                <tr valign="top">
                  <td class="border-0">custom</td>
                  <td class="border-0">A keyword, an object or a resource
                    identifier not mentioned in this table.<br>
                    See the chapter '<a href="#plugins_db">database plug-ins</a>'.</td>
                  <td class="border-0">An SQL statement or something else.</td>
                </tr>
              </tbody>
            </table>
            <p class="txt-tiny">(*) See explanations in the chapter below.</p>
          </div>
          <h4>Php data sources:</h4>
          <div class="decal">
            <h5>• Assigned</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be
                equal to <span class="opt-value">'assigned'</span> or be
                omitted. The block is merged with the arguments defined in the
                property <a href="#php_assigned">Assigned</a>. </p>
              <p> Example : <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                    class="opt-value">'b1'</span>);</span></p>
              <p class="versioning">Versioning: the keyword 'assigned' is
                supported since TBS version 3.5. </p>
            </div>
            <h5>• Text</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be
                equal to <span class="opt-value">'text'</span>. The whole block
                is replaced by the text (it must be a string) given as the <span
                  class="opt-name">Query</span> argument. No linked Fields are
                processed except '<span class="opt-value">#'</span> which
                returns 1, or 0 if <span class="opt-name">Query</span> is an
                empty string. </p>
              <p> Example: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                    class="opt-value">'b1'</span>,<span class="opt-value">'text'</span>,<span
                    class="opt-value">'Hello, how are you?'</span>); </span></p>
            </div>
            <h5> • Number</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be
                equal to <span class="opt-value"></span> <span class="opt-value">'num'</span>.
                The argument <span class="opt-name">Query</span> can be either
                a number or an array. </p>
              <table cellspacing="0" cellpadding="3" border="0">
                <tbody>
                  <tr>
                    <th>arg&nbsp;Query</th>
                    <th>Returned Record Set</th>
                  </tr>
                  <tr>
                    <td valign="top">Number:</td>
                    <td>This number has to be positive or equal to zero. The
                      returned Record Set consists of a column <span class="opt-value">'val'</span>
                      where the value goes from 1 to this number.</td>
                  </tr>
                  <tr>
                    <td valign="top">Array:</td>
                    <td>This array has to contain a key <span class="opt-value">'min'</span>
                      and a key <span class="opt-value">'max'</span> and
                      eventually a key <span class="opt-value">'step'</span>.<br>
                      The returned Record Set consists of a column <span class="opt-value">'val'</span>
                      which goes from the <span class="opt-value">'min'</span>
                      value to the <span class="opt-value">'max'</span> value.</td>
                  </tr>
                </tbody>
              </table>
              <p>Examples:</p>
              <pre class="decal"><span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
class="opt-value">'b1'</span>,<span class="opt-value">'num'</span>,<span class="opt-value">12</span>);</span>
<span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'b2'</span>,<span
class="opt-value">'num'</span>,array(<span class="opt-value">'min'</span>=&gt;<span
class="opt-value">20</span>,<span class="opt-value">'max'</span>=&gt;3<span class="opt-value">0</span>));</span>
<span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'b3'</span>,<span
class="opt-value">'num'</span>,array(<span class="opt-value">'min'</span>=&gt;<span
class="opt-value">10</span>,<span class="opt-value">'max'</span>=&gt;<span class="opt-value">20</span>,<span
class="opt-value">'step'</span>=&gt;<span class="opt-value">2</span>));</span></pre>
            </div>
            <h5>• Clear</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be
                the keyword <span class="opt-value">'clear'</span>. All blocks
                and sections are deleted. It is the same thing as merging with
                an empty array. </p>
              <p> Example: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                    class="opt-value">'b1'</span>,<span class="opt-value">'clear'</span>);
                  </span></p> </div>
            <h5>• Conditional</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be
                the keyword<span class="opt-value">'cond'</span>. The block is
                merged like it was a <span class="opt-name"> <a href="#html_conditional_section">conditional
                    blocks</a> onload</span> and <span class="opt-name">onshow</span>.
                The block is not merged with data, and so it must have no linked
                TBS field. Each block section needs a parameter <span class="opt-name">when</span>
                or a parameter <span class="opt-name">default</span>. See <a href="#html_conditional_section">conditional
                  blocks</a> for more details. </p>
              <p> Example: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                    class="opt-value">'bz'</span>,<span class="opt-value">'cond'</span>);</span></p>
            </div>
            <h5><a id="php_mergeblock_array"></a>• Array</h5>
            <div class="decal">
              <p>The argument <span class="opt-name">Source</span> has to be a
                PHP Array or the keyword <span class="opt-value">'array'</span>.
                If you use the keyword <span class="opt-value">'array'</span>,
                then the argument <span class="opt-name">Query</span> has to be
                a Php Array or a string that represents an array contained or
                nested in <a href="#php_varref">VarRef</a> or <a href="#php_objectref">ObjectRef</a>.</p>
              <p> Syntax when <span class="opt-name">Query</span> is a string:</p>
              <ul>
                <li> <span class="opt-value txt-code">'varref_key[key1]-&gt;PropZ[key2]-&gt;methA()[key3]...'</span><br>
                  or</li>
                <li><span class="opt-value txt-code">'~objref_key[key1]-&gt;PropZ[key2]-&gt;methA()[key3]...'</span></li>
              </ul>
              <p>In the first syntax, <span class="opt-value txt-code">'varref_key'</span>
                is a key under <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;VarRef</span>.
                (Thus VarRef must be an associated array). By default <span class="txt-code">$TBS-&gt;VarRef</span>
                is a reference on <span class="opt-name">$GLOBAL</span>. See
                property <a href="#php_varref">VarRef</a> for more details.<br>
                In the second syntax, <span class="opt-value txt-code">'objref_key'</span>
                is a key under <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef</span>.
                (Thus ObjectRef must be an associated array). See property <a href="#php_objectref">ObjectRef</a>
                for more details.<br>
                Sub items like [key] represents a key assuming the previous item
                is an associative array.<br>
                Sub items like <span class="opt-value txt-code">-&gt;methA()</span>
                represents a method assuming the previous item is an object. You
                can use argments ; for example : <span class="opt-value txt-code">-&gt;methA(arg1)</span><br>
                Sub items like <span class="opt-value txt-code">-&gt;PropZ</span>
                represents a property assuming the previous item is an object.<br>
              </p>
              <p>The final item must be an array.</p>
              <p> Example: </p>
              <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
class="opt-value">'block1'</span>,<span class="opt-value">'array'</span>,<span class="opt-value">'days[mon]'</span>);</pre>
              <div class="decal txt-small">This will merge 'block1' with the
                value $day['mon'] assuming it is an array. </div>
              <p>It is possible to represent variable's name without items.</p>
              <p> Example: </p>
              <pre class="decal"> <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
class="opt-value">'block1'</span>,<span class="opt-value">'array'</span>,<span class="opt-value">'days'</span>);</span></pre>
              <p>There are two advantages in using a string to represent the
                array:</p>
              <ul>
                <li> Items will be read directly in the Array (assigned by
                  reference) instead of reading a copy of the items. This can
                  improve the performance.</li>
                <li> You can use dynamic queries. </li>
              </ul>
              <h6>Displaying the key of current record:</h6>
              <p>You can use the virtual column '<span class="opt-value">$'</span>
                which will display the key of the current record. This can be
                useful especially for <a href="#html_block_dynsb">subblocks
                  with dynamic queries</a>. </p>
              <p>Example: [block1.$]</p>
              <h6>Structure of supported arrays: </h6>
              <p> Items of the specified Array can be of two kinds: simple
                values with associated keys (case&nbsp;1), or array values for
                whom items are themselves simple values with associated keys
                (case&nbsp;2).</p>
              <p> Case 1: </p>
              <table cellspacing="0" cellpadding="0" border="0">
                <tbody>
                  <tr>
                    <td width="80" valign="top">Example: </td>
                    <td valign="top">
                      <pre>['key1']=&gt;value1
['key2']=&gt;value2
 ...</pre>
                    </td>
                  </tr>
                </tbody>
              </table>
              <p>The returned Record Set consists of a column <span class="opt-value">'key'</span>
                containing the name of the key, and a column <span class="opt-value">'val'</span>
                containing the value of the key. </p>
              <p> Case 2: </p>
              <table cellspacing="0" cellpadding="0" border="0">
                <tbody>
                  <tr>
                    <td width="80" valign="top">Example: </td>
                    <td valign="top">
                      <pre>[0] =&gt; (['column1']=&gt;value1-0 ; ['column2']=&gt;value2-0 ; ...)
[1] =&gt; (['column1']=&gt;value1-1 ; ['column2']=&gt;value2-1 ; ...)
[2] =&gt; (['column1']=&gt;value1-2 ; ['column2']=&gt;value2-2 ; ...)
...</pre>
                    </td>
                  </tr>
                </tbody>
              </table>
              <p>The returned Record Set consists of the columns <span class="opt-value">'column1'</span>,
                <span class="opt-value">'column2'</span>,... with their
                associated values. </p>
            </div>
          </div>
        </div>
        <h3><a id="php_show"></a>method Show():</h3>
        <div class="norm">
          <p>Terminates the merge. </p>
          <p> Syntax: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;Show([<span
                class="opt-type">int</span><span class="opt-name"> </span><span
                class="opt-name">Render</span><span class="opt-name"></span><span
                class="opt-name"><span style="color:#333333"> = false]</span></span>)</span></p>
          <p> The Show() method performs the following actions:</p>
          <ol>
            <li> Merge [onshow] <a href="#html_field_auto">fields</a> and <a href="#html_block_auto">blocks</a>,</li>
            <li>Merge [var] <a href="#html_field_auto">fields</a> (for
              compatibility with version prior to 3.2.0), </li>
            <li> Display the result (this action can be cancelled by defining
              another <a href="#php_setoption_render">Render</a> in the options
              or in the argument),</li>
            <li> End the script (this action can be cancelled by defining
              another <a href="#php_setoption_render">Render</a> in the options
              or in the argument).</li>
          </ol>
          <p> The <a href="#php_setoption_render">Render</a> allows to adjust
            the behavior of the Show() method. See the <a href="#php_setoption_render">Render</a>
            option for more information.</p>
        </div>
        <h3><a id="php_getblocksource"></a>method GetBlockSource():</h3>
        <div class="norm">
          <p>Returns the source of a TBS Block from the template. If no block is
            found, the method returns <span class="txt-code"><em><span style="color:#0033CC">false</span></em></span>.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">string</span>
              <span class="opt-name"></span><span class="opt-name">$TBS</span>-&gt;GetBlockSource(<span
                class="opt-type">string </span><span class="opt-name">BlockName
              </span>[,<span class="opt-type"> boolean</span> <span class="opt-name">AsArray</span>
              = <span class="opt-value">false</span> [,<span class="opt-type">
                boolean</span> <span class="opt-name">DefTags <span class="opt-value">=
                  true</span> </span>[,<span class="opt-type"> mix</span> <span
                class="opt-name">ReplaceWith</span> = <span class="opt-value">false</span>]]])</span></p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">BlockName</td>
                <td align="left" valign="top">The name of the block to search
                  for.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">AsArray</td>
                <td align="left" valign="top">Optional. The default value is <span
                    class="txt-code"><em><span style="color:#0033CC">false</span></em></span>.
                  If this parameter is <span class="txt-code"><em><span style="color:#0033CC">true</span></em></span>
                  the method returns the source of the block as a PHP array
                  instead of a string. If the result is an array, then each
                  sections of the block is saved as an item. First item is index
                  1.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">DefTags</td>
                <td align="left" valign="top">Optional. The default value is<span
                    class="txt-code"><em><span style="color:#0033CC"> true</span></em></span>.
                  By default, the method GetBlockSource() returns the source of
                  the block including its definition tags. If you'd like those
                  tags to be deleted, then force the argument <span class="opt-name">DefTags</span>
                  to <em><span style="color:#0033CC">false</span></em>. If the
                  block is defined with a <a href="#html_block">simplified
                    syntax</a> then the definition tags will not be deleted
                  anyway because they are also Field tags.<br>
                  <p class="versioning">Versioning: this argument is supported
                    since TBS version 3.0.</p>
                </td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">ReplaceWith</td>
                <td align="left" valign="top">Optional. Default value is <em><span
                      style="color:#0033CC">false</span></em>. If this argument
                  is a string then the block source is replaced with it in the
                  template. You can use <span class="opt-name">ReplaceWith</span>
                  = <span class="opt-value">''</span> (empty string) in order
                  to delete the block source from the template.<br>
                  <p class="versioning">Versioning: this argument is supported
                    since TBS version 3.05.</p>
                </td>
              </tr>
            </tbody>
          </table>
          <span class="txt-code"> </span><br>
          This method enables you to get the source of a block in order to
          manually handle the merging.<br>
          After that, if you need to replace the block with text, you can use
          the <a href="#php_mergeblock">MergeBlock()</a> method with the '<span
            class="opt-value">text</span>' parameter.<br>
          <div class="versioning">
            <p>Versioning:</p>
            <ul class="list-mini">
              <li> Since TBS 3.05 if <span class="opt-name">AsArray</span> is <span
                  class="opt-type">false</span> then the method returns block
                with all its sections. Before TBS 3.05 it return only the first
                section.</li>
              <li>Since TBS 3.05 if <span class="opt-name">AsArray</span> is <span
                  class="opt-type">true</span> and the block is not found then
                the method returns <span class="opt-type">false</span>. Before
                TBS 3.05 it return an empty Array.</li>
            </ul>
          </div>
        </div>
        <h3><a id="php_mergefield"></a>method MergeField():</h3>
        <div class="norm">
          <p>Replaces one or several TBS Fields with a fixed value or by calling
            a user function. Each TBS fields having the specified base name will
            be merged. </p>
          <p> Since TBS version 3.0, it's also possible to indicate a method of
            a class (see <a href="#php_oop">OOP</a>).</p>
          <p> It is also possible to merge the special [onload], [onshow] and
            [var] (see below).</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;MergeField(<span
                class="opt-type">string </span><span class="opt-name">BaseName</span>,<span
                class="opt-type"> mixed</span></span><span class="txt-code"> <span
                class="opt-name">DataOrFct</span><span class="opt-name"> </span>[,<span
                class="opt-type"> boolean</span> <span class="opt-name">FctMode
                <span class="opt-value">= false</span> </span>[, <span class="opt-type">array</span>
              <span class="opt-name">DefaultPrm</span> = <span class="opt-value">false
                </span>]])</span> </p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">BaseName</td>
                <td align="left" valign="top">Base name of the TBS Fields. For
                  example <span class="opt-value">'account'</span>.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">DataOrFct</td>
                <td align="left" valign="top">The value to display (or a string
                  that represent the name of a user function if the argument <span
                    class="opt-name">FctMode</span> is set to <span class="opt-value">true</span>).</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">FctMode</td>
                <td align="left" valign="top">Default value is <span class="opt-value">false</span>.
                  Indicates that the value to display is calculated by a user
                  function. If this argument is set to <span class="opt-value">true</span>,
                  then <span class="opt-name">DataOrFct </span>must be a text
                  string giving the name of the user function. This function
                  must exist and have the syntax described below.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">DefaultPrm</td>
                <td align="left" valign="top">
                  <p>List of parameters to apply by default to the merged
                    fields. Parameters have to be given as an associative PHP
                    array. If a parameter is defined in both argument DefaultPrm
                    and in the field, then the parameter of the field will be
                    taken in account.<br>
                    <span class="versioning">This argument is supported since
                      TBS version 3.5.0.</span><br>
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4>Merging with data :</h4>
          <p>If argument <span class="opt-name">FctMode</span> is omitted or <span
              class="opt-value txt-code">false</span>, then TBS assumes <span class="opt-name">DataOrFct</span>
            is some data. It can be a numeric, a string, an array or an object.
            For an array or an object, names of TBS Fields must have suffixes
            like <a href="#html_field_auto">automatic fields ([onload] and
              [onshow])</a>.</p>
          <p> Example: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS-&gt;</span>MergeField(<span
class="opt-value">'account'</span>,array(<span class="opt-value">'id'</span>=&gt;<span
class="opt-value">55</span>,<span class="opt-value">'name'</span>=&gt;<span class="opt-value">'Bob'</span>));</pre>
          <div class="decal">In this example, the fields <span class="opt-html">[account.id]
              </span>and <span class="opt-html">[account.name]</span> will be
            merged.</div>
          <p>If you have subdata, MergeField also support <a href="#php_mergeblock_subnames">subnames</a>.</p>
          <h4>Merging with a user function:</h4>
          <p>If argument <span class="opt-name">FctMode</span> is <span class="opt-value txt-code">true</span>,
            then TBS assumes <span class="opt-name">DataOrFct</span> is the
            name of a global function. It can also be a method, see <a href="#php_oop">OOP</a>
            for more details.</p>
          <p>TBS calls this function for each field found in the template. The
            function must have the following syntax: </p>
          <pre class="decal txt-code">function fct_user(<span class="opt-name">$Subname</span> [, <span
class="opt-name">$PrmLst</span>]) {...}</pre>
          <p>When the function is called, its argument <span class="opt-name">$Subname</span>
            has for value the suffix of the field's name (example: for a field
            named <span class="opt-value">'ml.title'</span>, <span class="opt-name">$Subname</span>
            will have the value <span class="opt-value">'title')</span>. And
            the optional argument <span class="opt-name">$PrmLst</span>
            contains an associative array with the field's parameters. The
            function must return the value to be merged. </p>
          <p> Example: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS-&gt;</span>MergeField(<span
class="opt-value">'ml'</span>,<span class="opt-value">'m_multilanguage'</span>,<span
class="opt-value">true</span>);
...
function m_multilanguage(<span class="opt-name">$Subname</span>) {
  global <span class="opt-name">$lang_id</span>; 
  <span class="opt-name">$rs</span> = mysql_query(<span class="opt-value">"SELECT text_$lang_id AS txt FROM t_language WHERE key='$Subname"</span>);
  <span class="opt-name">$rec</span> = mysql_fetch_array(<span class="opt-name">$rs</span>);
  return <span class="opt-name">$rec</span>[<span class="opt-value">'txt'</span>] ;
}</pre>
          <div class="decal">In this example, a field such as <span class="opt-html">[ml.title]</span>
            will be merged with the value returned by <span class="opt-value">m_multilanguage('title')</span>.</div>
          <h4>Merge automatic fields and blocks:</h4>
          <p>You can use the method MergeField() in order to force the merge of
            the automatic <a href="#html_field_auto">fields</a> and <a href="#html_block_auto">blocks</a>
            ([onload] and [onshow]). But in this case, only the first argument
            should be indicated.</p>
          <p> Example: <span class="txt-code"><span class="opt-name">$TBS-&gt;</span>MergeField(<span
                class="opt-value">'var'</span>); </span> </p>
          <p class="versioning">Versioning: the merge of special automatic
            fields is supported since TBS version 3.0. It replaces the old
            method MergeSpecial() which is not supported anymore. </p>
        </div>
        <h3><a id="php_setoption"></a>Method SetOption():</h3>
        <div class="norm">
          <p>Set one or several TBS options. See the list and desciptions of
            options below.<br>
            Some of the TBS options are a new way of setting <a href="#php_options_compatibility">old
              TBS features</a>. </p>
          <p class="versioning">Versioning: methods <span class="opt-name">SetOption()</span>
            is supported since TBS version 3.8.0. </p>
          <h4> Syntax:</h4>
          <p class="decal"> <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetOption(<span
                class="opt-type"><span class="opt-value">string</span></span>
              $option_name, <span class="opt-type">mixed</span> $value)</span></p>
          <p>Syntax for an array of options:</p>
          <p class="decal"> <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetOption(<span
                class="opt-type"><span class="opt-value">array</span></span>
              $options)</span></p>
          <p> Examples: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS-&gt;</span>SetOption(<span
class="opt-value">'charset'</span>,<span class="opt-value"> false</span>); <span
class="opt-html">// change the Charset option</span>
<span class="opt-name">$TBS-&gt;</span>SetOption( array(<span class="opt-value">'chr_open'</span>=&gt;<span
class="opt-value">'{'</span>, <span class="opt-value">'chr_close'</span>=&gt;<span
class="opt-value">'}'</span>) <span class="opt-value"></span>); <span class="opt-html">// change several options</span></pre>
          <h4><span class="opt-name"><a id="php_setoption_syntax_array"></a></span>Syntaxes
            for options that are arrays:</h4>
          <p>Syntax 1: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetOption(<span
                class="opt-type"><span class="opt-value">string</span></span>
              $option_name, <span class="opt-type">string</span> $item, <span
                class="opt-type">mixed</span> $value)</span><br>
            Syntax 2: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetOption(<span
                class="opt-type"><span class="opt-value">string</span></span>
              $option_name, <span class="opt-type">array</span> $values)</span></p>
          <p>Examples: </p>
          <pre class="decal txt-code"><span class="opt-name"></span><span class="opt-html"></span>
<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'tpl_frms'</span>,<span
class="opt-value"> 'curr', '0,000.0'</span><span class="opt-value"></span>); <span
class="opt-html">// add item 'curr' to the Template Formats</span>
<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'tpl_frms'</span>,<span
class="opt-value"> 'curr', null</span>); <span class="opt-html">// delete item 'curr' from the Template Formats</span>
<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'tpl_frms'</span>,<span
class="opt-value"> null</span>); <span class="opt-html">// delete all items from the Template Formats</span>

<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'include_path'</span>,<span
class="opt-value"> 'tpl/english'</span><span class="opt-value"></span>); <span class="opt-html">// add one path to the TBS include_path</span>
<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'include_path'</span>,<span
class="opt-value"> 'tpl/english', null</span><span class="opt-value"></span>); <span
class="opt-html">// delete one path from the TBS include_path</span>
<span class="opt-name">$TBS-&gt;</span>SetOption(<span class="opt-value">'include_path'</span>,<span
class="opt-value"> null</span><span class="opt-value"></span>); <span class="opt-html">// delete all pathes from the TBS include_path</span>
</pre>
          <h4>Options</h4>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th class="border-sep">Option name</th>
                <th class="border-sep">Description</th>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_var_prefix"></a>var_prefix</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Limit the usage of <a href="#html_field_auto">automatic
                      fields</a> ([onload] [onshow] and [var]) in templates. TBS
                    will display only keys prefixed with <span class="opt-name">var_prefix</span>.
                    Other keys will produce an error message. The default value
                    is <span class="opt-value">''</span> (empty string) which
                    means no limitation.</p>
                  <p> Example: if option <span class="opt-name">var_prefix</span>
                    is set to <span class="opt-value">'my'</span> then<br>
                    fields <span class="opt-html">[onload.my_key]</span>, <span
                      class="opt-html">[onshow.my_key]</span> and <span class="opt-html">[var.my_key]</span>
                    will be merged,<br>
                    while <span class="opt-html">[onload.me_key]</span>, <span
                      class="opt-html">[onshow.me_key]</span> or <span class="opt-html">[var.me_key]</span>
                    will procuce an error.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_fct_prefix"></a>fct_prefix</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Limit the usage of custom PHP functions (relative to
                    parameters <a href="#html_field_prm_onformat" class="opt-name">onformat</a>
                    and <a href="#html_block_prm_ondata" class="opt-name">ondata</a>)
                    in templates. TBS will call only PHP function prefixed with
                    <span class="opt-name">fct_prefix</span>. Other functions
                    will produce an error message. The default value is <span class="opt-value">''</span>
                    (empty string) which means no limitation.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_noerr"></a>noerr</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to avoid all TinyButStrong error messages.
                    Default value is <span class="opt-value">false</span>.</p>
                  <p>The errors that were not displayed can however be returned
                    with the special automatic field <a href="#html_field_special"
                      class="opt-name">[onshow..error_msg]</a>.</p>
                  <p>Furthermore you can check the presence of error using
                    property <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;<span
                        class="opt-value">ErrCount</span></span> which counts
                    TBS errors regardless of option <span class="opt-name">
                      noerr</span>. When the <span class="opt-name">noerr</span>
                    option is set to <span class="opt-value">false</span>,
                    error messages are concatened in property <span class="txt-code"><span
                        class="opt-name">$TBS</span>-&gt;<span class="opt-value">ErrMsg</span></span>.</p>
                  <p>Option <span class="opt-name">noerr</span> is a bit
                    different from the field's parameter <a href="#html_field_prm_noerr"
                      class="opt-name">noerr</a>. Option <span class="opt-name">noerr</span>
                    applies for any TBS error and will avoid the merge of a
                    block or a field which has an error. While parameter <a href="#html_field_prm_noerr"
                      class="opt-name">noerr</a> ensures the merge.</p>
                  <p> Option <span class="opt-name">noerr</span> is useful in
                    two cases:</p>
                  <ul>
                    <li> For professional sites put into production for whom no
                      error message can be displayed. Take care because you will
                      have no more indication about the good running of the
                      merge. It is often more judicious to use parameter <a href="#html_field_prm_noerr"
                        class="opt-name">noerr</a> which enables you to avoid
                      messages concerning one particular TBS tag. </li>
                    <li> For merges that do not accept TinyButStrong basic error
                      messages. For example, an OpenOffice document will not
                      open correctly if a TBS error occurs. Set option <span class="opt-name">noerr</span>
                      to <span class="opt-value">true</span> and the field <a
                        href="#html_field_special" class="opt-name">[onshow..error_msg]</a>
                      to display TBS errors in a viewable place of your
                      OpenOffice document.</li>
                  </ul>
                  <p class="versioning">Versioning: the special automatic field
                    [onshow..error_msg] is supported since TBS version 3.5.0. </p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_automerge"></a>auto_merge</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>A combination of the couple of options <span class="opt-name">onload</span>
                    and <span class="opt-name">onshow</span>. Default value is
                    <span class="opt-value">true</span>.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_onload"></a>onload</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Cancel the automatic processing of [onload] fields. This
                    option accept only values <span class="opt-value">true</span>
                    of <span class="opt-value">false</span>. Default value is <span
                      class="opt-value">true</span>. This can be very useful
                    especially, but not only, for some TBS plug-ins.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_onshow"></a>onshow</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Cancel the automatic processing of [onshow] fields.This
                    option accept only values <span class="opt-value">true</span>
                    of <span class="opt-value">false</span>. Default value is <span
                      class="opt-value">true</span>. This can be very useful
                    especially, but not only, for some TBS plug-ins. Note that
                    for compatibility, free [var] fields are automatically
                    processed even if option <span class="opt-name">onshow</span>
                    is set to false.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_att_delim"></a>att_delim</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>This option tells which is string delimiter to be choosen
                    by parameter <a href="#html_field_prm_att" class="opt-name">att</a>
                    when a new Xml/Html attribute has to be created. </p>
                  The supported values are :
                  <ul class="list-mini">
                    <li>" (double-quote),</li>
                    <li> ' (simple_quote),</li>
                    <li><span class="opt-value">false</span> (whill choose the
                      first attribute delimiter found). </li>
                  </ul>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_protect"></a>protect</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Protects all merged items by replacing the characters '<span
                      class="opt-html">[</span>' with their corresponding
                    XML/HTML code '<span class="opt-html">&amp;#91;</span>'.
                    Default value is <span class="opt-value">true</span>.</p>
                  <p>By default, all data merged with a template is protected
                    except if it's a file inclusion. It is strongly recommended
                    to protect data when it comes from free enter like on a
                    forum for example.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_charset"></a>charset</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Indicates the character encoding (charset) to use for
                    conversion of special characters when data will be merged.
                    It should be the same as the charset of the template. In a
                    Html page, the template charset is defined at the beginning
                    of the file, in the attribute <span class="opt-html">'content'</span>
                    of a <span class="opt-html">&lt;Meta&gt;</span> tag.</p>
                  <p> The default value is <span class="opt-value">''</span>
                    (empty string) which is the correct value for charsets <span
                      class="opt-value">'UTF-8'</span>, <span class="opt-value">'ISO-8859-1'</span>
                    (Latin 1), <span class="opt-value">'ISO-8859-15'</span>, <span
                      class="opt-value">'cp866'</span>, <span class="opt-value">'cp1251'</span>,
                    <span class="opt-value">'cp1252'</span>, and <span class="opt-value">'KOI8-R'</span>.
                    See the PHP function <a href="http://www.php.net/manual/en/function.htmlspecialchars.php">htmlspecialchars()</a>
                    for other charsets and technical explanations.</p>
                  <h4>No character conversion:</h4>
                  <p>If you use value <span class="opt-value">false</span> for
                    the <span class="opt-name">charset</span> option, then data
                    will to not be converted when merged into the model.<br>
                    Note that parameters <a href="#html_field_prm_strconv" class="opt-name">strconv</a>
                    can be use to define the conversion of special characters
                    for one TBS field only. </p>
                  <h4>User function:</h4>
                  <p>If your charset is not yet supported by PHP, you can
                    indicate a user function that will perform the conversion of
                    special characters. For this, use the <span class="opt-name">charset</span>
                    option with the syntax '=myfunction'.</p>
                  <p> <span class="versioning">Since TBS version 3.0</span>,
                    it's also possible to indicate a method of a class (see <a
                      href="#php_oop">OOP</a>).<br>
                    <span class="versioning">Since TBS version 3.3.0</span>,
                    such a custom function should have a second argument for
                    line break conversion.<br>
                    <span class="versioning">Since TBS version 3.5.0</span>, the
                    charset option can also be an array containing an object and
                    a method. Example: array(&amp;$obj, 'mymethod'). </p>
                  <p> Here is an example which gives the expected syntaxe:</p>
                  <pre class="decal txt-code">function f_StrToXml(<span class="opt-name">$Txt</span> <span
class="opt-type">string</span>,<span class="opt-name">$ConvBr <span class="opt-type">boolean</span></span>) {
  <span class="opt-html">// Convert a string into an XML text.</span>
  <span class="opt-type"><span class="opt-name">$x</span></span> = htmlspecialchars(utf8_encode(<span
class="opt-name">$Txt</span>));
  if (<span class="opt-name">$ConvBr</span>) {
    <span class="opt-name">$x</span> = nl2br(<span class="opt-name">$x</span>); <span
class="opt-html">// Convert any type of line break</span>
    <span class="opt-name">$x</span> = str_replace(<span class="opt-value">'&lt;br /&gt;'</span>, <span
class="opt-value">'&lt;text:line-break/&gt;'</span>,<span class="opt-name">$x</span>);
  }
  return <span class="opt-name">$x</span>;
}</pre>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_chr_open"></a>chr_open</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Opening delimiter for TBS fields.</p>
                  <p> It's recommended to let the default TBS delimiters, while
                    changing them is working well. Default TBS delimiters are [
                    and ] because those characters are usable quite everywhere
                    in XML/HTML documents, and they are located faster than
                    delimiters { / } or ( / ) since they are rarer, especially
                    in HTML.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_chr_close"></a>chr_close</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Closing delimiter for TBS fields. Must be only one
                    character.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_tpl_frms"></a>tpl_frms</span></td>
                <td class="border-sep" align="left" valign="top">Enables you to
                  define formats in the template that you can reuse for
                  parameter <a href="#html_field_prm_frm" class="opt-name">frm</a>.
                  It is the same feature as parameter <a href="#html_field_prm_tplfrms"
                    class="opt-name">tplfrms</a>, but option<a href="#php_setoption_tpl_frms"
                    class="opt-name"> tpl_frms</a> is defined in the PHP side,
                  while parameter <a href="#html_field_prm_tplfrms" class="opt-name">tplfrms</a>
                  is defined in the template side. You can manage this option
                  using the <a href="#php_setoption_syntax_array">syntax for
                    options that are array</a>.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_prm_combo"></a>prm_combo</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to define a set of parameters that can be
                    applied at the template side using parameter <a href="#html_field_prm_combo"
                      class="opt-name">combo</a>.<br>
                    Argument <span class="txt-code">$item</span> must be the
                    name of the combo.<br>
                    Argument <span class="txt-code">$value</span> must be an
                    associative array of parameters (param =&gt; value).</p>
                  <p>A combo definition can use parameter <a href="#html_field_prm_combo"
                      class="opt-name">combo</a>.<br>
                    In order to define a set parameters with several <a href="#html_field_prm_if"
                      class="opt-name">if</a> and <a href="#html_field_prm_then"
                      class="opt-name">then</a>, you can to set one 'if' and one
                    'then' key associated to an array of values instead of a
                    single value.</p>
                  <p>Examples:</p>
                  <pre class="decal txt-code"><span class="opt-html">// simple example</span><span
class="opt-name">
$TBS</span>-&gt;SetOption(<span class="opt-name">'prm_combo'</span>, <span class="opt-value">'my_combo_1'</span>, array(<span
class="opt-name">'att'</span>=&gt;<span class="opt-value">'div#data-date'</span>, <span
class="opt-name">'frm'</span>=&gt;<span class="opt-value">'yyyy-mm-dd'</span>, <span
class="opt-name">'magnet'</span>=&gt;<span class="opt-value">'div'</span>, <span
class="opt-name">'enlarge'</span>=&gt;<span class="opt-value">'span'</span>));

<span class="opt-html">// example using a parameter that is supposed to have no value (value true used instead)</span>
<span class="opt-name">$TBS</span>-&gt;SetOption(<span class="opt-name">'prm_combo'</span>, <span
class="opt-value">'my_combo_2'</span>, array(<span class="opt-name">'noerr'</span>=&gt;<span
class="opt-value">true</span>, <span class="opt-name"></span><span class="opt-name">'magnet'</span>=&gt;<span
class="opt-value">'div'</span><span class="opt-value"></span>));

/<span class="opt-html">/ example using multiple if/then parameters</span>
<span class="opt-name">$TBS</span>-&gt;SetOption(<span class="opt-name">'prm_combo'</span>, <span
class="opt-value">'my_combo_2'</span>, array(<span class="opt-name">'if'</span>=&gt;array(<span
class="opt-value">'[val]=1'</span>, <span class="opt-value">'[val]=2'</span>, <span
class="opt-value">'[val]=3'</span>), <span class="opt-name">'then'</span>=&gt;array(<span
class="opt-value">'One'</span>, <span class="opt-value">'Two'</span>, <span class="opt-value">'Three'</span>), <span
class="opt-name">'else'</span>=&gt;'More');</pre>
                  <p class="versioning">Versioning: option 'prm_combo' is
                    supported since TBS version 3.11.0.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_include_path"></a>include_path</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to define one or several paths where TBS should
                    search files for method <a href="#php_loadtemplate">LoadTemplate()</a>,
                    parameters <a href="#html_field_prm_script" class="opt-name">script</a>
                    and <a href="#html_field_prm_file" class="opt-name">file</a>.<br>
                    You can manage this option using the <a href="#php_setoption_syntax_array">syntax
                      for options that are array</a>.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_block_alias"></a>block_alias</span></td>
                <td class="border-sep" align="left" valign="top">Enables you to
                  define <a href="#coding_block_alias">block alias</a>.<br>
                  You can manage this option using the <a href="#php_setoption_syntax_array">syntax
                    for options that are array</a>.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_parallel_conf"></a>parallel_conf</span></td>
                <td class="border-sep" align="left" valign="top">Enables you to
                  define a configuration for <a href="#html_block_parallel">parallel
                    merge</a>.<br>
                  You can manage this option using the <a href="#php_setoption_syntax_array">syntax
                    for options that are array</a>.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_render"></a>render</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Indicates how the merging ends. The value must be a
                    combination of the following constants. The default value is
                    (<span class="opt-value">TBS_OUTPUT</span> + <span class="opt-value">TBS_EXIT</span>).
                    The Render property changes the behavior of the <a href="#php_show">Show()</a>
                    method. </p>
                  <table cellspacing="0" cellpadding="5" border="0">
                    <tbody>
                      <tr>
                        <th>Constant</th>
                        <th>Description</th>
                      </tr>
                      <tr>
                        <td class="opt-value" align="left" valign="top">TBS_NOTHING</td>
                        <td align="left" valign="top">Indicates that none of the
                          actions below are processed at the end of Show().</td>
                      </tr>
                      <tr>
                        <td class="opt-value" align="left" valign="top">TBS_OUTPUT</td>
                        <td align="left" valign="top">Indicates that the result
                          of the merge must be displayed at the end of Show().
                          TBS uses the PHP command <a href="http://www.php.net/manual/en/function.echo.php">echo</a>.</td>
                      </tr>
                      <tr>
                        <td class="opt-value" align="left" valign="top">TBS_EXIT</td>
                        <td align="left" valign="top">Indicates that PHP
                          terminate all script at the end of Show(). TBS uses
                          the PHP function <a href="http://www.php.net/manual/en/function.exit.php">exit</a>.</td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="php_setoption_methods_allowed"></a>methods_allowed</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Allow methods in <a href="#html_field_auto">automatic
                      fields</a>. The default value is <span class="opt-value">false</span>.
                    If you set this option to <span class="opt-value">true</span>,
                    then and automatic fields can call methods of its sub items.
                    It is a security point to not allow methods by default on
                    automatic fields because all global variables can be called
                    by automatic fields until <a href="#php_varref">VarRef</a>
                    is redefined.</p>
                  <p> Example of automatic field calling a method:
                    [onshow.my_objet.my_method]</p>
                  <p class="versioning">Versioning: option 'methods_allowed' is
                    supported since TBS version 3.8.2. </p>
                </td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><a id="php_setoption_methods_old_subtemplate"></a>old_subtemplate</td>
                <td class="border-sep" align="left" valign="top">
                  <p>Use the old sub-template technic of TinyButStrong 3.8.2 or
                    lower. Since version 3.9.0 there is a more robust technic.
                    The old technic consists in calling PHP output buffering.
                    Use this option if you encounter strange behaviors with your
                    old code when using parameter <a href="#html_field_prm_script"
                      class="opt-name">script</a> and <a href="#html_field_prm_subtpl"
                      class="opt-name">subtpl</a>. This may happen only if you
                    called the PHP command echo() in the sub-template script,
                    which is quite rare.</p>
                  <p class="versioning">Versioning: option 'old_subtemplate' is
                    supported since TBS version 3.9.0. </p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4><span class="opt-name"><a id="php_options_compatibility"></a></span>Compatibility
            with previous TBS versions:</h4>
          <p>Some TBS options are a new way of setting old TBS features.<br>
            The old features are still suported for compatibility, but they
            become deprecated. It is better to use the TBS options.</p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Option</th>
                <th>Corresponding old feature</th>
                <th>Supported since version</th>
              </tr>
              <tr>
                <td align="left" valign="top"><span class="opt-name">var_prefix</span>,
                  <span class="opt-name">fct_prefix</span>, <span class="opt-name">chr_open</span>,
                  <span class="opt-name">chr_close</span></td>
                <td align="left" valign="top">was arguments of the
                  instanciation: $TBS = new clsTinyButStrong()</td>
                <td align="left" valign="top">2.0.0</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">charset</td>
                <td align="left" valign="top">was an arguments of the method
                  $TBS-&gt;LoadTemplate()</td>
                <td align="left" valign="top">1.90</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">render</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;Render</td>
                <td align="left" valign="top">1.60</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">protect</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;Protect</td>
                <td align="left" valign="top">1.64</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">noerr</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;NoErr</td>
                <td align="left" valign="top">3.0.0</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">onload</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;OnLoad</td>
                <td align="left" valign="top">3.6.0</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">onshow</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;OnShow</td>
                <td align="left" valign="top">3.6.0</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">att_delim</td>
                <td align="left" valign="top">was a dedicated property:
                  $TBS-&gt;AttDelim</td>
                <td align="left" valign="top">3.5.0</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3><a id="php_getoption"></a>Method GetOption():</h3>
        <div class="norm">
          <p>Return the value of a TBS option.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name"><span class="opt-type">mixed</span>
                $TBS</span>-&gt;GetOption(<span class="opt-type"><span class="opt-value">string</span></span>
              $option_name)</span></p>
          <p>For supported options names, see method <a href="#php_setoption" class="opt-name">SetOption()</a>.</p>
          <p class="versioning">Versioning: methods GetOption() is supported
            since TBS version 3.8.0. </p>
        </div>
        <h3><a id="php_resetvarref"></a>Method ResetVarRef():</h3>
        <div class="norm">
          <p>Reset the <a href="#php_varref" class="opt-name">VarRef</a>
            property.</p>
          <p>By default, VarRef refers to the <a href="https://www.php.net/manual/en/reserved.variables.globals.php">PHP
              global variable $GLOBALS</a>.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ResetVarRef(<span
                class="opt-type"><span class="opt-value">boolean</span></span> <span
                class="opt-name">$to_globals</span>)</span></p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><span class="txt-code">$to_globals</span></td>
                <td align="left" valign="top">Indicates if the property VarRef
                  refers to $GLOBALS or is a new empty array. <br>
                  - if <span class="opt-name">$to_globals</span> is <span class="txt-code"><span
                      class="opt-type">true</span></span> then VarRef refers to
                  $GLOBALS. <br>
                  - if <span class="opt-name">$to_globals</span> is <span class="txt-code"><span
                      class="opt-type">false</span></span> then VarRef is a new
                  empty array.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3><a id="php_getvarrefitem"></a>Method GetVarRefItem():</h3>
        <div class="norm">
          <p>Get an item value in the <a href="#php_varref" class="opt-name">VarRef</a>
            property.</p>
          <p>This function uniformizes the way to get a <a href="#php_varref" class="opt-name">VarRef</a>
            item, whether VarRef refers to <a href="https://www.php.net/manual/en/reserved.variables.globals.php">$GLOBALS</a>
            or not.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">mixed</span>
              <span class="opt-name">$TBS</span>-&gt;GetVarRefItem(<span class="opt-type"><span
                  class="opt-value">string</span></span> <span class="opt-name">$key</span>
              , <span class="opt-type"><span class="opt-value">mixed</span></span>
              <span class="opt-name">$default</span> = <span class="opt-value">null</span>)</span></p>
          <p>If VarRef if a dedicated array, then this function is the same as
            doing <span class="txt-code">$TBS-&gt;VarRef[$key] ?? $default;</span></p>
          <p class="versioning">Versioning: methods GetVarRefItem() is supported
            since TBS version 3.13.0.</p>
        </div>
        <h3><a id="php_setvarrefitem"></a>Method SetVarRefItem():</h3>
        <div class="norm">
          <p>Set an item value in the <a href="#php_varref" class="opt-name">VarRef</a>
            property.</p>
          <p>This function uniformizes the way to set a <a href="#php_varref" class="opt-name">VarRef</a>
            item, whether VarRef refers to <a href="https://www.php.net/manual/en/reserved.variables.globals.php">$GLOBALS</a>
            or not.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetVarRefItem(<span
                class="opt-type"><span class="opt-value">string</span></span> <span
                class="opt-name">$key</span> , <span class="opt-type"><span class="opt-value">mixed</span></span>
              <span class="opt-name">$value</span>)</span></p>
          <p>Syntax for an array of items: <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetVarRefItem(<span
                class="opt-type"><span class="opt-value">array</span></span> <span
                class="opt-name">$items</span>)</span> </p>
          <p>If VarRef if a dedicated array, then this function is the same as
            doing <span class="txt-code">$TBS-&gt;VarRef[$key] = $value;</span></p>
          <p class="versioning">Versioning: methods SetVarRefItem() is supported
            since TBS version 3.13.0.<br>
            The syntax for an array of items is supported since TBS version
            3.13.1.</p>
        </div>
        <h3><a id="php_replacefields"></a>Method ReplaceFields():</h3>
        <div class="norm">
          <p>Replace a set of simple TBS fields in the template with new
            definitions prepared at the PHP side. Note than this function does
            not merges any field ; it only replaces the definition of fields.</p>
          <p>This is useful when you miss some place in the template for certain
            fields ; and also to delete some fields.</p>
          <p> Syntax: <span class="txt-code"><span class="opt-name"><span class="opt-type">mixed</span>
                $TBS</span>-&gt;ReplaceFields(<span class="opt-type opt-value">array</span>
              <span class="opt-name">$fields</span> [, <span class="opt-type opt-value">string</span>
              <span class="opt-name">$block_name</span> = <span class="opt-value">false</span>])</span></p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><span class="txt-code">$fields</span></td>
                <td align="left" valign="top">An associative where keys are the
                  names of the simple TBS tags to replace in the template ; and
                  values are the new definition of the field.<br>
                  The new definition of the field can be either :<br>
                  - an array of TBS parameters, with the same principle as <a href="#php_setoption_prm_combo">SetOption('prm_combo')</a><br>
                  - a string that will replace the full TBS field's definition.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><span class="txt-code">
                    $block_name</span></td>
                <td align="left" valign="top">(optional) A block's name to add
                  as prefix of all field's names (only if the new definition is
                  an array of parameter)</td>
              </tr>
            </tbody>
          </table>
          <p>In the template, the simple TBS fields to replace must have no
            parameters. Fields with parameters won't be replaced.</p>
          <p>If the new definition of the field is an array of parameter, then
            the field's name is unchanged unless you use the special parameter <span
              class="opt-name">'name'</span>.</p>
          <p>Example: </p>
          <pre class="decal txt-code"><span class="opt-name"><span class="opt-html">// [s1] will be replaced with [s1;enlarge=div;magnet=table;frm=0.00;noerr</span>]
<span class="opt-html">// [s2] will be replaced with [onshow.x2;frm=0.00</span>]
<span class="opt-html">// [s3] will be replaced with [onshow.x3;noerr</span>]
<span class="opt-html">// [s4] will be deleted</span>
$TBS</span>-&gt;ReplaceFields( array(
<span class="opt-value">  's1'</span> =&gt; array(<span class="opt-name">'enlarge'</span> =&gt; <span
class="opt-value">'div'</span>, <span class="opt-name">'magnet'</span> =&gt; <span
class="opt-value">'table'</span>, <span class="opt-name">'frm'</span> =&gt; <span
class="opt-value">'0.00'</span>, <span class="opt-name">'noerr'</span> =&gt; true),
  <span class="opt-value">'s2'</span> =&gt; array(<span class="opt-name">'name'</span> =&gt; <span
class="opt-value">'onshow.x2'</span>, <span class="opt-name">'frm'</span> =&gt; <span
class="opt-value">'0.00'</span>),
  <span class="opt-value">'s3'</span> =&gt; <span class="opt-value">'[onshow.x3;noerr]'</span>,
  <span class="opt-value">'s4'</span> =&gt; <span class="opt-value">''</span>,
));
</pre>
          <p class="versioning">Versioning: methods ReplaceFields() is supported
            since TBS version 3.11.0. </p>
        </div>
        <h3><a id="php_getattvalue"></a>Method GetAttValue():</h3>
        <div class="norm">
          <p>Return the value of an XML/HTML attribute in the template. </p>
          <p> Syntax: <span class="txt-code"><span class="opt-name"><span class="opt-type">mixed</span>
                $TBS</span>-&gt;GetAttValue(<span class="opt-type opt-value">string</span>
              <span class="opt-name">$field_name</span> [, <span class="opt-type opt-value">boolean</span>
              <span class="opt-name">$delete</span> = <span class="opt-value">true</span>])</span></p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Argument</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><span class="txt-code">$field_name</span></td>
                <td align="left" valign="top">The name of a TBS field in the
                  template. The field must have parameter <a href="#html_field_prm_all"
                    class="opt-name">att</a>.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><span class="txt-code">$delete</span></td>
                <td align="left" valign="top">(Optional, <span class="opt-value txt-code">true</span>
                  by default) Indicate if the TBS field must be deleted after it
                  is found.</td>
              </tr>
            </tbody>
          </table>
          <p>The function will search the first TBS field with the given name,
            and then search for the attribute targeted by its parameter <a href="#html_field_prm_all"
              class="opt-name">att</a>.</p>
          <p>The function takes in acount only the first field that is met. The
            TBS field is deleted if <span class="txt-code opt-name">$delete</span>
            is <span class="opt-value txt-code">true</span>, but is remains
            unmodified in the template if <span class="txt-code opt-name">$delete</span>
            is <span class="opt-value txt-code">false</span>.</p>
          <p>The function return:</p>
          <ul>
            <li>the value's attribute as a string,</li>
            <li><span class="txt-code opt-value">true</span> if the attribute is
              a boolean attribute (that is without value),</li>
            <li><span class="txt-code opt-value">null</span> if the TBS field is
              not found or if it has no parameter <a href="#html_field_prm_all"
                class="opt-name">att</a>,</li>
            <li><span class="txt-code opt-value">false</span> if the target
              XML/HTML element is not found or if the asked attribute is not
              found.</li>
          </ul>
          <p class="versioning">Versioning: methods GetAttValue() is supported
            since TBS version 3.11.0. </p>
        </div>
        <h3><a id="php_plugin"></a>Method PlugIn():</h3>
        <div class="norm">
          <p>Enables you to call a <a href="#plugins_tbs">TBS plug-in</a>'s
            command, or to install a TBS plug-in.</p>
          <p>Syntax: <span class="opt-type"><span class="txt-code">mixed</span></span>
            <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;PlugIn(<span
                class="opt-type"><span class="opt-value">mixed</span></span>
              arg1, <span class="opt-type">mixed</span> arg2, ...)</span></p>
          <p><em>Remind:</em> in order to have your TBS plug-in working, its PHP
            script must be included in your application before.</p>
          <p> Example: <span class="txt-code"><span class="opt-name">include_once</span>(<span
                class="opt-value">'tbs_plugin_xxx.php'</span>); </span><br>
            And aslo, every TBS plug-in should have a key as explained at <a href="#plugins_tbs">Plug-ins</a>.
          </p>
          <h4>Calling a plug-in's command:</h4>
          <p>Use the plug-in's key as the main argument. Next arguments are for
            the called plug-in's purpose. </p>
          <p> Example: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS-&gt;</span>PlugIn(<span
class="opt-value">TBS_XXX</span>, <span class="opt-name">$arg1</span>, <span class="opt-name">arg2</span>);    </pre>
          <div class="decal txt-small">In this example, the plug-in identified
            by the key TBS_XXX is called.</div>
          <p><em>Remark:</em> when you call a plug-in's command for the first
            time this plug-in is automatically installed on the TBS instance (<span
              class="opt-name">$TBS</span>).</p>
          <h4>Installing a plug-in: </h4>
          <p>Although some plug-ins are automatically installed, it can be
            useful in some other cases to make a manual installation. For this,
            use the constant TBS_INSTALL with the plug-in's key.</p>
          <p> Example: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS-&gt;</span>PlugIn(<span
class="opt-value">TBS_XXX</span>, <span class="opt-value">TBS_XXX</span>);    </pre>
          <div class="decal txt-small"><span class="txt-small">In this example,
              the plug-in identified by the key TBS_XXX is installed.</span></div>
          <p><em>Remarks:</em> </p>
          <ul>
            <li> A plug-in is installed relatively to a TBS instance (a variable
              $TBS for example). If you are using a second TBS instance (for
              example <span class="opt-name">$TBS2</span>) then you will also
              need to install the plug-in on this instance. </li>
            <li> A plug-in is installed automatically when you call one of its
              commands using the method PlugIn() (se above). </li>
          </ul>
          <p class="versioning">Versioning: the method PlugIn() is supported
            since TBS version 3.0. </p>
        </div>
        <h3><a name="php_varref"></a>Property VarRef:</h3>
        <div class="norm">
          <p>Property VarRef is the array of the items that will be merged with
            <a href="#html_field_auto">automatic fields</a> ([onload], [onshow]
            and [var]).</p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">array</span>
              <span class="opt-name">$TBS</span>-&gt;VarRef</span></p>
          <p> By default <span class="txt-code">$TBS-&gt;VarRef</span> refers
            to the special <a class="opt-name" href="https://www.php.net/manual/en/reserved.variables.globals.php">$GLOBALS</a>
            variable of PHP. This is for compatibility reasons, but it is
            recommended to use another array instead (see below). </p>
          <p>You can set <span class="txt-code">$TBS-&gt;VarRef</span> to be a
            new empty array using the method <span class="txt-code">$TBS-&gt;ResetVarRef(false);</span></p>
          <p>You can also set <span class="txt-code">$TBS-&gt;VarRef</span> to
            be a reference to your own array : <span class="txt-code">$TBS-&gt;VarRef
              =&amp; $my_array;</span></p>
          <div class="decal warning"> <strong>Warning</strong> <br>
            As of TBS version 3.13.0, is not possible to access directly to the
            VarRef items when the property refers to $GLOBALS. This is because
            of the PHP restriction on $GLOBALS that occurs with PHP 8.1. <br>
            In order to ensure the compatibility to any situation, you can
            manage the items of VarRef using the methods <a href="#php_setvarrefitem"
              class="txt-code">$TBS-&gt;SetVarRefItem()</a> and <a href="#php_setvarrefitem"
              class="txt-code">$TBS-&gt;GetVarRefItem()</a>. </div>
          <p>Notes:</p>
          <ul>
            <li> Method <a href="#php_resetvarref" class="txt-code">ResetVarRef(<span
                  class="opt-name">$ToGlobal</span>)</a> is a shorthand for
              resetting property VarRef to <a class="opt-name" href="https://www.php.net/manual/en/reserved.variables.globals.php">$GLOBALS</a>
              or to an empty array.</li>
            <li> If property VarRef is changed by a sub-template, the change is
              available only for the sub-template.</li>
          </ul>
          <p>Example when VarRef is a custom array (recommended): </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;ResetVarRef(false); <span
class="opt-html">// VarRef is now a new empty array</span>
<span class="opt-name">$TBS</span>-&gt;VarRef['my_item'] = "my value";
<span class="opt-name">$TBS</span>-&gt;SetVarRefItem('my_item', "my value"); <span
class="opt-html">// same as above but ensure the compatibility with any situation</span></pre>
          <p>Example when VarRef is attached to $GLOBALS (by default): </p>
          <pre class="decal txt-code"><s><span class="opt-name">$TBS</span>-&gt;VarRef['my_item'] = "my value";</s> <span
class="opt-html">// this will raise an error as of TBS version 3.13.0</span>
<span class="opt-name">$GLOBALS</span>['my_item'] = "my value";
<span class="opt-name">$TBS</span>-&gt;SetVarRefItem('my_item', "my value"); <span
class="opt-html">// same as above but ensure the compatibility with any situation</span></pre>
          <div class="versioning">
            <p>Versioning:</p>
            <ul class="list-mini">
              <li>Property VarRef is supported since TBS version 3.8. Before
                this version, the scope of automatic fields was PHP global
                variables.</li>
              <li> Since TBS version 3.13.0, you cannot directly use the
                property <span class="txt-code">$TBS-&gt;VarRef</span> when it
                refers to $GLOBAL. This is because of a PHP 8.1 restriction. Use
                SetVarRefItem() and GetVarRefItem() instead. <br>
                Before TBS version 3.13.0, property <span class="txt-code">$TBS-&gt;VarRef</span>
                used to be by default a PHP reference the $GLOBAL variable. </li>
            </ul>
          </div>
        </div>
        <h3><a id="php_assigned"></a>Property Assigned:</h3>
        <div class="norm">
          <p>Enables you to define information for a subsequent merging which
            can be automatic or manual. </p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">array</span>
              <span class="opt-name">$TBS</span>-&gt;Assigned</span></p>
          <p> Property Assigned is a PHP array defined by the user. Arguments
            for methods MergeBlock() and MergeField() can be saved there.
            Arguments have to be saved in a PHP array with numerical keys and
            ordered following the syntax of those methods. It is possible to use
            optional string keys in order to define specific behaviors: </p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Optional key</th>
                <th>Description</th>
              </tr>
              <tr>
                <td valign="top" nowrap="nowrap"><span class="opt-value">'type'</span>=&gt;<span
                    class="opt-value">'mergeblock'</span></td>
                <td>Indicates that arguments are for the MergeBlock() method.
                  This key is optional because it is the default behavior.</td>
              </tr>
              <tr>
                <td valign="top" nowrap="nowrap"><span class="opt-value">'type'</span>=&gt;<span
                    class="opt-value">'mergefield'</span></td>
                <td>Indicates that arguments are for the MergeField() method.</td>
              </tr>
              <tr>
                <td valign="top" nowrap="nowrap"><span class="opt-value">'auto'</span>=&gt;<span
                    class="opt-value">'onload'</span></td>
                <td>Indicates that the merging must be started automatically
                  after [onload] tags.</td>
              </tr>
              <tr>
                <td valign="top" nowrap="nowrap"><span class="opt-value">'auto'</span>=&gt;<span
                    class="opt-value">'onshow'</span></td>
                <td>Indicates that the merging must be started automatically
                  after [onshow] tags.</td>
              </tr>
              <tr>
                <td valign="top" nowrap="nowrap"><span class="opt-value">'merged'</span>=&gt;<span
                    class="opt-value">0</span></td>
                <td>This key is added automatically by TBS during the merging.
                  It counts the number of times this entry was merged.</td>
              </tr>
            </tbody>
          </table>
          <p>Example of a manual merging: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Assigned[<span
class="opt-value">'b'</span>] = array(<span class="opt-value">'b1,b2'</span>, &amp;<span
class="opt-name">$cnt_id</span>, <span class="opt-value">'SELECT id, name FROM table1'</span>);
... 
<span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'b'</span>); <span
class="opt-html">// merge block b1 and b2 with the SQL query</span>          </pre>
          <p>Example of an automatic merging: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Assigned[<span
class="opt-value">'b'</span>] = array(<span class="opt-value">'b1,b2'</span>, &amp;<span
class="opt-name">$cnt_id</span>, <span class="opt-value">'SELECT id, name FROM table1'</span>, <span
class="opt-value">'auto'</span>=&gt;<span class="opt-value">'onload'</span>); </pre>
          <p>Example of merging fields: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Assigned[<span
class="opt-value">'f1'</span>] = array(<span class="opt-value">'f1'</span>, <span
class="opt-name">$data</span>, <span class="opt-value">'type'</span>=&gt;<span class="opt-value">'mergefield'</span>);
... 
<span class="opt-name">$TBS</span>-&gt;MergeField(<span class="opt-value">'f1'</span>); <span
class="opt-html">// merge field f1 witht the array $data</span></pre>
          <p>Notes:</p>
          <ul>
            <li> To merge an assigned block or field, you just have to call the
              corresponding method using only the name of the assigned key. You
              can add the argument Source = <span class="opt-value">'assigned'</span>,
              but this is optional because it is the default value. In other
              words, <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'b'</span>)
              is equivalent to <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
                class="opt-value">'b'</span>, <span class="opt-value">'assigned'</span>).</li>
            <li> An assignment with <span class="opt-value">'auto'</span>=&gt;<span
                class="opt-value">'onload'</span> will be merged, of course,
              only if it is defined before calling the LoadTemplate() method.</li>
            <li> You can pass some arguments by <a href="http://www.php.net/manual/en/language.references.php">reference</a>
              for you assignments. This is particularly useful for PHP 4 which
              is passing object with a copy by default. </li>
          </ul>
          <p class="versioning">Versioning: property Assigned is supported since
            TBS version 3.5. </p>
        </div>
        <h3><a id="php_source"></a>property Source:</h3>
        <div class="norm">
          <p>This property contains the source of the template currently merged.
            It is read/write. When TinyButStrong processes a merging (when using
            the MergeBlock() method for example), the Source property is
            modified immediately. </p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">string</span>
              <span class="opt-name">$TBS</span>-&gt;Source</span></p>
          <p> Notes:</p>
          <ul>
            <li> The <a href="#php_loadtemplate">LoadTemplate()</a> method
              loads a file into the Source property and merges the [onload] tags
              automatically. Thus, Source may be different from the original
              template after LoadTemplate(). </li>
            <li> The <a href="#php_show">Show()</a> method merges [onshow] tags
              automatically before to display the result. </li>
          </ul>
          <p> In order to load a template stored into a Php variable, you can
            code: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Source = <span
class="opt-name">$my_template</span>;
<span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">null</span>); <span
class="opt-html">//  run plug-ins if any, and merges [onload] tags if any</span></pre>
          <p>In order to store the result at the end of the merging, you can
            code: </p>
          <pre class="decal txt-code"><span class="opt-name">$TBS</span>-&gt;Show(<span
class="opt-value">TBS_NOTHING</span>); <span class="opt-html">// terminate the merging without leaving the script nor to display the result</span>
<span class="opt-name">$result</span> = <span class="opt-name">$TBS</span>-&gt;Source;</pre>
        </div>
        <h3><a id="php_tplvars"></a>property TplVars:</h3>
        <div class="norm">
          <p>Contains the array of template variables corresponding to current
            template. </p>
          <p> Syntax: <span class="txt-code"><span class="opt-type">array</span>
              <span class="opt-name">$TBS</span>-&gt;TplVars</span></p>
          <p> You can define template variables using one or several <span class="opt-name">onload</span>
            <a href="#html_field_auto">automatic fields</a> with parameter <a href="#html_field_prm_tplvars"
              class="opt-name">tplvars</a>. All parameters that follow parameter
            <a href="#html_field_prm_tplvars" class="opt-name">tplvars</a> are
            added to the TplVars property when the LoadTemplate() method is
            called. </p>
          <div class="decal">Example:<br>
            &nbsp;&nbsp;[<span class="opt-name">onload</span>;<span class="opt-name">tplvars</span>;<span
              class="opt-name">template_version</span>=<span class="opt-value">'1.12.27'</span>;<span
              class="opt-name">template_date</span>=<span class="opt-value">'2004-10-26'</span>]<br>
            <span class="txt-small">This TBS tag will create two items
              equivalent to the PHP code:</span><br>
            <span class="txt-code"><span class="opt-name">&nbsp;$TBS</span>-&gt;TplVars[<span
                class="opt-value">'template_version'</span>] = <span class="opt-value">'1.12.27'</span>;</span><br>
            <span class="txt-code"><span class="opt-name">&nbsp;$TBS</span>-&gt;TplVars[<span
                class="opt-value">'template_date'</span>] = <span class="opt-value">'2004-10-26'</span>;</span>
            <br>
          </div>
          <p>Remarks: </p>
          <ul>
            <li> Parameter <a href="#html_field_prm_tplvars" class="opt-name">tplvars</a>
              works only with <span class="opt-name">onload</span> <a href="#html_field_auto">automatic
                fields</a>.</li>
            <li> You can use parameter <a href="#html_field_prm_tplvars" class="opt-name">tplvars</a>
              several times in the same template. </li>
          </ul>
        </div>
        <h3><a id="php_oop"></a>Object Oriented Programming (OOP):</h3>
        <div class="norm" id="v202_oop">
          <p>TinyButStrong integrate a technique to call methods or properties
            of objects that you've coded at the PHP side. </p>
          <h4>Calling methods of a class without created object:</h4>
          <div class="decal">
            <p>The following TBS features support the call to the methods of a
              class without created object. </p>
            <div class="decal">
              <table width="100%" cellspacing="0" cellpadding="2" border="0">
                <tbody>
                  <tr>
                    <td width="180">Feature</td>
                    <td>Example</td>
                  </tr>
                  <tr id="v205_ondata_ooo">
                    <td>Parameter <a href="#html_block_prm_ondata">ondata</a></td>
                    <td>[<span class="opt-name">blk1</span>.column1;<span class="opt-name">block</span>=<span
                        class="opt-value">tr</span>;<span class="opt-name">ondata</span>=<span
                        class="opt-value">MyClass.methA</span>]</td>
                  </tr>
                  <tr>
                    <td>Parameter <a href="#html_field_prm_onformat">onformat</a></td>
                    <td>[<span class="opt-name">blk1</span>.column2;<span class="opt-name">onformat</span>=<span
                        class="opt-value">MyClass.methB</span>]</td>
                  </tr>
                  <tr>
                    <td>Method <a href="#php_loadtemplate">LoadTemplate()</a></td>
                    <td>$TBS-&gt;<span class="opt-name">LoadTemplate</span>(<span
                        class="opt-value">'mytemplate.htm'</span>,<span class="opt-value">'=MyClass.methC'</span>);</td>
                  </tr>
                  <tr>
                    <td>Method <a href="#php_mergefield">MergeField()</a></td>
                    <td>$TBS-&gt;<span class="opt-name">MergeField</span>(<span
                        class="opt-value">'myfield'</span>,<span class="opt-value">'MyClass.methD'</span>,<span
                        class="opt-value">true</span>);</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p><em>Remark:</em> Methods call using this technique must respect
              the function syntax expected by the feature (see the description
              of the corresponding feature).</p>
          </div>
          <h4>Calling created objects:</h4>
          <div class="decal">
            <p>TBS has an ObjectRef property that is set to <span class="opt-type">false</span>
              by default, and that you can use to reference your objects already
              created. You can reference an object directly on the ObjectRef
              property, or you can reference some using PHP arrays.</p>
            <p> Example: </p>
            <div class="decal"> <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef
                =&amp; <span class="opt-name">$MyObject1</span>;</span><br>
              &nbsp;&nbsp;&nbsp;You can use an array if you have several objects
              reference:<br>
              <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                  class="opt-value">'item1'</span>] =&amp; <span class="opt-name">$MyObject1</span>;</span><br>
              <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                  class="opt-value">'item2'</span>] =&amp; <span class="opt-name">$MyObject2</span>;</span><br>
              &nbsp;&nbsp;&nbsp;You can use as many levels as you wish:<br>
              <span class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                  class="opt-value">'item3'</span>][<span class="opt-value">'a'</span>][<span
                  class="opt-value">0</span>] =&amp; <span class="opt-name">$MyObject4</span>;</span></div>
            <p><em>Remarks:</em></p>
            <ul>
              <li> If you are coding for an old version of PHP prior to version
                5, it is better to use the assignment by reference using
                "=&amp;" instead of "=", in order to force objects to be passed
                by reference.</li>
              <li> Since an object is referenced under ObjectRef, its sub
                objects will also be accessible by the TBS syntax. </li>
            </ul>
            <h5> • Using ObjectRef in automatic fields:</h5>
            <p>Use the symbol '~' to call what is referenced under ObjectRef.<br>
              For example (valid for both <span class="opt-name">[onload]</span>,
              <span class="opt-name">[onshow]</span> and <span class="opt-name">[var</span>]):
              </p>
            <div class="decal">
              <table cellspacing="0" cellpadding="3" border="0">
                <tbody>
                  <tr>
                    <th>The field </th>
                    <th width="10">&nbsp;</th>
                    <th>Will call </th>
                  </tr>
                  <tr>
                    <td>[<span class="opt-name">onshow</span>.~<span class="opt-name">propA</span>]</td>
                    <td class="txt-code">&nbsp;</td>
                    <td class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef-&gt;propA</td>
                  </tr>
                  <tr>
                    <td>[<span class="opt-name">onshow</span>.~<span class="opt-name">propA</span>.<span
                        class="opt-name">propB</span>]</td>
                    <td class="txt-code">&nbsp;</td>
                    <td class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef-&gt;propA-&gt;propB</td>
                  </tr>
                  <tr>
                    <td>[<span class="opt-name">onshow</span>.~<span class="opt-name">item2</span>.<span
                        class="opt-name">propA</span>]</td>
                    <td class="txt-code">&nbsp;</td>
                    <td class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                        class="opt-value">'item2'</span>]-&gt;propA</td>
                  </tr>
                  <tr>
                    <td>[<span class="opt-name">onshow</span>.~<span class="opt-name">item2</span>.<span
                        class="opt-name">methX()</span>]</td>
                    <td class="txt-code">&nbsp;</td>
                    <td class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                        class="opt-value">'item2'</span>]-&gt;methX()</td>
                  </tr>
                  <tr>
                    <td>[<span class="opt-name">onshow</span>.~<span class="opt-name">item2</span>.<span
                        class="opt-name">methY(a,b)</span>]</td>
                    <td class="txt-code">&nbsp;</td>
                    <td class="txt-code"><span class="opt-name">$TBS</span>-&gt;ObjectRef[<span
                        class="opt-value">'item2'</span>]-&gt;methY(<span class="opt-value">'a'</span>,<span
                        class="opt-value">'b'</span>)</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p><em>Remarks:</em></p>
            <ul>
              <li> TBS proceeds to a coherence control, it will determine itself
                whether your <a href="#html_field_auto">automatic field</a>
                definition is calling to ObjectRef via an array's item, an
                object's property or an object's method. Anyway, take care that
                your <a href="#html_field_auto">automatic field</a> must call a
                value at the end, not an object.</li>
              <li>When you are calling a method with arguments (like <span class="opt-name">methY(a,b)</span>
                in the example above), then TBS does a lazy analysis of
                arguments, without string delimiters. There is no intention to
                go further in the analysis because having PHP code in the
                template is not the purpose.</li>
            </ul>
            <h5>• Using ObjectRef in other TBS features:</h5>
            <p> The following TBS features support the call to the methods of
              objects referenced under ObjectRef. </p>
            <div class="decal">
              <table width="100%" cellspacing="0" cellpadding="2" border="0">
                <tbody>
                  <tr>
                    <th width="180">Feature</th>
                    <th>Example</th>
                  </tr>
                  <tr id="v205_ondata_ooo">
                    <td>Parameter <a href="#html_block_prm_ondata">ondata</a></td>
                    <td class="txt-code">[<span class="opt-name">blk1</span>.column1;<span
                        class="opt-name">block</span>=<span class="opt-value">tr</span>;<span
                        class="opt-name">ondata</span>=<span class="opt-value">~item1.methA</span>]</td>
                  </tr>
                  <tr>
                    <td>Parameter <a href="#html_field_prm_onformat">onformat</a></td>
                    <td class="txt-code">[<span class="opt-name">blk1</span>.column2;<span
                        class="opt-name">onformat</span>=<span class="opt-value">~item1.methB</span>]</td>
                  </tr>
                  <tr>
                    <td>Method <a href="#php_loadtemplate">LoadTemplate()</a></td>
                    <td class="txt-code">$TBS-&gt;<span class="opt-name">LoadTemplate</span>(<span
                        class="opt-value">'mytemplate.htm'</span>,<span class="opt-value">'=~item1.methC'</span>);</td>
                  </tr>
                  <tr>
                    <td>Method <a href="#php_mergefield">MergeField()</a></td>
                    <td class="txt-code">$TBS-&gt;<span class="opt-name">MergeField</span>(<span
                        class="opt-value">'myfield'</span>,<span class="opt-value">'~item1.methD'</span>,<span
                        class="opt-value">true</span>);</td>
                  </tr>
                  <tr>
                    <td>Method <a href="#plugins_db">MergeBlock()</a></td>
                    <td class="txt-code">$TBS-&gt;<span class="opt-name">MergeBlock</span>(<span
                        class="opt-value">'blk1'</span>,<span class="opt-value">'~mydb'</span>,<span
                        class="opt-value">'SELECT * FROM t_table'</span>);</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p><em>Remark:</em> Methods call using this technique must respect
              the function syntax expected by the feature (see the description
              of the corresponding feature).</p>
          </div>
        </div>
        <a id="html_side"></a>
        <h2>Template side:</h2>
        <p>You design your template by placing <span class="tbsname">TBS tags </span>
          in the places where data items should appear. </p>
        <p> There are two types of TBS tags: <em>Fields</em> and <em>Blocks</em>.</p>
        <p> A <em>TBS Field</em> is a TBS tag which has to be replaced by a
          single data item. It is possible to specify a display format and also
          other parameters. The syntax for TBS Fields is described <a href="#html_field">below</a>.</p>
        <p> A <em>TBS Block</em> is an area which has to be repeated. It is
          defined using one or two TBS fields. Most often, it is the row of an
          HTML table. The syntax for TBS Blocks is described <a href="#html_block">below</a>.</p>
        <h3><a id="html_field"></a>TBS Fields:</h3>
        <div class="norm">
          <p>A TBS field is a TBS tag which has to be replaced by a single data
            item. A TBS fields must have a name to identify it (which does not
            have to be unique) and can have parameters to modify the displayed
            value. </p>
          <p> Syntax: <span class="opt-html"><strong>TEMPLATE ... </strong></span>[<span
              class="opt-name">FieldName</span>{;<span class="opt-name">param1</span>}{;<span
              class="opt-name">param2</span>}{;<span class="opt-name">param3</span>}{...}]<span
              class="opt-html"><strong> ... TEMPLATE</strong></span></p>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Element</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">FieldName</td>
                <td align="left" valign="top">The name of the Field.<br>
                  The dot (.) is a special character reserved for sub-names in
                  TBS fields. It enables you to indicate a column name (see <a
                    href="#html_block">Blocks</a>) or sub-values (see <a href="#php_mergefield">MergeField()</a>).<br>
                  Warning: names that begin with <span class="opt-name">onload</span>,
                  <span class="opt-name">onshow</span> and <span class="opt-name">var
                    </span>are reserved for <a href="#html_field_auto">automatic
                    fields</a>.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">param1</td>
                <td align="left" valign="top"> Optional. One or more parameters
                  from the list below and separated with ';'.<br>
                  Some parameters can be set to a value using the equal sign
                  '='.<br>
                  <span class="decal">Example: <a href="#html_field_prm_frm" class="opt-name">frm</a>=<span
                      class="opt-value">0.00</span></span><br>
                  If the value contains spaces, semicolons or quotes, then you
                  can use single quotes as delimiters.<br>
                  <span class="decal">Example:<a href="#html_field_prm_frm" class="opt-name">
                      frm</a>=<span class="opt-value">'0 000.00'</span></span><br>
                  Literal single quotes in the string must be escaped using two
                  adjacent single quotes ('').<br>
                  <span class="decal">Example: <a href="#html_field_prm_ifempty"
                      class="opt-name">ifempty</a>=<span class="opt-value">'hello
                      that''s me'</span></span><br>
                  <br>
                  A parameter can contain embedded TBS fields, but only under
                  special circumstances:<br>
                  - the embedded field is merged before the parent field,<br>
                  - the embedded field if a <span class="opt-name">[var]</span>
                  field placed into a parameter <a href="#html_field_prm_file"
                    class="opt-name">file</a>, <a href="#html_field_prm_script"
                    class="opt-name">script</a>, <a href="#html_field_prm_if" class="opt-name">if</a>,
                  <span class="opt-name">then</span>, <span class="opt-name">else</span>
                  or <a href="#html_block_prm_when" class="opt-name">when</a>.<br>
                  In the other cases; the embedded TBS field will not be
                  processed and will be taken as is, like text.<br>
                  Examples: <br>
                  <div class="decal"><span class="opt-html">[x;strconv=[var.y]]</span>
                    : [var.y] will not be merged and parameter "strconv" will
                    have an unvalid value.<br>
                    <span class="opt-html">[x;if [var.y]=1]</span> : [var.y]
                    will be correctly merged and the "if" condition will be
                    correctly evaluated.</div>
                </td>
              </tr>
            </tbody>
          </table>
          <h4><a id="html_field_prm"></a>Field's parameters:</h4>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Parameter</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_field_prm_strconv"></a><a id="html_field_prm_htmlconv"></a>strconv</span>=<span
                    class="opt-value">val</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Ennables you to modify the string conversion for this TBS
                    field only. Note that the string conversion used by default
                    for all TBS fields is the <a href="#php_setoption_charset">charset</a>
                    option. It is often corresponding to an Xml/Html charset but
                    not necessary.</p>
                  <p> You can specify several values using seperator <span class="opt-value">'+'</span>.
                    Example : <span class="opt-name">strconv</span>=<span class="opt-value">yes+js</span></p>
                  <p>The values can be one of the following keywords: </p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="2" border="0">
                      <tbody>
                        <tr>
                          <td width="50" valign="top"><span class="opt-value">yes</span></td>
                          <td>(default value) Performe the default special
                            string conversion, including new lines.</td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">no</span></td>
                          <td>No special string conversion. Useful to modify
                            Xml/Html source.</td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">nobr</span></td>
                          <td>Let the default string conversion, except new
                            lines (useful for &lt;pre&gt; tags for example).</td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">wsp</span></td>
                          <td>Preserve white spaces (useful for spaces at the
                            beginning of lines).</td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">esc</span></td>
                          <td>No special string conversion and double the single
                            quote characters (').</td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">js</span></td>
                          <td>Convert the data item to a string that can be
                            inserted between JavaScript text delimiters. </td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">url</span></td>
                          <td>Convert the data item to a string that can be
                            inserted inside an URL. <span class="versioning">(supported
                              since TBS version 3.5.2)</span></td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">utf8</span></td>
                          <td>Convert the data item into UTF-8. <span class="versioning">(supported
                              since TBS version 3.6.0)</span></td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">look</span></td>
                          <td>Deprecated. Performs the default string conversion
                            only if no Xml/Html entities are found inside the
                            data item.</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <p class="versioning">Versioning: Parameter <span class="opt-name">strconv</span>
                    is supported since TBS version 3.8.0. It is an alias of
                    parameter <span class="opt-name">htmlconv</span> which was
                    misnamed and becomes deprecated.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_dot"></a>. </span>(dot)</td>
                <td class="border-sep" align="left" valign="top">
                  <p>If the data item is empty, then an unbreakable space is
                    displayed. Useful for cells in tables.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_ifempty"></a>ifempty</span>=<span class="opt-value">val</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>If the data item is empty, then it is replaced with the
                    specified value.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_field_prm_att"></a>att</span>=<span class="opt-value">path</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Move the current field into an attribute of an XML/HTML tag
                    before it is merged. This parameter is very useful when it
                    is too difficult for the template designer to place a TBS
                    field into an attribute.</p>
                  <p> The value <span class="opt-value">path</span> must
                    indicate the place of the attribute relatively to the
                    current field.<br>
                    If the attribute doesn't exist in the specified tag, then it
                    is created.<br>
                    If the attribute already exists in the specified tag and it
                    has already a value, then the field replaces all the current
                    value.<br>
                    You can chose to place the field as an added value using
                    parameter <a href="#html_field_prm_attadd" class="opt-name">attadd</a>.<br>
                    You can complete the attribute's value by applying a mask to
                    it using parameter <a href="#html_field_prm_ope" class="opt-name">ope</a>=<span
                      class="opt-value">msk</span>.<br>
                    You can delete the attribute in case of empty value using
                    parameter <a href="#html_field_prm_magnet" class="opt-name">magnet</a>=<span
                      class="opt-value">#</span>.</p>
                  <p> Syntax for value <span class="opt-value">path</span>: <span
                      class="opt-name">att</span>=[<span class="opt-value">+</span>][<span
                      class="opt-value">tag1+tag2+tag3+...#</span>]<span class="opt-value">attribute</span>
                    or <span class="opt-name">att</span>=<span class="opt-value">.</span><br>
                    By default the attribute is searched before the current
                    field. But if '<span class="opt-value">+</span>' is the
                    first character of the path, then it is searched after. If
                    no tag list is specified, then the attribute is looked at in
                    the first tag met in the search direction. If a tag list is
                    used, <span class="opt-value">tag1</span> is search first,
                    then <span class="opt-value">tag2</span>, ... regardless of
                    the direction of the search (before/after). You can put a
                    tag name between one or several bracket levels in order to
                    specify that the searched tag must embed the current field.</p>
                  <p>If you set <span class="opt-name">att</span>=<span class="opt-value">.</span>
                    then TBS will assume that the TBS fields is already
                    positioned inside the target attribute.</p>
                  <p> Examples: </p>
                  <div class="decal">[<span class="opt-name">onshow.x</span>;<span
                      class="opt-name">att</span>=<span class="opt-value">class</span>]
                    moves into attribute '<span class="opt-value">class</span>'
                    of the first tag placed before.<br>
                    [<span class="opt-name">onshow.x</span>;<span class="opt-name">att</span>=<span
                      class="opt-value">div#class</span>] moves into attribute '<span
                      class="opt-value">class</span>' of the first <span class="opt-html">&lt;div&gt;</span>
                    placed before.<br>
                    [<span class="opt-name">onshow.x</span>;<span class="opt-name">att</span>=<span
                      class="opt-value">+div#class</span>] moves into attribute
                    '<span class="opt-value">class</span>' of the first <span class="opt-html">&lt;div&gt;</span>
                    placed after.<br>
                    [<span class="opt-name">onshow.x</span>;<span class="opt-name">att</span>=<span
                      class="opt-value">((div))#class</span>] moves into
                    attribute '<span class="opt-value">class</span>' of the
                    second embedding <span class="opt-html">&lt;div&gt;</span>
                    placed before.<br>
                    [<span class="opt-name">onshow.x</span>;<span class="opt-name">att</span>=<span
                      class="opt-value">table+div#class</span>] moves into
                    attribute '<span class="opt-value">class</span>' of the
                    first <span class="opt-html">&lt;div&gt;</span> after the
                    first <span class="opt-html">&lt;table&gt;</span> placed
                    before.</div>
                  <p>Notes:</p>
                  <ul>
                    <li><span class="versioning">Before TBS version to 3.10.0</span>,
                      method MergeBlock() could not move a TBS field over
                      another TBS field placed after it. This makes a TBS error
                      to occur.</li>
                    <li> When the attribute has no value before the field is
                      moved, then TBS chooses what string delimiter to use
                      regarding other attributes (XML/HTML accepts both (") and
                      (')). You can force the delimiter you need using option <a
                        href="#php_setoption_att_delim" class="opt-name">att_delim</a>.</li>
                  </ul>
                  <p class="versioning">Versioning: Parameter <span class="opt-name">att</span>
                    is supported since TBS version 3.5.0</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_field_prm_attadd"></a>attadd</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter<span class="opt-name"> att</span>.
                    Indicate that the field is added into the attribute's value,
                    instead of being replacing the attribute's value. Please
                    note that the added value won't be simply concatenated with
                    previous values, it will be added with a space character
                    separator in order to perform an adding to the meaning of
                    attributes.</p>
                  <p> Example:</p>
                  <div class="decal"><span class="opt-html">&lt;div
                      class="style1"&gt;</span>[<span class="opt-name">onshow.x</span>;<span
                      class="opt-name">att</span>=<span class="opt-value">class</span>;<span
                      class="opt-name">attadd</span>]<br>
                    in this example, if we have <span class="txt-code">$x='style2'</span>
                    then we obtain <span class="opt-html">&lt;div class="style1
                      style2"&gt;</span></div>
                  <p>There is no way for now to simply concatenate the field's
                    value with the previous attribute's value. But instead, you
                    can use parameter <a href="#html_field_prm_ope" class="opt-name">ope</a>=<span
                      class="opt-value">msk</span> in order to apply a mask to
                    the field's value.</p>
                  <p> Example: </p>
                  <div class="decal"><span class="opt-html">&lt;div
                      class="old"&gt;</span>[<span class="opt-name">onshow.z</span>;<span
                      class="opt-name">att</span>=<span class="opt-value">class</span>;<span
                      class="opt-name">ope</span>=<span class="opt-value">msk:style*</span>]<br>
                    in this example, if we have <span class="txt-code">$z='2'</span>
                    then we obtain <span class="opt-html">&lt;div
                      class="style2"&gt;</span></div>
                  <p class="versioning">Versioning: Parameter <span class="opt-name">attadd</span>
                    is supported since TBS version 3.5.0</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_atttrue"></a><span
                    class="opt-name">atttrue</span><br>
                  <span class="txt-small">or</span><br>
                  <span class="opt-name">atttrue</span>=<span class="opt-value">value</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter<span class="opt-name"> att</span>.
                    Indicates that the attribute (indicated with parameter <span
                      class="opt-name">att</span>) must be managed as a boolan
                    XHTML/HTML attribute. I.e. it is either present in the tag
                    with the format <span class="opt-html">attribute="attribute"</span>
                    in order to mean <em>TRUE</em>, or ommited in the tag in
                    order to mean <em>FALSE</em>.</p>
                  <p> If <span class="opt-name">atttrue</span> is set with a
                    given <span class="opt-value">value</span>, then the
                    boolean attribute will be <em>TRUE</em> (<em>present</em>)
                    if the field is equal to this <span class="opt-value">value</span>,
                    otherwise it will be <em>FALSE</em> (<em>omitted</em>).<br>
                    If <span class="opt-name">atttrue</span> is set with no
                    value, then the boolean attribute will be <em>TRUE</em> (<em>present</em>)
                    if the field's value is non empty, and it will be <em>FALSE</em>
                    (<em>omitted</em>) if the field's value is empty. </p>
                  <p> Examples:</p>
                  <div class="decal"><span class="opt-html">&lt;input
                      type="checkbox"&gt;</span>[<span class="opt-name">onshow.accept</span>;<span
                      class="opt-name">att</span>=<span class="opt-value">selected</span>;<span
                      class="opt-name">atttrue</span>=<span class="opt-value">1</span>]</div>
                  <p class="versioning">Versioning: Parameter <span class="opt-name">atttrue</span>
                    is supported since TBS version 3.6.0</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_magnet"></a><span
                    class="opt-name">magnet</span>=<span class="opt-value">tag</span><br>
                  <span class="txt-small">or</span><br>
                  <span class="opt-name">magnet</span>=<span class="opt-value">expr</span><br>
                  <span class="txt-small">or</span><br>
                  <span class="opt-name">magnet</span>=<span class="opt-value">#</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Assign a magnet XML/HTML zone to the TBS field. A magnet
                    tag is kept as is when the field has a value, and is deleted
                    when the field is null or empty string.</p>
                  <p> Parameter <span class="opt-name">magnet</span> supports
                    the same syntax as parameter <a href="#html_block_prm_block"
                      class="opt-name">block</a>, i.e. that <span class="opt-value">expr</span>
                    must be an XML/HTML tag or a TBS <a href="#html_block_prm_extblk">extended
                      block</a> expression.<br>
                    It also support the syntax <span class="opt-name">magnet</span>=<span
                      class="opt-value">#</span> which means that the magnet
                    zone is the HTML/HTML attribute wherein the TBS field is
                    embedded.</p>
                  <p>Example:</p>
                  <div class="decal"><span class="opt-html">(&lt;a
                      href="[onshow.link;magnet=a]"&gt;click here&lt;/a&gt;)</span><br>
                    Result for <span class="txt-code">$link='www.tbs.com'</span>:
                    <span class="opt-html">(&lt;a href="www.tbs.com"&gt;click
                      here&lt;/a&gt;)</span><br>
                    Result for <span class="txt-code">$link=''</span>: <span class="opt-html">()</span></div>
                  <p>By default, the magnet XML/HTML zone should be delimited by
                    a pair of opening-closing tags (like <span class="opt-html">&lt;a&gt;&lt;/a&gt;</span>)
                    which first tag is placed before the TBS fields. But this
                    can be changed using parameter <span class="opt-name">mtype</span>
                    (see below).</p>
                  <h6>Remark:</h6>
                  <p>the parameters <span class="opt-name">if</span>, <span class="opt-name">then</span>,
                    <span class="opt-name">else</span> are processed before
                    parameter <span class="opt-name">magnet.</span> </p>
                  <div class="versioning">
                    <p>Versioning:</p>
                    <ul class="list-mini">
                      <li> Since TBS version 3.3.0, <a href="#html_field_prm_ope"
                          class="opt-name">parameter ope</a> has keywords (<span
                          class="opt-value">nif</span>, <span class="opt-value">minv</span>,
                        <span class="opt-value">mok</span> and <span class="opt-value">mko</span>)
                        that improve parameter <span class="opt-name">magnet</span>.</li>
                      <li> The sytax <span class="opt-name">magnet</span>=<span
                          class="opt-value">#</span> without parameter <span class="opt-name">att</span>
                        is supported since TBS version 3.8.0.</li>
                    </ul>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_mtype"></a><span
                    class="opt-name">mtype</span>=<span class="opt-value">val</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter<span class="opt-name"> magnet</span>.
                    Define the magnet type. </p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="0" border="0">
                      <tbody>
                        <tr>
                          <th>Value</th>
                          <th>Magnet behavior when field is null or empty string
                          </th>
                        </tr>
                        <tr align="left" valign="top">
                          <td class="opt-value" width="60">m*m </td>
                          <td>That's the default value. Delete the pair of tags
                            that surrounds the TBS field. Everything that is
                            between them is deleted also. The field can be put
                            inside one of the tags.<br>
                            <div class="decal">Example:<br>
                              <span class="opt-html">(&lt;a
                                href="[onshow.link;magnet=a]"&gt;click
                                here&lt;/a&gt;)</span><br>
                              Result for <span class="txt-code">$link='www.tbs.com'</span>:
                              <span class="opt-html">(&lt;a
                                href="www.tbs.com"&gt;click here&lt;/a&gt;)</span><br>
                              Result for <span class="txt-code">$link=''</span>:
                              <span class="opt-html">()</span></div>
                          </td>
                        </tr>
                        <tr align="left" valign="top">
                          <td class="opt-value">m+m</td>
                          <td>Delete the pair of tags that surrounds the TBS
                            field, but keeping everything else that is between
                            the tags.
                            <div class="decal">Example:<br>
                              <span class="opt-html">(&lt;a
                                href="mailto:[blk.email;magnet=a;mtype=m+m]"&gt;[blk.name]&lt;/a&gt;)</span><br>
                              Result for <span class="txt-code">$email='me@tbs.com'</span>:
                              <span class="opt-html">(&lt;a
                                href="mailto:me@tbs.com"&gt;MyName&lt;/a&gt;)</span><br>
                              Result for <span class="txt-code">$email=''</span>:
                              <span class="opt-html">(MyName)</span></div>
                          </td>
                        </tr>
                        <tr align="left" valign="top">
                          <td class="opt-value">m*</td>
                          <td>Delete the single tag that is before the field,
                            and everything that is between the tag and the
                            field.
                            <div class="decal">Example 1: <span class="opt-html">&lt;img
                                href="[onshow.link;magnet=img;mtype=m*]"&gt;</span>
                              <br>
                              Example 2:<span class="opt-html"> &lt;br&gt;
                                [onshow.address;magnet=br]</span></div>
                          </td>
                        </tr>
                        <tr align="left" valign="top">
                          <td class="opt-value">*m</td>
                          <td>Delete the single tag that is after the field, and
                            everything that is between the tag and the field.
                            <div class="decal">Example:<span class="opt-html">
                                [onshow.address;magnet=br;mtype=*m]&lt;br&gt;</span></div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_enlarge"></a><a
                    id="html_field_prm_comm"></a><span class="opt-name">enlarge</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enlarge the bounds of the TBS Field up to the bounds of the
                    commentary Html tags which surround it, or up to another
                    specified couple of XML/HTML tags.</p>
                  <p>Example: </p>
                  <div class="decal"><span class="opt-html">xxx &lt;!-- </span>[<span
                      class="opt-name">myfield</span>;<span class="opt-name">enlarge</span>]<span
                      class="opt-html"> here some comments --&gt; yyy</span></div>
                  <p>or </p>
                  <div class="decal"><span class="opt-html">xxx &lt;div&gt; </span>[<span
                      class="opt-name">myfield</span>;<span class="opt-name">enlarge</span>=<span
                      class="opt-value">div</span>] <span class="opt-html">here
                      some comments &lt;/div&gt; yyy</span></div>
                  <p>are strictly identical to: </p>
                  <div class="decal"><span class="opt-html">xxx</span> [<span class="opt-name">myfield</span>]<span
                      class="opt-html"> yyy </span></div>
                  <p><span class="opt-html"></span> This parameter is
                    particularly useful for the template designing when you are
                    using a Visual HTML Editor (such as Dreamweaver or
                    FrontPage). </p>
                  <div class="versioning">
                    <p>Versioning:</p>
                    <ul class="list-mini">
                      <li> Parameter <span class="opt-name">enlarge</span> is
                        supported since TBS version 3.8.0. It is an alias of
                        parameter <span class="opt-name">comm</span> which was
                        misnamed and becomes deprecated.</li>
                      <li> Parameter <span class="opt-name">comm</span> is
                        available for other XML/HTML tags since TBS 3.0.</li>
                    </ul>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_noerr"></a><span
                    class="opt-name">noerr</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Avoid some of the TBS Error messages for this TBS field.
                    When such a message can be cancelled, it is mentioned in the
                    message.</p>
                  <p>After the error is cancelled, the value of the field
                    becomes an empty string ('').</p>
                  <p>See also the TBS option <a href="php_setoption_noerr" class="opt-name">noerr</a>
                    which enables you to cancel any TBS error message.</p>
                  <p>Option <span class="opt-name">noerr</span> is a bit
                    different from the field's parameter <a href="#html_field_prm_noerr"
                      class="opt-name">noerr</a>. Option <span class="opt-name">noerr</span>
                    applies for any TBS error and will avoid the merge of a
                    block or a field which has an error. While parameter <a href="#html_field_prm_noerr"
                      class="opt-name">noerr</a> ensures the merge.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_file"></a>file</span>=<span class="opt-value">filename</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Replace the field with the contents of the file.</p>
                  <p> <span class="opt-name"><span class="opt-value">Filename</span></span>
                    can be a string or an expression.</p>
                  <p>Parameter <span class="opt-name">file</span> supports <a
                      href="#html_field_auto_embedded">automatic embded fields</a>
                    <span class="opt-name">[val]</span> and <span class="opt-name">[var]</span>.</p>
                  <p>If parameter <span class="opt-name">script</span> is used
                    by omitting the <span class="opt-value">filename</span>
                    value (example: [onshow.file;<span class="opt-name">script</span>;<span
                      class="opt-name">subtpl</span>]), then the field's value
                    is used for the file name.<br>
                    If the file is not found, then it will be searched in the
                    folder of the last loaded template (<span class="versioning">since
                      TBS version 3.2.0</span>).</p>
                  <p> Examples:</p>
                  <div class="decal">[<span class="opt-name">onload</span>;<span
                      class="opt-name">file</span>=<span class="opt-value">header.html</span>]<br>
                    [<span class="opt-name">onload</span>;<span class="opt-name">file</span>=[<span
                      class="opt-name">var</span>.<span class="opt-name">filename</span>]]
                    </div>
                  <p>If <span class="opt-value">filename</span> is an empty
                    string, then no error message is displayed, it is like
                    parameter <span class="opt-name">file</span> is ignored.
                    This can be used to manage conditional insertion. </p>
                  <p> Example: </p>
                  <div class="decal"> [<span class="opt-name">onload</span>;<span
                      class="opt-name">file</span>=[<span class="opt-name">var</span>.<span
                      class="opt-name">insert</span>;if [<span class="opt-name">val</span>]=1;<span
                      class="opt-name">then</span> <span class="opt-value">'header.html'</span>;<span
                      class="opt-name">else</span> <span class="opt-value">''</span>]]
                    </div>
                  <p>You will found more details about this parameter in the
                    chapter <a href="#html_subtemplate">Subtemplates</a>.</p>
                  <p>See also: <a href="#html_field_prm_getpart" class="opt-name">getpart</a>
                    and <a href="#html_field_prm_script" class="opt-name">script</a></p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_getpart"></a><a
                    id="html_field_prm_getbody"></a><span class="opt-name">getpart</span>=<span
                    class="opt-value">taglist</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter <span class="opt-name">file</span>
                    or <span class="opt-name">script</span>.<br>
                    Indicates that not all the file contents is loaded but only
                    some XML/HTML parts of it defined with the tag list. The
                    tags of the list must be separated with plus (+), and placed
                    between parentheses if you want the tags themselves to be
                    retrieved with their content. If the file has several
                    XML/HTML part of a tag, all those parts will be
                    automatically concatenated. If parameter <span class="opt-name">getpart</span>
                    is used without value, then the &lt;body&gt; tag is taken by
                    default.</p>
                  <p> Example: </p>
                  <div class="decal">[onload;<span class="opt-name">file</span>=<span
                      class="opt-value">header.htm</span>;<span class="opt-name">getpart</span>=<span
                      class="opt-value">(script)+(style)+body</span>]</div>
                  <div class="versioning">
                    <p>Versioning:</p>
                    <ul class="list-mini">
                      <li> Parameter <span class="opt-name">getpart</span> is
                        supported since TBS version 3.8.0. It is an alias of
                        parameter <span class="opt-name">getbody</span> which
                        was misnamed and becomes deprecated.</li>
                      <li> Parameter <span class="opt-name">getbody</span> is
                        supported since TBS version 3.0. In previous versions,
                        it was automatically processed when using parameter
                        file. Now it becomes explicit.</li>
                      <li> The tag list is supported since TBS version 3.5.0.
                        Before this version, the value of getbody can be only
                        one tag without parentheses. </li>
                    </ul>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_store"></a><span
                    class="opt-name">store</span>=<span class="opt-value">taglist</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter <span class="opt-name">file</span>
                    or <span class="opt-name">script</span>.<br>
                    It works like parameter <span class="opt-name">getpart</span>
                    but the recovered part is buffered into a TBS store instead
                    of being directly displayed. This enables you to store some
                    parts of the sub-template and display them elsewhere in the
                    main template.<br>
                    A TBS store can be displayed using a <a href="#html_field_special">special
                      automatic field</a> using the key <span class="opt-name">store</span>
                    and the name of the store.<br>
                    By default the name of a store is '<span class="opt-name">default</span>',
                    but it can be changed using parameter <a href="#html_field_prm_storename"
                      class="opt-name">storename</a>.</p>
                  <p>Parameter <span class="opt-name">store</span> is useful to
                    use a sub-template as a component that will spread several
                    contents in the main template.</p>
                  <p>Example: </p>
                  <pre class="decal"><span class="opt-html">&lt;html&gt;
&lt;head&gt;
  &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
  &lt;title&gt;The main template&lt;/title&gt;</span>
  [<span class="opt-name">onshow</span>.<span class="opt-name">store</span>.<span
class="opt-name">default</span>]
<span class="opt-html">&lt;/head&gt;
&lt;body&gt;</span>
  Here is a component :
<span class="opt-html">  &lt;div&gt;</span>
    [<span class="opt-name">onload</span>;<span class="opt-name">file</span>=<span
class="opt-value">component1.htm</span>;<span class="opt-name">getpart</span>=<span
class="opt-value">body</span>;<span class="opt-name">store</span>=<span class="opt-value">(script)+(style)</span>]
<span class="opt-html">  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</span></pre>
                  <p class="versioning">Versioning: Parameter <span class="opt-name">store</span>
                    is supported since TBS version 3.8.0.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_storename"></a><span
                    class="opt-name">storename</span>=<span class="opt-value">name</span></td>
                <td class="border-sep" align="left" valign="top">To be used with
                  parameter <span class="opt-name">store</span>.
                  Parameter <span class="opt-name">storename</span> changes the
                  name of the store. See parameter <a href="#html_field_prm_store"
                    class="opt-name">store</a>.
                  <p class="versioning">Versioning: Parameter <span class="opt-name">store</span>
                    is supported since TBS version 3.8.0.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_rename"></a><span
                    class="opt-name">rename</span> <span class="opt-value">old</span><span
                    class="opt-name">=</span><span class="opt-value">new</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with parameter <span class="opt-name">file</span>
                    or <span class="opt-name">script</span>. Renames TBS blocks
                    and fields in the subtemplate before it is inserted. You can
                    define several block to rename by separate them with coma.
                    If a new name is an empty string then the old block is
                    deleted by merging it with an empty array.</p>
                  <p> This parameter is useful when you want to use the same
                    subtemplate several times in the main template. </p>
                  <p> Example:</p>
                  <div class="decal">Address 1: [onload;<span class="opt-name">file</span>=<span
                      class="opt-value">address.htm</span>]<br>
                    Address 2: [onload;<span class="opt-name">file</span>=<span
                      class="opt-value">address.htm</span>;<span class="opt-name">rename
                      </span><span class="opt-value">town1=town2,zip1=zip2,email=</span>]</div>
                  <p class="versioning">Versioning: parameter rename is
                    supported since TBS version 3.5.1.</p>
                  See chapter '<a href="#html_subtemplate">Subtemplates</a>' for
                  more details about subtemplates.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_script"></a>script</span>=<span class="opt-value">filename</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Execute the Php script just before replacing the TBS field.</p>
                  <p><span class="opt-name"><span class="opt-value">Filename</span></span>
                    can be a string or an expression.</p>
                  <p>Parameter <span class="opt-name">script</span> supports <a
                      href="#html_field_auto_embedded">automatic embded fields</a>
                    <span class="opt-name">[val]</span> and <span class="opt-name">[var]</span>.<br>
                  </p>
                  <p>If parameter <span class="opt-name">script</span> is used
                    by omitting the <span class="opt-value">filename</span>
                    value (example: [onshow.file;<span class="opt-name">script</span>;<span
                      class="opt-name">subtpl</span>]), then the field's value
                    is used for the file name.<br>
                    If the file is not found, then it will be searched in the
                    folder of the last loaded template (<span class="versioning">since
                      TBS version 3.2.0</span>). </p>
                  <table width="100%" cellspacing="0" cellpadding="2" border="0">
                    <tbody>
                      <tr>
                        <td width="10" valign="top">*</td>
                        <td>Take care that in your script <strong> variables
                            will be obsiously local instead of global</strong>.
                          This is because the script is called from a TBS
                          method. In order to define or reach global variables
                          in your script, you have to use the Php instruction <a
                            href="http://www.php.net/global" target="_blank">global</a>
                          or the array <span class="txt-code">$GLOBAL</span>.</td>
                      </tr>
                      <tr id="v202_locvar">
                        <td valign="top">*</td>
                        <td>TBS gives to you predefined local variables that can
                          be used in your script:<br>
                          - <span class="opt-name">$CurrVal</span> refers to
                          the current value of the field. It can be modified. <br>
                          - <span class="opt-name">$CurrPrm</span> refers to
                          the array of field's parameters.<br>
                          - <span class="opt-name">$this</span> refers to the
                          current TBS instance. (See parameter <span class="opt-name">subtpl</span>
                          for good usage) </td>
                      </tr>
                      <tr>
                        <td valign="top">*</td>
                        <td>If the <span class="opt-value">filename</span>
                          expression (or the value of the field) return an empty
                          string (''), then parameter script is ignored and no
                          error occurs. You can use this behavior in order to
                          use a conditional insertion.</td>
                      </tr>
                    </tbody>
                  </table>
                  <p><span>See chapter '<a href="#html_subtemplate">Subtemplates</a>'
                      for more details about how to use this parameter in
                      subtemplate mode.</span></p>
                </td>
              </tr>
              <tr id="v202_subtpl">
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_subtpl"></a><span
                    class="opt-name">subtpl</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>To be used with the parameter<span class="opt-name"> script</span>
                    or parameter <span class="opt-name">onformat</span>.
                    Activate the subtemplate mode during the script or function
                    execution.</p>
                  <p> See chapter '<a href="#html_subtemplate">Subtemplates</a>'
                    for more details.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_if"></a>if</span> <span class="opt-value">expr1</span><span
                    class="opt-name">=</span><span class="opt-value">expr2</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Replace the current value with the value of parameter <span
                      class="opt-name">then</span> or <span class="opt-name">else</span>,
                    <span jsaction="mouseup:BR6jm" jsname="jqKxS" lang="en"><span
                        jsaction="agoMJf:PFBcW;usxOmf:aWLT7;jhKsnd:P7O7bd,F8DmGf;Q4AGo:Gm7gYd,qAKMYb;uFUCPb:pvnm0e,pfE8Hb,PFBcW;f56efd:dJXsye;EnoYf:KNzws,ZJsZZ,JgVSJc;zdMJQc:cCQNKb,ZJsZZ,zchEXc;Ytrrj:JJDvdc;tNR8yc:GeFvjb;oFN6Ye:hij5Wb"
                        jsname="txFAF" data-language-for-alternatives="en" data-language-to-translate-into="fr"
                        data-phrase-index="0" jscontroller="Zl5N8" jsdata="uqLsIf;_;$35"
                        jsmodel="SsMkhd"><span jsaction="click:qtZ4nf,GFf3ac,tMZCfe; contextmenu:Nqw7Te,QP7LD; mouseout:Nqw7Te; mouseover:qtZ4nf,c2aHje"
                          jsname="W297wb">depending on whether</span></span></span>
                    the condition is verified or not. Both parameters <span class="opt-name">then</span>
                    and <span class="opt-name">else</span> are optional. A
                    missing <span class="opt-name">then</span> or <span class="opt-name">else</span>
                    means no replacement for its corresponding case.</p>
                  <p>Supported operators are: (same as parameter <a href="#html_block_prm_when"><span
                        class="opt-name">when</span></a> for blocks)</p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="0" border="0">
                      <tbody>
                        <tr>
                          <td width="80"><span class="opt-name">=</span> or <span
                              class="opt-name">==</span></td>
                          <td>equal</td>
                        </tr>
                        <tr>
                          <td class="opt-name">!=</td>
                          <td>not equal </td>
                        </tr>
                        <tr>
                          <td class="opt-name">+-</td>
                          <td>greater than </td>
                        </tr>
                        <tr>
                          <td class="opt-name">+=-</td>
                          <td>greater than or equal to </td>
                        </tr>
                        <tr>
                          <td class="opt-name">-+</td>
                          <td>less than </td>
                        </tr>
                        <tr>
                          <td class="opt-name">-=+</td>
                          <td>less than or equal to </td>
                        </tr>
                        <tr>
                          <td class="opt-name">~=</td>
                          <td>match the <a href="http://www.php.net/manual/en/function.preg-match.php">regular
                              expression</a> <span class="versioning">(since
                              TBS version 3.0)</span></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <p>Both <span class="opt-value">expr1</span> and <span class="opt-value">expr2</span>
                    must be string or numerical expressions.<br>
                    <em>Equal</em> and <em>not equal</em> operators are always
                    string <span lang="en"><span title="">comparison</span></span>s
                    and are <strong>case insensitive</strong>.<br>
                    As with other parameters, string expressions can be
                    delimited with single quotes ('), and literal single quotes
                    in the string must be escaped using two adjacent single
                    quotes ('').</p>
                  <p>Parameter <span class="opt-name">if</span> supports <a href="#html_field_auto_embedded">automatic
                      embded fields</a> <span class="opt-name">[val]</span> and
                    <span class="opt-name">[var]</span>.<br>
                  </p>
                  <p>Example:</p>
                  <div class="decal">[<span class="opt-name">onshow</span>.x;<span
                      class="opt-name">if</span> [val]+-<span class="opt-value">0</span>;<span
                      class="opt-name">then</span> <span class="opt-value">'OK'</span>;<span
                      class="opt-name">else</span> <span class="opt-value">'FAIL'</span>]<br>
                    <span class="txt-small">The field will displayed OK only if
                      « $x &gt; 0 ». </span></div>
                  <p>If the emmebed fields may contains single quotes, you need
                    to use delimitors and to escape strings in the field's value
                    and both expressions: </p>
                  <div class="decal">[<span class="opt-name">onshow</span>.x;<span
                      class="opt-name">strconv</span>=<span class="opt-value">esc</span>;<span
                      class="opt-name">if</span> '[val]'=<span class="opt-value">'abc'</span>;<span
                      class="opt-name">then</span> <span class="opt-value">'OK'</span>;<span
                      class="opt-name">else</span> <span class="opt-value">'FAIL'</span>]<br>
                    <span class="txt-small">The field will displayed OK only if
                      « $x == 'abc' ». </span></div>
                  <p>The expressions may contain <span class="opt-value">[var]</span>
                    fields and other TBS fields, but you have to make sure that
                    they are merged before the containing field is merged.
                    Otherwise the condition will always be considered as false.</p>
                  <p> It is also possible to define several couples of <span class="opt-name">if</span>/<span
                      class="opt-name">then</span> in the same field. <span class="versioning">Supported
                      since TBS version 3.0</span><br>
                    Example:</p>
                  <div class="decal">[<span class="opt-name">onshow</span>.x;<span
                      class="opt-name">if</span> [val]=0;<span class="opt-name">then</span>
                    <span class="opt-value">'ZERO'</span>;<span class="opt-name">if</span>
                    [val]=<span class="opt-value">10</span>;<span class="opt-name">then</span>
                    <span class="opt-value">'TEN'</span>;<span class="opt-name">if</span>
                    [val]=2<span class="opt-value">0</span>;<span class="opt-name">then</span>
                    <span class="opt-value">'TWENTY'</span>;<span class="opt-name">else</span>
                    [val]]<br>
                  </div>
                  <p></p>
                  <p> See parameters <span class="opt-name">then</span> and <span
                      class="opt-name">else</span> for other examples.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_then"></a>then</span><span class="opt-value">
                    val1</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>If the parameter <span class="opt-name">if</span> is
                    defined and its condition is verified, then the data item is
                    replaced with <span class="opt-value">val1</span>.</p>
                  <p>Parameter <span class="opt-name">then</span> supports <a
                      href="#html_field_auto_embedded">automatic embded fields</a>
                    <span class="opt-name">[val]</span> and <span class="opt-name">[var]</span>.</p>
                  <p><span class="versioning">Since TBS version 3.0,</span> it
                    is also possible to define several couples of <span class="opt-name">if</span>/<span
                      class="opt-name">then</span> in the same field.</p>
                  <p> Examples:</p>
                  <div class="decal"> [<span class="opt-name">onshow.image</span>;<span
                      class="opt-name">if</span> <span class="opt-value">[val]</span>=<span
                      class="opt-value">''</span>;<span class="opt-name">then</span>
                    <span class="opt-value">'image0.gif'</span>]<br>
                    [<span class="opt-name">onshow</span>.<span class="opt-name">x</span>;<span
                      class="opt-name">if</span> <span class="opt-value">[val]=1</span>;<span
                      class="opt-name">then</span> <span class="opt-value">'one'</span>;<span
                      class="opt-name">if</span> <span class="opt-value">[val]=2</span>;<span
                      class="opt-name">then</span> <span class="opt-value">'two'</span>;<span
                      class="opt-name">else</span> <span class="opt-value">'more'</span>]
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_else"></a><span
                    class="opt-name">else</span> <span class="opt-value">val2</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>If the parameter <span class="opt-name">if</span> is
                    defined and its condition is not verified, then the data
                    item is replaced with <span class="opt-value">val2</span>.</p>
                  <p>Parameter <span class="opt-name">then</span> supports <a
                      href="#html_field_auto_embedded">automatic embded fields</a>
                    <span class="opt-name">[val]</span> and <span class="opt-name">[var]</span>.</p>
                  <p> Example: </p>
                  <div class="decal"> [<span class="opt-name">onshow.error_id</span>;<span
                      class="opt-name">if</span> <span class="opt-value">[val]</span>=<span
                      class="opt-value">0</span>;<span class="opt-name">then</span>
                    <span class="opt-value">'no error'</span>;<span class="opt-name">else</span>
                    <span class="opt-value">'error found'</span>]</div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_onformat"></a><span
                    class="opt-name">onformat</span>=<span class="opt-value">fct_name</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Indicates the name of a user Php function that will be
                    executed just before the value is formated for the merge.
                    This allows typically to modify the text to display. The
                    onformat function does not replace the formating. <a href="#html_field_prm_strconv">String
                      conversion</a> or parameter <a href="#html_field_prm_onformat"
                      class="opt-name">frm</a> are applied just after the <span
                      class="opt-name">onformat</span> function.<br>
                    Since TBS version 3.0, it's also possible to indicate a
                    method of a class (see <a href="#php_oop">OOP</a>).</p>
                  <p> The function <span class="opt-value">fct_name</span> must
                    have the following syntax:<br>
                    <span class="txt-code">&nbsp;&nbsp;function <span class="opt-value">fct_name</span>(<span
                        class="opt-name">$FieldName</span>,&amp;<span class="opt-name">$CurrVal</span>,{&amp;<span
                        class="opt-name">$CurrPrm</span>,{&amp;<span class="opt-name">$TBS</span>}})
                      { ... }<br>
                    </span> <span class="opt-name"> </span> </p>
                  <table cellspacing="0" cellpadding="2" border="0">
                    <tbody>
                      <tr>
                        <th width="10">&nbsp;</th>
                        <th width="80">Argument</th>
                        <th>Description</th>
                      </tr>
                      <tr>
                        <td valign="top">&nbsp;</td>
                        <td valign="top"><span class="opt-name">$</span><span class="opt-name">FieldName</span></td>
                        <td>The name of the current field (read only).</td>
                      </tr>
                      <tr>
                        <td class="opt-name" valign="top">&nbsp;</td>
                        <td class="opt-name" valign="top">$CurrVal</td>
                        <td>The value of the current field. <span class="txt-small">
                            <em>(Don't forget the &amp; character in the
                              statement</em></span>).<br>
                          The function is supposed to change this value in order
                          to format it.</td>
                      </tr>
                      <tr id="v202_onformat_currprm">
                        <td class="opt-name" valign="top">&nbsp;</td>
                        <td class="opt-name" valign="top">$CurrPrm</td>
                        <td>Optional. The PHP array containing the parameters
                          for the current field (<span class="txt-small"><em>Don't
                              forget the &amp; character in the statement</em></span>).</td>
                      </tr>
                      <tr id="v202_onformat_tbs">
                        <td class="opt-name" valign="top">&nbsp;</td>
                        <td class="opt-name" valign="top">$TBS</td>
                        <td>Optional. Gives the current TBS instance. (<span class="txt-small"><em>Don't
                              forget the &amp; character in the statement</em></span>).<br>
                          Use this argument with lot of care. It is used
                          sometimes for the subtemplate mode. </td>
                      </tr>
                    </tbody>
                  </table>
                  <p>Example: </p>
                  <div class="decal"> <span class="opt-html">HTML</span>: [<span
                      class="opt-name">onshow.x</span>;<span class="opt-name">onformat</span>=<span
                      class="opt-value">f_to_utf8</span>] </div>
                  <div class="decal txt-code"> <span class="opt-html">PHP:</span><br>
                    function <span class="opt-value">f_to_utf8</span>(<span class="opt-name">$FieldName</span>,
                    &amp;<span class="opt-name">$CurrVal</span>) {<br>
                    &nbsp;<span class="opt-name">&nbsp;$CurrVal</span>=
                    utf8_encode(<span class="opt-name">$CurrVal</span>); <br>
                    } </div>
                  <p><span>See chapter '<a href="#html_subtemplate">Subtemplates</a>'
                      for more details about how to use this arguments in
                      subtemplate mode.<br>
                      Since TBS version 3.6.0, it's possible to limit the
                      allowed PHP functions for parameter <span class="opt-name">onformat</span>.
                      See <a href="#php_instanciate">create a new TBS object</a>.
                    </span></p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_protect"></a>protect</span>=<span class="opt-value">val</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to protect or unprotect the data item to be
                    merged by replacing the characters '<span class="opt-html">[</span>'
                    with their corresponding XML/HTML code '<span class="opt-html">&amp;#91;</span>'.
                    The value <span class="opt-name"><span class="opt-value">val</span></span>
                    can be one of the following keywords:<br>
                    &nbsp; <span class="opt-name"><span class="opt-value">yes</span></span>:
                    (default value) data item is protected.<br>
                    &nbsp; <span class="opt-name"><span class="opt-value">no</span></span>:
                    data item is not protected. </p>
                  <p> By default, all data merged with a template is protected
                    except if it's a file inclusion. It is strongly recommended
                    to protect data when it comes from free enter like on a
                    forum for example.</p>
                  <p> Nevertheless, it is possible to disable the protection by
                    default if you set TBS option <a href="#php_setoption" class="opt-name">'protect'</a>
                    to <span class="opt-value">false</span>.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><span
                      class="opt-value"><a id="html_field_prm_ope"></a></span>ope</span>=<span
                    class="opt-value">action</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Makes one or several operations on the value to merge. You
                    can define several operations to be processed in order by
                    separating them with coma (,).</p>
                  <p> Example: </p>
                  <div class="decal">[<span class="opt-name">onshow</span>.<span
                      class="opt-name">x</span>;<span class="opt-name">ope</span>=<span
                      class="opt-value">add:-1</span>,<span class="opt-value">mod:10</span>]</div>
                  <p>Supported operations are: </p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="3" border="0">
                      <tbody>
                        <tr>
                          <td class="opt-value" width="50" valign="top">max:n</td>
                          <td>Limit the text string to a maximum of <span class="opt-value">n</span>
                            characters. If the string is cut, then its end is
                            replaced with dot lines '...'.<br>
                            Example: [onshow.caption;<span class="opt-name">ope</span>=<span
                              class="opt-value">max:10</span>]
                            <ul class="list-mini">
                              <li> Add parameter <span class="opt-name">maxhtml</span>
                                to indicate that the value before merging can
                                contain Html characters. Only characters
                                starting with "<span class="opt-name">&amp;"</span>
                                end ending with "<span class="opt-name">;</span>"
                                will be considered. HTML entities are not
                                considered as HTML characters.</li>
                              <li> Add parameter <span class="opt-name">maxutf8</span>
                                to indicate that the value before merging can
                                contain UTF8 characters. <span class="versioning">Versionning:
                                  maxutf8 is supported since TBS version 3.5.2.</span></li>
                              <li> Add parameter <span class="opt-name">maxend</span>
                                to change the cutting symbol.</li>
                            </ul>
                            Example:
                            [onshow.caption;ope=max:10;maxhtml;maxend='+']</td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">mod:n</td>
                          <td>Apply the modulo <span class="opt-value">n</span>
                            to the value to merge. Example: [onshow.numlig;<span
                              class="opt-name">ope</span>=<span class="opt-value">mod:7</span>]</td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">add:n</td>
                          <td>Add the numeric <span class="opt-value">n</span>
                            to the value to merge. Example: [onshow.number;<span
                              class="opt-name">ope</span>=<span class="opt-value">add:-1</span>]</td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">mul:n</td>
                          <td>Mutlyplies the value to merge by the numeric <span
                              class="opt-value">n</span>. </td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">div:n</td>
                          <td>Divises the value to merge by the numeric <span class="opt-value">n</span>.
                          </td>
                        </tr>
                        <tr>
                          <td valign="top"><span class="opt-value">list</span></td>
                          <td>If the value before merging is a Php Array, then
                            its items are displayed separated with a coma (,).<br>
                            <span class="decal">Example: [onshow.myarray;<span class="opt-name">ope</span>=<span
                                class="opt-value">list</span>]</span><br>
                            Add parameter valsep in order to change the item
                            separator.<br>
                            <span class="decal">Example: [onshow.myarray;<span class="opt-name">ope</span>=<span
                                class="opt-value">list</span>;<span class="opt-name">valsep</span>=<span
                                class="opt-value">'+'</span>]</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">mok:x</td>
                          <td><em>(means "magnet ok")</em> To be used with
                            parameter <a href="#html_field_prm_magnet" class="opt-name">magnet</a>.
                            The TBS field is never displayed, but the magnet tag
                            is kept when the value of the field is equal to <span
                              class="opt-value">'x'</span>. The magnet tag is
                            deleted in other cases. You cannot use <span class="opt-value">mok</span>
                            and <span class="opt-value">mko</span> in the same
                            TBS field. You can define several values to keep the
                            magnet tag by defining several <span class="opt-value">mok</span>.
                            Example: [onshow.x;magnet=div;<span class="opt-name">ope</span>=<span
                              class="opt-value">mok:1</span>,<span class="opt-value">mok:2</span>]
                            <span class="versioning">(mok is supported since TBS
                              version 3.5.2)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">mko:x</td>
                          <td><em>(means "magnet ko")</em> To be used with
                            parameter <a href="#html_field_prm_magnet" class="opt-name">magnet</a>.
                            The TBS field is never displayed, but the magnet tag
                            is deleted when the value of the field is equal to <span
                              class="opt-value">'x'</span>. The magnet tag is
                            kept in other cases. You cannot use <span class="opt-value">mok</span>
                            and <span class="opt-value">mko</span> in the same
                            TBS field. You can define several values to delete
                            the magnet tag by defining several <span class="opt-value">mko</span>.
                            Example: [onshow.x;magnet=div;<span class="opt-name">ope</span>=<span
                              class="opt-value">mko:1</span>,<span class="opt-value">mko:2</span>]
                            <span class="versioning">(mko is supported since TBS
                              version 3.5.2)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">nif:x</td>
                          <td><em>(means "null if")</em> If the value is equal
                            to <span class="opt-value">'x'</span> then it is
                            replaced with <span class="opt-value">''</span> <span
                              class="txt-small">(empty string)</span>. This
                            operation is designed to make parameter <a href="#html_field_prm_magnet"
                              class="opt-name">magnet</a> to work with other
                            values than <span class="opt-value">''</span>. <span
                              class="versioning">(supported since TBS version
                              3.3.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">minv</td>
                          <td><em>(means "magnet invisible")</em> Replace the
                            value with <span class="opt-value">''</span> <span
                              class="txt-small">(empty string)</span> but
                            parameter <a href="#html_field_prm_magnet" class="opt-name">magnet</a>
                            will consider the old value. This operation is
                            designed to make totaly invisible a TBS field which
                            do magnet stuffs. <span class="versioning">(supported
                              since TBS version 3.3.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">msk:x</td>
                          <td><em>(means "mask")</em> Apply a mask to the value.
                            Characters '<span class="opt-value">*</span>' in the
                            mask will be replaced by the original value.
                            Example: [onshow.img_id;<span class="opt-name">ope</span>=<span
                              class="opt-value">msk:img_*.gif</span>] <span class="versioning">(supported
                              since TBS version 3.6.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">lower</td>
                          <td>Convert the value to lower case. <span class="versioning">(supported
                              since TBS version 3.8.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">upper</td>
                          <td>Convert the value to upper case. <span class="versioning">(supported
                              since TBS version 3.8.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">upper1</td>
                          <td>Convert the value to upper case for the first
                            character only. <span class="versioning">(supported
                              since TBS version 3.8.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">upperw</td>
                          <td>Convert the value to upper case for the first
                            character of each word. <span class="versioning">(supported
                              since TBS version 3.8.0)</span></td>
                        </tr>
                        <tr>
                          <td class="opt-value" valign="top">utf8</td>
                          <td>Can be used with <span class="opt-value">max</span>,
                            <span class="opt-value">upper</span>, <span class="opt-value">lower</span>,
                            <span class="opt-value">upperw</span> in order to
                            indicate that the value is UTF8 encoded. <span class="opt-value">upper1</span>
                            is not supported in UTF8. <span class="versioning">(supported
                              since TBS version 3.8.0)</span></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="versioning">
                    <p>Versioning:</p>
                    <ul class="list-mini">
                      <li> Parameter ope is supported since TBS version 3.0. It
                        replaces parameter max which doesn't exist since this
                        version.</li>
                      <li> Multiple operations and 'mul" and "div" are supported
                        since TBS version 3.2.0.</li>
                    </ul>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_field_prm_frm"></a>frm</span>=<span class="opt-value">format</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Specify a format to display for a data item which type is
                    date/time or numeric. It is possible to use a conditional
                    format which changes depending on the sign of the value. The
                    format is considered as numeric type as soon as it contains
                    the character <span class="opt-value">0</span>, otherwise
                    it is considered as date/time type. </p>
                  <h5>Date-time format: </h5>
                  <p>It is a VisualBasic like format. The following keywords are
                    recognized: </p>
                  <table cellspacing="0" cellpadding="0" border="0">
                    <tbody>
                      <tr>
                        <td width="150" valign="top"><span class="opt-value">d</span>,
                          <span class="opt-value">dd</span>, <span class="opt-value">ddd</span>,
                          <span class="opt-value">dddd</span>:</td>
                        <td>number of the day, number of the day in two digits,
                          short name of the day, full name of the day. Add
                          keyword <span class="opt-value">(locale)</span> to
                          display locale names.</td>
                      </tr>
                      <tr>
                        <td class="opt-value" valign="top">xx</td>
                        <td>displays <span class="opt-html">st</span>, <span class="opt-html">nd</span>,
                          <span class="opt-html">rd</span> or <span class="opt-html">th</span>
                          depending to the number of the day.</td>
                      </tr>
                      <tr>
                        <td class="opt-value" valign="top">w</td>
                        <td>number of the day in the week (from 0 to 6) </td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-value">m</span>, <span
                            class="opt-value">mm</span>, <span class="opt-value">mmm</span>,
                          <span class="opt-value">mmmm</span>: </td>
                        <td>number of the month, number of the month in two
                          digits, short name of the month, full name of the
                          month. Add keyword <span class="opt-value">(locale)</span>
                          to display locale names.</td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-value">yy</span>, <span
                            class="opt-value">yyyy</span>:</td>
                        <td>year in two digits, full year. </td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-value">hh</span>, <span
                            class="opt-value">rr</span>, <span class="opt-value">nn</span>,
                          <span class="opt-value">ss</span>:</td>
                        <td>hour-24, hour-12, minutes, seconds forced on two
                          digits.</td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-value">h</span>, <span
                            class="opt-value">r</span></td>
                        <td>hour-24, hour-12 </td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-value">ampm</span>, <span
                            class="opt-value">AMPM</span> : </td>
                        <td>"am" or "pm" signal , "AM" or "PM" signal.</td>
                      </tr>
                      <tr>
                        <td class="opt-value" valign="top">(locale)</td>
                        <td>Display locale day and month's names. The locale
                          language can be set using the PHP function <span class="txt-code"><a
                              href="http://www.php.net/setlocale" target="_blank">setlocale()</a></span>.
                          It works only if locale parameters have been set on
                          the server. For PHP reasons, in locale mode <span class="opt-value">xx</span>
                          does not work and <span class="opt-value">d</span>
                          does like <span class="opt-value">dd</span>. </td>
                      </tr>
                    </tbody>
                  </table>
                  <p>Other characters are kept. It is possible to protect the
                    strings inside by putting them between double quotes ("). </p>
                  <p> Examples: </p>
                  <p class="decal">[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                      class="opt-name">frm</span>=<span class="opt-value">mm/dd/yyyy</span>]
                    will display <span class="opt-html">12/21/2002</span><br>
                    [<span class="opt-value"><span class="opt-name">fld</span>;<span
                        class="opt-name">frm</span>='yyyy-mm-dd hh:nn:ss'</span>]
                    will display <span class="opt-html">2002-12-21 15:45:03</span></p>
                  <p>Interpretation of merged values:</p>
                  <ul class="list-mini">
                    <li>If the PHP type of the data item is <em>numerical</em>,
                      then it is considered as a Unix timestamp.</li>
                    <li>If the PHP type of the data item is <em>string</em>,
                      then it is first considered as a formatted date-time and
                      will be converted into timestamp using <a href="http://php.net/manual/en/function.strtotime.php">strtotime()</a>.
                      In case of failure, the original string value will be
                      considered as a timestamp.</li>
                    <li>If the PHP type of the data item is <em>object</em>,
                      then, then it will be converted into string<a href="http://php.net/manual/en/function.strtotime.php"></a>.</li>
                    <li>Other PHP types will not be formatted and will be
                      displayed converted into string.</li>
                  </ul>
                  <p>It is recommended to use parameter <span class="opt-name">frm</span>
                    with date-time value that use a non-ambiguous string
                    representation, such as "yyyy-mm-dd hh:nn:ss". Most of PHP
                    driver for Database System return date-time values and
                    timestamp values is this format.</p>
                  <div class="versioning">
                    <p>Versioning:</p>
                    <ul class="list-mini">
                      <li> Keywords <span class="opt-value">ampm</span> and <span
                          class="opt-value">AMPM</span> are supported since TBS
                        version 3.0.</li>
                      <li> Keyword <span class="opt-value">hm</span> was
                        supported since TBS 3.0 and is deprecated and replaced
                        with keyword <span class="opt-value">rr</span> since
                        TBS version 3.2.0.</li>
                      <li> Keywords <span class="opt-value">rr</span>, <span class="opt-value">r</span>,
                        and <span class="opt-value">h</span> are supported
                        since TBS version 3.2.0.</li>
                      <li> Keyword <span class="opt-value">(locale)</span> is
                        supported since TBS version 3.4.0.</li>
                    </ul>
                  </div>
                  <h5>Numeric format: </h5>
                  <p> To define the decimal part, use an expression like '<span
                      class="opt-value">0d0...</span>' where <span class="opt-value">'d'</span>
                    is the decimal separator , and <span class="opt-value">'0...'</span>
                    is a continuation of zeros corresponding to the number of
                    decimals.<br>
                    If there is no decimal, use the format '<span class="opt-value">0.</span>'
                    (with a dot). </p>
                  <p> To define a thousand separator, use an expression like '<span
                      class="opt-value">0t000d...</span>' where <span class="opt-value">'t</span>'
                    is the thousand separator. If there is no decimal, use the
                    format '<span class="opt-value">0t000.</span>' (with a dot).
                  </p>
                  <p> In order to display leading zeros, use an expression like
                    '<span class="opt-value">0000d...</span>' where <span class="opt-value">'0000</span>'
                    represents the number of digits you want to have. If there
                    is no decimal, use the format '<span class="opt-value">0000.</span>'
                    (with a dot). <span class="versioning">Versioning: This
                      feature is supported since TBS version 3.5.2.</span></p>
                  <p> If the format contains the character '<span class="opt-value">%</span>',
                    then the value to display will be multiplied by 100. The
                    character '<span class="opt-value">%</span>' is displayed
                    too.</p>
                  <p> The numerical format may contain other strings. But only
                    the expression with one or more zeroes placed to the right
                    will be taken as a format, other characters will be kept.</p>
                  <p> Examples: </p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="1" border="0">
                      <tbody>
                        <tr>
                          <th width="100">Value</th>
                          <th width="160">Field</th>
                          <th width="100">Display</th>
                        </tr>
                        <tr>
                          <td>2456.1426</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">0.000</span>']</td>
                          <td class="opt-html">2456.143</td>
                        </tr>
                        <tr>
                          <td>&nbsp;</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">$
                              0,000.00</span>']</td>
                          <td class="opt-html">$ 2,456.14</td>
                        </tr>
                        <tr>
                          <td>&nbsp;</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">$
                              0,000.</span>']</td>
                          <td class="opt-html">$ 2,456</td>
                        </tr>
                        <tr>
                          <td>&nbsp;</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">000000.</span>']</td>
                          <td class="opt-html">002456</td>
                        </tr>
                        <tr>
                          <td>0.2537</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">0.00
                              %</span>']</td>
                          <td class="opt-html">25.37%</td>
                        </tr>
                        <tr>
                          <td>&nbsp;</td>
                          <td>[<span class="opt-value"><span class="opt-name">fld</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">coef
                              0.00</span>']</td>
                          <td class="opt-html">coef 0.25</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <h5>Conditional formats: </h5>
                  <p>You have the possibility to define up to 4 conditional
                    formats when the value is respectively positive, negative,
                    zero or null (or empty string). Conditional formats must be
                    separated by a '|' character. Each conditional format is
                    optional.</p>
                  <p> Examples: </p>
                  <div class="decal">
                    <table cellspacing="0" cellpadding="1" border="0">
                      <tbody>
                        <tr>
                          <th>Value</th>
                          <th>Field</th>
                          <th>Display</th>
                        </tr>
                        <tr>
                          <td width="100">2456.1426</td>
                          <td width="230">[<span class="opt-value"><span class="opt-name">chp</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">+0.00|-(0.00)|*|empty</span>']</td>
                          <td class="opt-html" width="100">+2456.14</td>
                        </tr>
                        <tr>
                          <td>-156.333</td>
                          <td>[<span class="opt-value"><span class="opt-name">chp</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">+0.00|-(0.00)|*|</span><span
                              class="opt-value">empty</span>']</td>
                          <td class="opt-html">-(156.33)</td>
                        </tr>
                        <tr>
                          <td>0</td>
                          <td>[<span class="opt-value"><span class="opt-name">chp</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">+0.00|-(0.00)|*|</span><span
                              class="opt-value">empty</span>']</td>
                          <td class="opt-html">*</td>
                        </tr>
                        <tr>
                          <td>null</td>
                          <td>[<span class="opt-value"><span class="opt-name">chp</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">+0.00|-(0.00)|*|</span><span
                              class="opt-value">empty</span>']</td>
                          <td class="opt-html">empty</td>
                        </tr>
                        <tr>
                          <td>-8.75</td>
                          <td>[<span class="opt-value"><span class="opt-name">chp</span></span>;<span
                              class="opt-name">frm</span>='<span class="opt-value">+0.00|-(0.00)</span>']</td>
                          <td class="opt-html">-(8.75)</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a name="html_field_prm_combo"></a><span
                    class="opt-name">combo=<span class="opt-value">names</span></span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Apply combo's parameters. A combo is a set of parameters
                    that have been previously defined at the PHP side using
                    method <a href="#php_setoption" class="txt-code">SetOption('prm_combo')</a>.</p>
                  <p> Any other explicit parameters in the TBS field will
                    override parameters coming from the combo.</p>
                  <p>You can apply several combo by separating names with coma
                    (,).</p>
                  <p> Combo are useful to make reusable set of parameters, or to
                    shorten a TBS tag when parameter are too long for the
                    template. See also method <a href="#php_replacefields" class="txt-code">ReplaceField()</a>
                    in order to shorten fields in the template.</p>
                  <p>Example:</p>
                  <div class="decal txt-code"> <span class="opt-html">PHP:</span><br>
                    <span class="opt-name">$TBS</span>-&gt;SetOption(<span class="opt-name">'prm_combo'</span>,
                    <span class="opt-value">'add_date'</span>, array(<span class="opt-name">'att'</span>=&gt;<span
                      class="opt-value">'div#data-date'</span>, <span class="opt-name">'frm'</span>=&gt;<span
                      class="opt-value">'yyyy-mm-dd'</span>, <span class="opt-name">'magnet'</span>=&gt;<span
                      class="opt-value">'div'</span>, <span class="opt-name">'enlarge'</span>=&gt;<span
                      class="opt-value">'span'</span>));</div>
                  <div class="decal"> <span class="opt-html">HTML</span>: [<span
                      class="opt-name">onshow.x</span>;<span class="opt-name">combo</span>=<span
                      class="opt-value">add_date</span>] </div>
                  <p class="versioning"> Versioning: parameter combo is
                    supported since TBS version 3.11.0.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_locale"></a><span
                    class="opt-name">locale</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p><span class="versioning">Deprecated since TBS version
                      3.4.0.</span><br>
                    It does the same as the keyword <span class="opt-value">(locale)</span>
                    used in parameter <a href="#html_field_prm_frm" class="opt-name">frm</a>.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_tplfrms"></a><span
                    class="opt-name">tplfrms</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to define formats in the template that you can
                    reuse for parameter <a href="#html_field_prm_frm" class="opt-name">frm</a>.
                    Works only with <span class="opt-name">onload</span> <a href="#html_field_auto">automatic
                      fields</a>. <br>
                    It is the same feature as option <a href="#php_setoption_tpl_frms"
                      class="opt-name">tpl_frms</a>, but option <span class="opt-name"><a
                        href="#php_setoption_tpl_frms" class="opt-name">tpl_frms</a><a
                        href="#php_setoption_tpl_frms"></a></span> is defined in
                    the PHP side, while parameter <a href="#html_field_prm_tplfrms"
                      class="opt-name">tplfrms</a> is defined in the template
                    side. </p>
                  <p> Example:</p>
                  <div class="decal">[onload;<span class="opt-name">tplfrms</span>;<span
                      class="opt-value">doll</span>=$ 0,000.00;<span class="opt-value">mydt</span>=yyyy-mm-dd]<br>
                    [onshow.amount;<span class="opt-name">frm</span>=<span class="opt-value">doll</span>]
                    ... [onshow.date;<span class="opt-name">frm</span>=<span class="opt-value">mydt</span>]
                    <br>
                  </div>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_field_prm_tplvars"></a><span
                    class="opt-name">tplvars</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Enables you to define variables in the template that you
                    can retrieve in the Php programm using <a href="#php_tplvars">TplVars
                      property</a>. Works only with <span class="opt-name">onload</span>
                    <a href="#html_field_auto">automatic fields</a>. </p>
                </td>
              </tr>
            </tbody>
          </table>
          <h4><a id="html_field_prm_order"></a>Order of processing parameters:</h4>
          <p>When you want to use several parameters in the same TBS field, then
            it can be interesting to understand in which order they are
            processed. <br>
            TBS changes the value to be merged, without changing the original
            value.</p>
          <p>Order of processes:</p>
          <ol>
            <li> Retreive the value of the field to be merged.</li>
            <li> Change the value using parameters:
              <ol>
                <li><a href="#html_field_prm_onformat" class="opt-name">onformat</a></li>
                <li><a href="#html_field_prm_ope" class="opt-name">ope</a> +
                  plug-ins OnOperation</li>
                <li><a href="#html_field_prm_frm" class="opt-name">frm</a> or <a
                    href="#html_field_prm_strconv" class="opt-name">strconv</a>
                  or default char conversion</li>
                <li><a href="#html_field_prm_if" class="opt-name">if</a></li>
                <li><a href="#html_field_prm_file" class="opt-name">file</a></li>
                <li><a href="#html_field_prm_script" class="opt-name">script</a></li>
                <li><a href="#html_field_prm_att" class="opt-name">att</a></li>
                <li><a href="#html_field_prm_ifempty" class="opt-name">ifempty</a>
                  or <a href="#html_field_prm_atttrue" class="opt-name">atttrue</a>
                  or <a href="#html_field_prm_magnet" class="opt-name">magnet</a>
                  or <a href="#html_field_prm_attadd" class="opt-name">attadd</a>,
                  those parameters cannot work together, the first used in this
                  list is applied</li>
              </ol>
            </li>
            <li> Insert the value in the template. </li>
          </ol>
        </div>
        <h3><a name="html_field_auto" id="html_field_auto"></a>Automatic fields</h3>
        <div class="norm">
          <p>Automatic fields enable you to automatically merge data when some
            events occur. </p>
          <p> Automatic fields support <a href="#php_mergeblock_subnames">subnames</a>.
            They merges items stored in <span class="txt-code">$TBS-&gt;VarRef</span>.
            By default <span class="txt-code">$TBS-&gt;VarRef</span> is a
            reference on <span class="opt-name">$GLOBAL</span>. See property <a
              href="#php_varref">VarRef</a> for more details.</p>
          <p>Automatic fields can also merge TBS special information (see <a href="#html_field_special">Special
              automatic fields</a>), or data of the ObjectRef property (see <a
              href="#php_oop">Objet Oriented Programming</a>).</p>
          <p>An automatic field without subname will be merged with an empty
            string value ('').</p>
          <p> There are three types of automatic fields:</p>
          <ul>
            <li><span class="opt-name">[onload]</span> fields, which are
              automatically merged when the <a href="#php_loadtemplate">LoadTemplate()</a>
              method is called.</li>
            <li><span class="opt-name">[onshow]</span> fields, which are
              automatically merged when the <a href="#php_show">Show()</a>
              method is called.</li>
            <li><span class="opt-name">[var]</span> fields, which are
              automatically merged only if they are embedded into parameter <a
                href="#html_field_prm_file" class="opt-name">file</a>, <a href="#html_field_prm_script"
                class="opt-name">script</a>, <a href="#html_field_prm_if" class="opt-name">if</a>,
              <span class="opt-name">then</span>, <span class="opt-name">else</span>
              or <a href="#html_block_prm_when" class="opt-name">when</a>. Thus
              placed, they are merged when their parent are merged.</li>
          </ul>
          <p>Of course automatic fields support all <a href="#html_field_auto">fields'
              parameters</a>.</p>
          <p>Examples :</p>
          <table class="decal" cellspacing="4">
            <tbody>
              <tr>
                <td><span class="opt-html">[onload.x]</span></td>
                <td>Will be merged with the global variable $x when the <a href="#php_loadtemplate">LoadTemplate()</a>
                  method is called.</td>
              </tr>
              <tr>
                <td><span class="opt-html">[onshow.x]</span></td>
                <td>Will be merged with the global variable $x when the <a href="#php_show">Show()</a><a
                    href="#php_loadtemplate"></a> method is called.</td>
              </tr>
              <tr>
                <td><span class="opt-html">[onload;file=header.html]</span></td>
                <td>Inserts a subtemplate when <a href="#php_loadtemplate">LoadTemplate()</a>
                  method is called.</td>
              </tr>
              <tr>
                <td class="opt-html">[b1.col1;if [val]=[<span class="opt-html">var</span>.x];then
                  'good'; else 'bad']</td>
                <td>The [<span class="opt-name">var</span>.x] field will be
                  merged only when its parent [<span class="opt-name">b1</span>.col1]
                  is merged.</td>
              </tr>
            </tbody>
          </table>
          <p>Automatic fields <u>cannot</u> merge a variable which is local to
            a function. You can add your local variable to <span class="txt-code">$TBS-&gt;VarRef</span>,
            or you can merge it using <a href="#php_mergefield">MergeField()</a>.</p>
          <p>Note: You can force the merge of automatic fields using <a href="#php_mergefield">MergeField()</a>.</p>
          <h4><a name="html_field_auto_embedded" id="html_field_auto_embedded">Embedded
              automatic fields</a></h4>
          <a name="html_field_auto_embedded" id="html_field_auto_embedded">
            <p>Some parameters can manage embedded TBS fields. That is those
              embedded fields will be automatically merged at the time the
              parameter is evaluated.</p>
          </a>
          <p><a name="html_field_auto_embedded" id="html_field_auto_embedded">Inside
              parameters </a><a href="#html_field_prm_file" class="opt-name">file</a>,
            <a href="#html_field_prm_script" class="opt-name">script</a>, <a href="#html_field_prm_if"
              class="opt-name">if</a>, <span class="opt-name">then</span>, <span
              class="opt-name">else</span>, embedded automatic fields are : <span
              class="opt-name">[var]</span> and <span class="opt-name">[val]</span>.</p>
          <p>Inside parameters <a href="#html_field_prm_file" class="opt-name">when</a>,
            embedded automatic fields are : <span class="opt-name">[var]</span>
            and the fields of the same block.</p>
          <p>Note that the special fields <span class="opt-name">[val]</span>
            and <span class="opt-name">[var]</span> won't be merged when placed
            inside other parameters.</p>
          <p>Note that other ordinary embedded fields <span class="opt-name"></span>
            won't be merged when placed inside any other parameters. You have to
            ensure that such fields are merged before, otherwise the merged
            result could be unexpected. Most of the time such embedded fields
            are simply not merged.</p>
          <p> Bad templating examples:</p>
          <p class="decal"><span class="opt-html">[onload;if [onload.x]=1;then
              'yes';else 'no']</span><br>
            This example will always display <span class="opt-html">'no'</span>,
            because the embedded field <span class="opt-html">[onload.x]</span>
            will never be merged (only [val] and [var] could be merged here).<br>
            Corrects expressions are :<br>
            <span class="opt-html">&nbsp;&nbsp;[onload;if [var.x]=1;then
              'yes';else 'no']</span><br>
            <span class="opt-html">&nbsp;&nbsp;[onload.x;if [val]=1;then
              'yes';else 'no']</span></p>
          <p class="decal"><span class="opt-html">[b1.nom;block=tr;headergrp=[var.x]]</span><br>
            In this example, [var.x] will not be merged yet when you call <span
              class="txt-code"><span class="opt-value">$TBS-&gt;MergeBlock('b1',...)</span></span><br>
            The header will then be defined badly. <br>
            It needs one of those: <br>
            - using an onload field: <span class="opt-html">[b1.name;block=tr;headergrp=[onload.x]]</span><br>
            - calling <span class="opt-value"><span class="txt-code">$TBS-&gt;MergeField('var')
                </span></span>avant<span class="opt-value"><span class="txt-code">
                $TBS-&gt;MergeBlock('b1',...)</span></span><br>
            - using a customized field name: <span class="opt-html">[b1.name;block=tr;headergrp=[zzz]]</span>
            manually merged with <span class="opt-value"><span class="txt-code">$TBS-&gt;MergeField('zzz',$x)</span></span></p>
          <h4>Security: how to limit automatic fields usage in templates?</h4>
          <p> You can limit the automatic fields usage by defining a prefix for
            allowed PHP variables. For details, see <a href="#php_instanciate">create
              a new TBS object</a>.</p>
          <h4>Prevent from processing automatic fields [onload] and [onshow]</h4>
          <p>TBS options <a href="#php_setoption_onload" class="opt-name">onload</a>
            and <a href="#php_setoption_onshow" class="opt-name">onshow</a>
            enable you to cancel the processing of [onload] and [onshow] fields.
            Those options accept only <span class="opt-value">true</span> of <span
              class="opt-value">false</span> values. This can be very useful
            especially, but not only, for some TBS plug-ins. Note that [var]
            fields are automatically processed even if <a href="#php_setoption_onshow"
              class="opt-name">onshow</a> option is set to <span class="opt-value">false</span>.
            See method <a href="#php_setoption">SetOptions()</a> for more
            details about TBS options.</p>
          <div class="versioning">
            <p>Versioning:</p>
            <ul class="list-mini">
              <li>Automatic fields <span class="opt-name">[onload]</span> and <span
                  class="opt-name">[onshow]</span> are supported since TBS
                version 3.2.0. For compatibility with versions prior to 3.2.0,
                remaining <span class="opt-name">[var]</span> fields are still
                merged as if there were <span class="opt-name">[onshow]</span>
                fields but is it recommended to use real <span class="opt-name">[onshow]</span>
                fields instead.</li>
              <li><span class="opt-name">[var]</span> are processed into
                parameter <span class="opt-name">then</span> and <span class="opt-name">else</span>
                since TBS version 2.02.</li>
              <li>Options <span class="opt-name">onload</span> and <span class="opt-name">onshow</span>
                are supported since TBS version 3.8.0</li>
              <li>Properties <span class="txt-code">$TBS-&gt;OnLoad</span> and
                <span class="txt-code">$TBS-&gt;OnShow</span> do act like the
                corresponding options but are deprectated. Those properties are
                supported since TBS version 3.6.0.</li>
            </ul>
          </div>
          <p></p>
        </div>
        <h3><a name="html_field_special"></a>Special automatic fields:</h3>
        <div class="norm">
          <p>A Special automatic field is a TBS automatic field which has a
            special name and can display special data provided by the template
            engine.<br>
            The special names can work only with <a href="#html_field_auto">automatic
              fields</a>. That is [<span class="opt-name">onload</span>], [<span
              class="opt-name">onshow</span>] and [<span class="opt-name">var</span>].<br>
            The scpecial names always have a double dot before the key instead
            of one. <br>
          </p>
          <p> Example: <span class="opt-html">Date of the day : </span>[onshow.<span
              class="opt-name">.now</span>;frm='mm-dd-yyyy'] </p>
          <h5>Available keys for special automatic fields:</h5>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Key</th>
                <th>Description</th>
                <th>Example</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">now</td>
                <td align="left" valign="top">Date and hour of the server.</td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.now</span>;frm='mm-dd-yyyy']</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">version</td>
                <td align="left" valign="top"> The version of TinyButStrong. </td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.version</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">script_name</td>
                <td align="left" valign="top">The name of the PHP file currently
                  executing.</td>
                <td align="left" valign="top">&lt;form action="[onshow.<span class="opt-name">.script_name</span>]"&gt;</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">template_name</td>
                <td align="left" valign="top">The name of the last loaded
                  template file.<br>
                  It is the name given to the <a href="#php_loadtemplate">LoadTemplate()</a>
                  method.</td>
                <td align="left" valign="top">&nbsp;</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">template_date</td>
                <td align="left" valign="top">The creation date of the last
                  loaded template file.</td>
                <td align="left" valign="top">&nbsp;</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">template_path</td>
                <td align="left" valign="top">The directory of the last loaded
                  template file.<br>
                  It is the directory given to the <a href="#php_loadtemplate">LoadTemplate()</a>
                  method.</td>
                <td align="left" valign="top">&nbsp;</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">tplvars.*</td>
                <td align="left" valign="top">The value of an item set in the <a
                    href="#php_tplvars">TplVars</a> property.<br>
                  ('*' must be the key of an existing item in the array)</td>
                <td align="left" valign="top"> [onshow.<span class="opt-name">.tplvars.title</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">cst.*</td>
                <td align="left" valign="top">The value of a PHP constant.<br>
                  (* must be the name of an existing constant) </td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.cst.PHP_VERSION</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">tbs_info</td>
                <td align="left" valign="top">Information about TBS and
                  installed plug-ins. </td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.tbs_info</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">error_msg</td>
                <td align="left" valign="top">Display errors that have been
                  avoid during the time when TBS option <a href="#php_setoption"
                    class="opt-name">noerr</a> is set to <span class="opt-value">true</span>.</td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.error_msg</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">php_info</td>
                <td align="left" valign="top">Display the PhpInfo sight, the
                  same as the PHP function phpinfo().</td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.php_info</span>]</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">store.*</td>
                <td align="left" valign="top">Display the contents aggregated in
                  a store.</td>
                <td align="left" valign="top">[onshow.<span class="opt-name">.store.default</span>]</td>
              </tr>
            </tbody>
          </table>
          <div class="versioning">
            <p>Versioning:</p>
            <ul class="list-mini">
              <li> special var fields <span class="opt-name">cst</span> and <span
                  class="opt-name">tbs_info</span> are supported since TBS
                version 3.2.0.</li>
              <li><span class="opt-name">error_msg</span> is supported since TBS
                version 3.5.0.</li>
              <li><span class="opt-name">php_info</span> and <span class="opt-name">store</span>
                are supported since TBS version 3.8.0.</li>
            </ul>
          </div>
        </div>
        <h3><a id="html_block"></a>TBS Blocks:</h3>
        <div class="norm">
          <p>A TBS block enables you define a zone and to display data from a
            record source. You can define a TBS block using one or two TBS tags
            (see below). </p>
          <h4>Merging with data:</h4>
          <p> Merging a block with data is done using the <a href="#php_mergeblock">MergeBlock()</a>
            method. When a TBS block is merged with data, it is repeated as many
            times as there are records; and the associated TBS fields are
            replaced by the value of the columns stored in the current record.<br>
            A TBS field associated to a block is identified by its name which
            should be made of the name of the block followed by the name of the
            column to display and separated by a dot.</p>
          <p> Examples: </p>
          <div class="decal"> - [<span class="opt-name">Block1</span>.<span class="opt-name">ColumnA</span>]
            This field will display the value of column <span class="opt-name">ColumnA</span>
            when block <span class="opt-name">Block1</span> is merged. <br>
            - [<span class="opt-name">Blokc1</span>.<span class="opt-name">ColumnB</span>;<span
              class="opt-name">frm</span>=<span class="opt-value">'dd-mm-yyyy'</span>]
            Another field but with a TBS parameter. </div>
          <p> The dot (.) is a special character reserved for sub-names in TBS
            field. It cannot be used in a column's name.</p>
          <p class="versioning"> The space character ( ) is supported in column
            names since TBS version 3.5.0. </p>
          <p><em>Remark:</em> when two separated blocks have the same name, then
            they will be considered has two sections of the same block. All
            content placed between those two sections of a block will be <strong>ignored
              and deleted</strong> during the merging. See <a href="#html_block_section">sections
              of blocks</a> to know more about sections.</p>
          <h4>Block syntaxes:</h4>
          <p>There are three possible syntaxes to define a TBS block: </p>
          <h5>Explicit Syntax:</h5>
          <div class="decal">Two TBS tags are used. One for the beginning of the
            block and another for the end of the block.<span class="opt-html"></span><span
              class="opt-html"></span>
            <div class="decal">Example:<br>
              <span class="opt-html"><strong>TEMPLATE...</strong></span>[<span class="opt-name">BlockName</span>;<span
                class="opt-name">block</span>=<span class="opt-value">begin</span><span
                class="opt-value">;<span class="opt-name">params</span></span>]<span
                class="opt-html"><strong>...TEMPLATE...</strong></span>[<span class="opt-name">BlockName</span>;<span
                class="opt-name">block</span>=<span class="opt-value">end</span>]<span
                class="opt-html"><strong>...TEMPLATE</strong></span></div>
            Those TBS tags for the block definition will be deleted during the
            merging.</div>
          <h5>Relative Syntax:</h5>
          <div class="decal">The block is defined by a pair of opening-closing
            XML/HTML tags which is given by a single TBS tag.
            <div class="decal">Example:<br>
              <span class="opt-html"><strong>TEMPLATE...&lt;tag_name...&gt;...</strong></span>[<span
                class="opt-name">BlockName</span>;<span class="opt-name">block</span>=<span
                class="opt-value">tag_name;<span class="opt-name">params</span></span>]<span
                class="opt-html"><strong>...&lt;/tag_name...&gt;...TEMPLATE</strong></span></div>
            This TBS tag for the block definition must be placed between the
            pair of XML/HTML tags.<br>
            This TBS tag will be deleted during the merging.<br>
            <em>Remark:</em> You can aslo define a block's zone by a combination
            of XML/HTML tags. See parameter <a href="#html_block_prm_block" class="opt-name">block</a>
            for more details. </div>
          <h5>Simplified Syntax:</h5>
          <div class="decal">An associated TBS field is used to define the block
            in a relative way (see the relative syntax above).
            <div class="decal">Example:<br>
              <span class="opt-html"><strong>TEMPLATE...&lt;tag_name...&gt;...</strong></span>[<span
                class="opt-name">BlockName</span>.<span class="opt-name">ColumnName</span>;<span
                class="opt-name">block</span>=<span class="opt-value">tag_name;<span
                  class="opt-name">params</span></span>]<span class="opt-html"><strong>...&lt;/tag_name...&gt;...TEMPLATE</strong></span></div>
            The TBS tag for the block definition (i.e. the <span class="opt-name">block</span>=<span
              class="opt-value">...</span> parameter) must be placed between the
            pair of XML/HTML tags. You are nor obliged to put the parameter <span
              class="opt-name">block</span> on the first field, it can be any of
            them inside the zone defined by the block. <br>
            <em>Remarks:</em> <br>
            • You should not repeat the parameter <span class="opt-name">block</span>=<span
              class="opt-value">...</span> on each fields of the bloc, only one
            is enough. If you place several of them, this will be accepted by
            TBS but it may bring confusions about complementary parameters for
            block.<br>
            • You can aslo define a block's zone by a combination of XML/HTML
            tags. See parameter <a href="#html_block_prm_block" class="opt-name">block</a>
            for more details. </div>
          <h4>Which syntax to use?</h4>
          <div class="note">
            <p>The 'absolute' syntax is rarely used with Visual Editors because
              TBS tags have often to be placed between two XML/HTML tags. On the
              other hand, it is convenient for textual editors. </p>
            <p> The 'relative' syntax enables you to indicate a block using only
              one TBS tag. Furthermore, there is no need to hide the TBS tag
              because it will be deleted during the displaying. This syntax is
              quite practical.</p>
            <p> The 'simplified' syntax is really simple. It enables you to
              define a TBS block and a TBS Field with only one TBS tag. This
              syntax is the most current and the most practical.</p>
            <p>Tip: You can use the 'relative' or the 'absolute' syntax with
              custom tags using the XML/HTML standard. </p>
            <p> Example:</p>
            <p> <span class="opt-html">&lt;custom_tag&gt;</span>Hello [<span class="opt-name">blk1</span>.<span
                class="opt-name">column1</span>;<span class="opt-name">block</span>=<span
                class="opt-value">custom_tag</span>], how are you?<span class="opt-html">&lt;/custom_tag&gt;</span></p>
          </div>
          <h4> Synopsis of a block tag: </h4>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Element</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">BlockName</td>
                <td align="left" valign="top">The name of the TBS block.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top">params</td>
                <td align="left" valign="top"> Optional. One or several
                  parameters from the list below. Separated with ';'.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><span class="opt-name">block</span>=<span
                    class="opt-value">begin</span></td>
                <td align="left" valign="top">Indicates the beginning of the
                  block.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><span class="opt-name">block</span>=<span
                    class="opt-value">end</span></td>
                <td align="left" valign="top">Indicates the end of the block.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><span class="opt-name"><span class="opt-value"><a
                        id="html_block_prm_block"></a></span>block</span>=<span
                    class="opt-value">tag</span><br>
                  <span class="txt-small">or</span><br>
                  <span class="opt-name">block</span>=<span class="opt-value">expr</span></td>
                <td align="left" valign="top">
                  <p>Define a block bounded by the XML/HTML element, that is
                    between the opening XML/HTML tag <span class="opt-html">&lt;tag...&gt;</span>
                    and the closing XML/HTML tag <span class="opt-html">&lt;/tag&gt;</span>
                    which surround the TBS tag. The couple of indicated XML/HTML
                    tags are integral part of the bloc. The TBS tag can also be
                    placed inside the opening tag.</p>
                  <p> If the element is a single tag ending with "/" (such as <span
                      class="opt-html">&lt;image href="img.gif" /&gt;</span> )
                    then the block is bounded by the single tag. </p>
                  <p> Examples:</p>
                  <div class="decal"><span class="opt-html">&lt;table
                      id="tab1"&gt;</span>&nbsp;<span class="blockzone"><span class="opt-html">&lt;tr&gt;&lt;td&gt;</span>[<span
                        class="opt-name">b1</span>.<span class="opt-name">column1</span>;<span
                        class="opt-name">block</span>=tr]<span class="opt-html">&lt;/td&gt;&lt;/tr&gt;</span></span><span
                      class="opt-html">&lt;/table&gt;</span><br>
                    <span class="txt-small">The block is defined by the zone
                      framed by pointillets.</span></div>
                  <div class="decal"><span class="opt-html">&lt;table
                      id="tab1"&gt;</span>&nbsp;<span class="blockzone"><span class="opt-html">&lt;tr
                        id="row-</span>[<span class="opt-html"><span class="opt-name">b1</span>.<span
                          class="opt-name">column2</span>;<span class="opt-name">block</span></span>=tr]<span
                        class="opt-html">"&gt;&lt;td&gt;</span>[<span class="opt-name">b1</span>.<span
                        class="opt-name">column1</span>]<span class="opt-html">&lt;/td&gt;&lt;/tr&gt;</span></span><span
                      class="opt-html">&lt;/table&gt;</span><br>
                    <span class="txt-small">The TBS tag can be placed inside the
                      opening tag.</span></div>
                  <div class="decal"><span class="opt-html">&lt;div
                      id="image-list"&gt;</span>&nbsp;<span class="blockzone"><span
                        class="opt-html">&lt;image href="img/</span>[<span class="opt-html"><span
                          class="opt-name">b1</span>.<span class="opt-name">column1</span>;<span
                          class="opt-name">block</span></span>=image]<span class="opt-html">"
                        alt="the picture" /&gt;</span></span><span class="opt-html">
                      &lt;/div&gt;</span><br>
                    <span class="txt-small">If the tag is a single tag ending
                      with "/" then the block is bounded by the single tag.</span></div>
                  <h5><a name="html_block_prm_specialmarks"></a>Special marks:</h5>
                  <table cellspacing="0" cellpadding="4" border="0">
                    <tbody>
                      <tr>
                        <td width="80" valign="top"><span class="opt-name">block</span>=<span
                            class="opt-value">_</span></td>
                        <td valign="top">Define a block on the text line which
                          holds the TBS tag. A text line always ends with a
                          new-line char. New lines for Windows, Linux and Mac
                          are supported. This feature is very useful for a
                          template with text contents for example. <span class="versioning">Supported
                            since TBS 3.1.0.</span></td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-name">block</span>=<span
                            class="opt-value">/</span></td>
                        <td valign="top">Define a block on the simple tag
                          containg the TBS field. TBS assumes the tag is ending
                          with "/", otherwise an error occurs. <span class="versioning">Supported
                            since TBS 3.1.0.</span></td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-name">block</span>=<span
                            class="opt-value">.</span></td>
                        <td valign="top">Define a block on the TBS field that
                          contains this parameter. <span class="versioning">Supported
                            since TBS 3.10.0.</span></td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-name">block</span>=<span
                            class="opt-value">tag/</span></td>
                        <td valign="top">Deprectated. By adding character "/" at
                          the end of the tag's name, TBS assumes the tag is
                          single. This syntax is ignored since TBS version 3.5.2
                          because TBS can recognize single tags by itself.
                          Coding "<span class="opt-name">block=image/</span>" is
                          the same as "<span class="opt-name">block=image</span>".</td>
                      </tr>
                    </tbody>
                  </table>
                  <h5><a id="html_block_prm_extblk"></a>Extended blocks:</h5>
                  <p> You can define the block's zone (or the section's zone)
                    beyond the simple XML/HTML elements or special marks by
                    using the following expressions. Note that Special Marks
                    (see above) can be used for extended blocks.</p>
                  <p> To define the block's zone on several successive elements:</p>
                  <div class="decal">
                    <p><span class="opt-html">&lt;ul&gt;...&lt;/ul&gt;</span><span
                        class="blockzone"><span class="opt-html">&lt;div&gt;</span>[<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">div</span>+<span
                          class="opt-value">div</span>+<span class="opt-value">div</span>+<span
                          class="opt-value">table</span>]<span class="opt-html">&lt;/div&gt;<span
                            class="blocksep">&lt;</span>div&gt;...&lt;/div&gt;<span
                            class="blocksep">&lt;</span>div&gt;...&lt;/div&gt;</span><span
                          class="opt-html"><span class="blocksep">&lt;</span>table&gt;...&lt;/table&gt;</span></span><span
                        class="opt-html">&lt;p&gt;...&lt;/p&gt;</span></p>
                    <p>The same using multiplicated elements: (<span class="versioning">supported
                        since TBS 3.10.0</span>)</p>
                    <p><span class="opt-html">&lt;ul&gt;...&lt;/ul&gt;</span><span
                        class="blockzone"><span class="opt-html">&lt;div&gt;</span>[<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">3*div</span>+<span
                          class="opt-value">table</span>]<span class="opt-html">&lt;/div&gt;<span
                            class="blocksep">&lt;</span>div&gt;...&lt;/div&gt;<span
                            class="blocksep">&lt;</span>div&gt;...&lt;/div&gt;</span><span
                          class="opt-html"><span class="blocksep">&lt;</span>table&gt;...&lt;/table&gt;</span></span><span
                        class="opt-html">&lt;p&gt;...&lt;/p&gt;</span></p>
                  </div>
                  <p>To define the block's zone on several successive elements
                    placed before:</p>
                  <div class="decal">
                    <p>The element placed bewteen brackets means the one which
                      contains the block's definition.</p>
                    <p>Exemple #1: <span class="opt-html">...</span> <span class="blockzone"><span
                          class="opt-html">&lt;span&gt;...&lt;/span&gt;<span class="blocksep">&lt;</span>div&gt;</span>[<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">p</span>+(<span
                          class="opt-value">div)</span>]<span class="opt-html">&lt;/div&gt;</span></span>
                      <span class="opt-html">...</span></p>
                    <p>Exemple #2: <span class="opt-html">...</span><span class="blockzone"><span
                          class="opt-html">&lt;span&gt;...&lt;/span&gt; <span class="blocksep">&lt;</span>div&gt;</span>[<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">p</span>+(<span
                          class="opt-value">div)</span>+<span class="opt-value">table</span>]<span
                          class="opt-html">&lt;/div&gt; <span class="blocksep">&lt;</span>table&gt;...&lt;/table&gt;</span></span>
                      <span class="opt-html">...</span></p>
                  </div>
                  <p>To define the block's zone on a tag of the same type but
                    with a higher encapsulation level:</p>
                  <div class="decal">
                    <p><span class="opt-html">...</span> <span class="blockzone"><span
                          class="opt-html">&lt;div&gt; &lt;div&gt;</span> [<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">((div))</span>]
                        <span class="opt-html">&lt;/div&gt; &lt;/div&gt;</span></span>
                      <span class="opt-html">...</span></p>
                    <p> The number of bracket means the encapsulation level of
                      the tags. </p>
                  </div>
                  <p>To define the block's but exclusing the limits, use the
                    operator "!" on the limit elements: (<span class="versioning">supported
                      since TBS 3.10.0</span>)</p>
                  <div class="decal">
                    <p>Exemple #1:<span class="opt-html"> ...</span><span class="opt-html">&lt;div&gt;</span><span
                        class="blockzone"><span class="opt-html">...text here...</span>[<span
                          class="opt-name">b1</span>.<span class="opt-name">field1</span>;<span
                          class="opt-name">block</span>=<span class="opt-value">!div</span>]<span
                          class="opt-html">...text there...</span></span><span class="opt-html">&lt;/div&gt;</span><span
                        class="opt-html">...</span></p>
                    <p>Exemple #2: <span class="opt-html">...&lt;ul&gt;...&lt;/ul&gt;</span><span
                        class="blockzone"><span class="opt-html">&lt;div&gt;...text
                          here...</span>[<span class="opt-name">b1</span>.<span
                          class="opt-name">field1</span>;<span class="opt-name">block</span>=<span
                          class="opt-value">div+!table</span>]<span class="opt-html">...text
                          there...&lt;/div&gt;&lt;ul&gt;...&lt;/ul&gt;</span></span><span
                        class="opt-html">&lt;table&gt;&lt;/table&gt;...</span></p>
                    <p>Exemple #3: <span class="opt-html">
                        ...&lt;p&gt;&lt;/p&gt;</span><span class="blockzone"><span
                          class="opt-html">&lt;ul&gt;...&lt;/ul&gt;&lt;div&gt;...text
                          here...</span>[<span class="opt-name">b1</span>.<span
                          class="opt-name">field1</span>;<span class="opt-name">block</span>=<span
                          class="opt-value">!p+(.)+!table</span>]<span class="opt-html">...text
                          there...&lt;/div&gt;&lt;ul&gt;...&lt;/ul&gt;</span></span><span
                        class="opt-html">&lt;table&gt;&lt;/table&gt;...</span></p>
                    <p> Note that the operator "!" can be used only on the first
                      and the last element of the block definition.</p>
                  </div>
                  <p class="versioning">Versioning : The Extended Blocks feature
                    is supported since TBS version 3.0. Before that, you had to
                    use parameters 'extend' and 'encaps' which are not supported
                    anymore. </p>
                </td>
              </tr>
            </tbody>
          </table>
          <a id="html_block_prm"></a>
          <h4>Block's parameters:</h4>
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th>Parameter</th>
                <th>Description</th>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_block_prm_nodata"></a><span
                    class="opt-name">nodata</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  section that is displayed only if there is no data to merge.<br>
                  <br>
                  Example:<br>
                  <div class="decal">
                    <table class="border-1" width="349" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="178">[b1.field1;<span class="opt-name">block</span>=<span
                              class="opt-value">tr</span>]</td>
                          <td class="border-1" width="157">[b1.field2]</td>
                        </tr>
                        <tr>
                          <td colspan="2" class="border-1">[b1;<span class="opt-name">block</span>=<span
                              class="opt-value">tr</span>;<span class="opt-name">nodata</span>]<span
                              style="color:#FF3300">There is no data.</span></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <br>
                  For more information about sections, see the chapter '<a href="#html_block_section">Sections
                    of blocks</a>'.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_block_prm_bmagnet"></a><br>
                  <span class="opt-name">bmagnet</span>=<span class="opt-value">tag</span><br>
                  <span class="txt-small">or</span><br>
                  <span class="opt-name">bmagnet</span>=<span class="opt-value">expr</span></td>
                <td class="border-sep" align="left" valign="top">Indicates an
                  XML/HTML zone which must be deleted if the block is merged
                  with no record (an emprt query, for example, or a PHP Array
                  with no items). Parameter <span class="opt-name">bmagnet</span>
                  supports the same syntax as parameter <a href="#html_block_prm_block"
                    class="opt-name">block</a>, i.e. that <span class="opt-value">expr</span>
                  must be an XML/HTML tag or a TBS <a href="#html_block_prm_extblk">extended
                    block</a> expression.<br>
                  Example:
                  <div class="decal">
                    <table class="border-1" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1">[b1.field1;<span class="opt-name">block</span>=<span
                              class="opt-value">tr</span>;<span class="opt-name">bmagnet</span>=<span
                              class="opt-value">table</span>]</td>
                          <td class="border-1">[b1.field2]</td>
                        </tr>
                      </tbody>
                    </table>
                    <span class="txt-small">In this example, the table will be
                      deleted if there is no record to merge.</span> </div>
                  <br>
                  <em>Remark:</em> <br>
                  Value <span class="opt-value">null</span> is not accepted by
                  MergeBlock() method as a data source, and it makes a TBS error
                  instead of deleting the <span class="opt-name">bmagnet</span>
                  zone. If you data source may be null, then you should make a
                  check previously. <br>
                  Example:
                  <div class="decal"><span class="txt-code">if (is_null(<span class="opt-name">$data</span>))
                      <span class="opt-name">$data</span> = array();<br>
                      <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'b1'</span>,<span
                        class="opt-name">$data</span>);</span></div>
                  <p class="versioning">Versioning: parameter bmagnet is
                    supported since TBS version 3.0.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_parallel"></a>parallel</span>=<span class="opt-value">configuration_id</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Merge a block with a parallel process for sub-blocks. This
                    can typically merges a table block in columns.<br>
                    By default, TinyButStrong supports the configuration id
                    named "<span class="opt-value">tbs:table</span>" for merging
                    HTML tables. But you can define your own configuration.<br>
                    See <a href="#html_block_parallel">Parallel merge</a> for
                    examples and how to add a custom configuration.</p>
                  <p class="versioning">Versioning: parameter parallel is
                    supported since TBS version 3.9.0.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_headergrp"></a>headergrp</span>=<span class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  header section that is displayed each time the value of column
                  <span class="opt-value">colname</span> changes.<span class="opt-value"><br>
                    colname</span> must be a valid column name returned by the
                  data source.<br>
                  <span class="versioning">Since TBS version 3.3.0</span>, <span
                    class="opt-value">colname</span> can also be a virtual
                  column <a href="#php_mergeblock_counting"># or $</a>, and it
                  also support the subitems syntaxe of TBS fields.<br>
                  You can define several <span class="opt-name">headergrp</span>
                  sections with different columns. Placement's order of <span class="opt-name">headergrp</span>
                  sections in the block can modify the result. <br>
                  For more information about sections, see the chapter '<a href="#html_block_section">Sections
                    of blocks</a>'.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_footergrp"></a>footergrp</span>=<span class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  footer section that is displayed each time the value of column
                  <span class="opt-value">colname</span> changes. The syntax is
                  the same as <a href="#html_block_prm_headergrp" class="opt-name">headergrp</a>.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_splittergrp"></a>splittergrp</span>=<span
                    class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  splitter section that is displayed each time the value of
                  column <span class="opt-value">colname</span> changes. The
                  syntax is the same as <a href="#html_block_prm_headergrp" class="opt-name">headergrp</a>.</td>
              </tr>
              <tr id="v202_parentgrp">
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_parentgrp"></a>parentgrp</span>=<span class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  parent section that is displayed each time the value of column
                  <span class="opt-value">colname</span> changes. Unlike other
                  sections, a <span class="opt-name">parentgrp</span> section
                  allows normal sections inside itself. It's a way to define
                  both a header and a footer in one section. </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_block_prm_firstingrp"></a>firstingrp</span>=<span
                    class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  section which replaces the normal section each time the value
                  of column <span class="opt-value">colname</span> is the first
                  in its group. That is when the value is different from the
                  previous one.<br>
                  You can define several<a href="#html_block_prm_firstingrp" class="opt-name">
                    firstingrp</a>, <a href="#html_block_prm_lastingrp" class="opt-name">lastingrp</a>,
                  <a href="#html_block_prm_singleingrp" class="opt-name">singleingrp</a>
                  sections but only the first relevant one will be displayed for
                  the same record if they are several relevant.<br>
                  The syntax is the same as <a href="#html_block_prm_headergrp"
                    class="opt-name">headergrp</a>.<br>
                  <span class="versioning">Parameter <span class="opt-name">firstingrp</span>
                    is supported since TBS 3.12.</span></td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_block_prm_lastingrp"></a>lastingrp</span>=<span
                    class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  section which replaces the normal section each time the value
                  of column <span class="opt-value">colname</span> is the last
                  in its group. That is when the value is different from the
                  next one.<br>
                  The syntax is the same as <a href="#html_block_prm_headergrp"
                    class="opt-name">headergrp</a>.<br>
                  <span class="versioning">Parameter <span class="opt-name">lastingrp</span>
                    is supported since TBS 3.12.</span></td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      name="html_block_prm_singleingrp"></a>singleingrp</span>=<span
                    class="opt-value">colname</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  section which replaces the normal section each time the value
                  of column <span class="opt-value">colname</span> single in
                  its group. That is when the value is different from the
                  previous and the next one. This parameter is useful when you
                  use both <span class="opt-name">firstingrp</span> and <span
                    class="opt-name">lastingrp</span> and you also need to
                  specify when happen when both cases are met.<br>
                  The syntax is the same as <a href="#html_block_prm_headergrp"
                    class="opt-name">headergrp</a>.<br>
                  <span class="versioning">Parameter <span class="opt-name">singleingrp</span>
                    is supported since TBS 3.12.</span></td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_block_prm_serial"></a><span
                    class="opt-name">serial</span></td>
                <td class="border-sep" align="left" valign="top">Indicates that
                  the block is a main block which contains serial secondary
                  blocks.<br>
                  For more information, see the chapter '<a href="#html_block_serial">serial
                    display (in columns)</a>'.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_p1"></a>p1</span>=<span class="opt-value">val1</span></td>
                <td class="border-sep" align="left" valign="top">Indicates the
                  use of a dynamic query. All the occurrences of the string '<span
                    class="opt-value">%p1%</span>' found in the query given to
                  the MergeBlock() method are replaced by the value <span class="opt-value">val1</span>.
                  For more information, see the chapter <a href="#html_block_dynsb">Subblocks
                    with dynamic queries</a>.<br>
                  If it used without any value, that enables you to merge
                  several blocks of the same name. See <a href="#php_mergeblock_mergeseveral">"Merging
                    several blocks with the same data"</a> for more details.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_sub1"></a>sub1</span>=<span class="opt-value">column1</span></td>
                <td class="border-sep" align="left" valign="top">Define the
                  column containing the data for an automatic subblock.<br>
                  For more information, see the chapter <a href="#html_block_subauto">Automatic
                    subblocks</a>.</td>
              </tr>
              <tr id="v205_ondata">
                <td class="border-sep" align="left" valign="top"><span class="opt-value"><a
                      id="html_block_prm_ondata"></a></span><span class="opt-name">ondata</span>=<span
                    class="opt-value">fct_name</span></td>
                <td class="border-sep" align="left" valign="top"> Indicates the
                  name of a user Php function that will be executed during the
                  block merging.<br>
                  Since TBS version 3.0, it's also possible to indicate a method
                  of a class. See <a href="#php_oop">OOP</a>.<br>
                  The function is called each time a record is taken from the
                  data source. You can use the arguments of such a Php function
                  to edit records before they are merged. The function must have
                  the following syntax:<br>
                  <span class="txt-code">&nbsp;&nbsp;function <span class="opt-value">fct_name</span>(<span
                      class="opt-name">$BlockName</span>,&amp;<span class="opt-name">$CurrRec</span>,<span
                      class="opt-name">$RecNum</span>) { ... }<br>
                  </span> <span class="opt-name"> </span>
                  <table cellspacing="0" cellpadding="2" border="0">
                    <tbody>
                      <tr>
                        <th>Argument</th>
                        <th>Description</th>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-name">$BlockName</span></td>
                        <td>Returns the name of the block calling the function
                          (read only).</td>
                      </tr>
                      <tr>
                        <td class="opt-name" valign="top">$CurrRec</td>
                        <td>Returns an associative PHP array containing the
                          current record (read/write<span class="txt-small"> <em>;
                              don't forget the &amp; in the function header</em></span>).<br>
                          If you set this variable to <span class="opt-value">false</span>,
                          it ends the merging like it was the end of the record
                          set.</td>
                      </tr>
                      <tr>
                        <td valign="top"><span class="opt-name">$RecNum</span></td>
                        <td>Returns the number of the current record (read only,
                          first record is number 1).</td>
                      </tr>
                    </tbody>
                  </table>
                  Examples:
                  <div class="decal txt-code"> function f_add_column(<span class="opt-name">$BlockName</span>,<span
                      class="opt-name">&amp;$CurrRec</span>,<span class="opt-name">$RecNum</span>)
                    {<br>
                    &nbsp;&nbsp;<span class="opt-name">$CurrRec</span>[<span class="opt-value">'len'</span>]
                    = strlen(<span class="opt-name">$CurrRec</span>[<span class="opt-value">'text'</span>]);
                    <br> } </div>
                  <br>
                  Since TBS version 3.6.0, it's possible to limit the allowed
                  PHP functions for parameter <span class="opt-name">ondata</span>.
                  See <a href="#php_instanciate">create a new TBS object</a>.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><span class="opt-name"><a
                      id="html_block_prm_when"></a>when</span> <span class="opt-value">expr1</span><span
                    class="opt-name">=</span><span class="opt-value">expr2</span></td>
                <td class="border-sep" align="left" valign="top">
                  <p>Make the section conditional and define its condition. A
                    conditional section is displayed only if its condition is
                    verified.</p>
                  <p> Supported operators are: (same as parameter <a href="#html_field_prm_if"><span
                        class="opt-name">if/then/else</span></a> for fieds) </p>
                  <div class="decal">
                    <table cellspacing="2" cellpadding="0" border="0">
                      <tbody>
                        <tr>
                          <td width="60"><span class="opt-name">=</span> or <span
                              class="opt-name">==</span></td>
                          <td>equal</td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">!=</td>
                          <td>not equal </td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">+-</td>
                          <td>greater than </td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">+=-</td>
                          <td>greater than or equal to </td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">-+</td>
                          <td>less than </td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">-=+</td>
                          <td>less than or equal to </td>
                          <td>&nbsp;</td>
                        </tr>
                        <tr>
                          <td class="opt-name">~=</td>
                          <td><span class="opt-value">expr1</span> match the
                            regular expression <span class="opt-value">expr2</span>
                            <br>
                            <span class="txt-small">(for experimented users)</span></td>
                          <td>
                            <div class="versioning">Versioning: added in TBS 3.0
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <p>Both <span class="opt-value">expr1</span> and <span class="opt-value">expr2</span>
                    must be string or numerical expressions.<br>
                    <em>Equal</em> and <em>not equal</em> operators are always
                    string <span lang="en"><span title="">comparison</span></span>s
                    and are <strong>case insensitive</strong>.<br>
                    As with other parameters, string expressions can be
                    delimited with single quotes ('), and literal single quotes
                    in the string must be escaped using two adjacent single
                    quotes ('').</p>
                  <p>Parameter <span class="opt-name">if</span> supports <a href="#html_field_auto_embedded">automatic
                      embded fields</a> <span class="opt-name">[var]</span>.</p>
                  <p>Example: </p>
                  <div class="decal"><span class="opt-html">&lt;div&gt; ... </span>[<span
                      class="opt-name">onload</span>;<span class="opt-name">block</span>=<span
                      class="opt-value">div</span>;<span class="opt-name">when</span>
                    [<span class="opt-name">var</span>.<span class="opt-name">x</span>]+-<span
                      class="opt-value">0</span>] ... <span class="opt-html">&lt;/div&gt;</span><br>
                    <span class="txt-small">The &lt;div&gt; block will be
                      displayed only if « $x &gt; 0 ». </span></div>
                  <p>If the emmebed fields may contains single quotes, you need
                    to use delimitor and to escape strings in both expressions:
                  </p>
                  <div class="decal"><span class="opt-html">&lt;div&gt; ... </span>[<span
                      class="opt-name">onload</span>;<span class="opt-name">block</span>=<span
                      class="opt-value">div</span>;<span class="opt-name">when</span>
                    '[<span class="opt-name">var</span>.<span class="opt-name">x</span>;<span
                      class="opt-name">strconv</span>=<span class="opt-value">esc</span>]'=<span
                      class="opt-value">'abc'</span>] ... <span class="opt-html">&lt;/div&gt;</span><br>
                    <span class="txt-small">The &lt;div&gt; block will be
                      displayed only if « $x == 'abc' ». </span> </div>
                  <p><em>Note:</em> do not confuse parameter <span class="opt-name">when</span>
                    (which works only for TBS blocs or sections) and parameter <span
                      class="opt-name">if</span> (which works only for TBS
                    fields). Thus, parameter <span class="opt-name">when</span>
                    is taken into account only if parameter <span class="opt-name">block</span>
                    exists in the same TBS tag.<br>
                    See <a href="#html_conditional">conditional blocks</a> for
                    more details.</p>
                </td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_block_prm_default"></a><span
                    class="opt-name">default</span></td>
                <td class="border-sep" align="left" valign="top">Indicates a
                  section of block that must be displayed only if no conditional
                  section of the same block has been displayed.</td>
              </tr>
              <tr>
                <td class="border-sep" align="left" valign="top"><a id="html_block_prm_several"></a><span
                    class="opt-name">several</span></td>
                <td class="border-sep" align="left" valign="top">Indicates that
                  several conditional sections of the block can be displayed if
                  several conditions are true. By default, conditional sections
                  are exclusive.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3> <a id="html_block_section"></a>Sections of block:</h3>
        <div class="norm">
          <p>Different blocks having the same name will be regarded as sections
            of the same block.</p>
          <p> Sections can be used to:</p>
          <ul>
            <li> alternate the display (normal sections),</li>
            <li> display something if there is no data (NoData section),</li>
            <li> display a header each time the value of a column changes
              (grouping sections). </li>
          </ul>
          <h4>Normal sections:</h4>
          <p> When you define several normal sections, they will be used
            alternatively for each record. </p>
          <div class="decal">
            <p>Example:</p>
            <table class="border-1" width="200" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1" bgcolor="#F0FCFF">[<span class="opt-name">b1</span>.caption;<span
                      class="opt-name">block</span>=tr]</td>
                </tr>
                <tr>
                  <td class="border-1" bgcolor="#D2FFE9">[<span class="opt-name">b1</span>.caption;<span
                      class="opt-name">block</span>=tr]</td>
                </tr>
              </tbody>
            </table>
            <p class="txt-small">In this example, the block named 'b1' contains
              two normal sections. Records will be displayed alternatively with
              a green background and with a blue background.</p>
          </div>
          <h4>NoData section:</h4>
          <p> The NoData section is a section displayed only if the data source
            has no records. There can be only one NoData section in a block. The
            NoData section is defined by adding the parameter <span class="opt-name">nodata</span>.
          </p>
          <p>Example:</p>
          <table class="decal border-1" width="250" cellspacing="0" cellpadding="2">
            <tbody>
              <tr>
                <td class="border-1">[<span class="opt-name">b1</span>.caption;<span
                    class="opt-name">block</span>=tr]</td>
              </tr>
              <tr>
                <td class="border-1" bgcolor="#FFCCCC"><span class="opt-html">There
                    is nothing. </span>[<span class="opt-name">b1</span>;<span
                    class="opt-name">block</span>=tr;<span class="opt-name">nodata</span>]</td>
              </tr>
            </tbody>
          </table>
          <h4>Grouping sections:</h4>
          <p> Grouping sections are displayed every time a column's value in the
            record-set changes. You can define header, footer, splitter or
            parent sections using parameters <span class="opt-name">headergrp</span>,
            <span class="opt-name">footergrp</span>, <span class="opt-name">splittergrp</span>,
            and <span class="opt-name">parentgrp</span>. See <a href="#html_block_prm_headergrp">block's
              parameters</a> for more details. </p>
          <p>Example:</p>
          <table class="decal border-1" width="300" cellspacing="0" cellpadding="2">
            <tbody>
              <tr>
                <td colspan="2" class="border-1">Year: [<span class="opt-name">b1</span>.year;<span
                    class="opt-name">block</span>=tr;<span class="opt-name">headergrp</span>=year]
                  </td> </tr>
              <tr>
                <td class="border-1">[<span class="opt-name">b1</span>.caption;block=tr]</td>
                <td class="border-1">[<span class="opt-name">b1</span>.amount]</td>
              </tr>
            </tbody>
          </table>
          <h4>Conditional sections:</h4>
          <p> Conditional sections are displayed only if their condition is
            verified. The condition for display is defined using parameter <a href="#html_block_prm_when"
              class="opt-name">when</a>. As soon as a section has this
            parameter, it becomes conditional. See <a href="#html_conditional">Conditional
              display</a> for more details. </p>
          <p>Example:</p>
          <table class="decal border-1" width="300" cellspacing="0" cellpadding="2">
            <tbody>
              <tr>
                <td class="border-1">[<span class="opt-name">b1</span>.name;<span
                    class="opt-name">block</span>=tr]</td>
              </tr>
              <tr>
                <td class="border-1" bgcolor="#DDDDDD">[<span class="opt-name">b1</span>.address;<span
                    class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                  [<span class="opt-name">b1</span>.add_ok]==1]</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3><a id="html_block_parallel"></a>Parallel merge (dynamic columns):</h3>
        <div class="norm">
          <p class="versioning">The parallel merge is supported since TBS
            version 3.9.0.</p>
          <p>The parameter <span class="opt-name"><a href="#html_block_prm_parallel">parallel</a></span>
            enables you to merge a block with a parallel process for sub-blocks.
            This can typically merges a table block in columns.</p>
          <h4>How does it works ?</h4>
          <p>First of all you have to define a block over one or several closed
            cells in the same row of a table. It can be at any row of the table,
            it makes no difference. Then add parameter "<span class="opt-name">parallel</span>=<span
              class="opt-value">tbs:table</span>" to this block. Then TBS will
            merge the cells as expected for this row, but also for all the same
            columns of other rows in the table. The configuration "<span class="opt-name">parallel</span>=<span
              class="opt-value">tbs:table</span>" tells TBS how is structured
            the <span class="opt-html">&lt;table&gt;</span> element in HTML,
            and then it can found other cells of the same columns. TBS can even
            process spanned cells if it is consistent with the asked merge.</p>
          <p>By default, TinyButStrong supports the configuration named "<span class="opt-value">tbs:table</span>"
            for merging HTML tables. But you can define your own configurations.</p>
          <div class="decal">
            <h4>Example:</h4>
            <p>Template:</p>
            <table class="border-1 decal" cellspacing="0" cellpadding="3">
              <tbody>
                <tr>
                  <td class="border-1" bgcolor="#DDDDDD">Category</td>
                  <td class="border-1" bgcolor="#DDDDDD">[b.date]</td>
                </tr>
                <tr>
                  <td class="border-1">Thin</td>
                  <td class="border-1" align="right">[b.thin;block=td;parallel=tbs:table]</td>
                </tr>
                <tr>
                  <td class="border-1">Heavy</td>
                  <td class="border-1" align="right">[b.heavy]</td>
                </tr>
                <tr>
                  <td class="border-1"><strong>Total</strong></td>
                  <td class="border-1" align="right"><strong>[b.total]</strong></td>
                </tr>
              </tbody>
            </table>
            <p>PHP:</p>
            <pre class="txt-code decal"><span class="opt-name">$data</span> = array(
 array('<span class="opt-value">date</span>' =&gt; '2013-10-13', '<span class="opt-value">thin</span>' =&gt; 156, '<span
class="opt-value">heavy</span>' =&gt; 128, '<span class="opt-value">total</span>' =&gt; 284),
 array('<span class="opt-value">date</span>' =&gt; '2013-10-14', '<span class="opt-value">thin</span>' =&gt; 233, '<span
class="opt-value">heavy</span>' =&gt;  25, '<span class="opt-value">total</span>' =&gt; 284),
 array('<span class="opt-value">date</span>' =&gt; '2013-10-15', '<span class="opt-value">thin</span>' =&gt; 110, '<span
class="opt-value">heavy</span>' =&gt; 412, '<span class="opt-value">total</span>' =&gt; 130),
 array('<span class="opt-value">date</span>' =&gt; '2013-10-16', '<span class="opt-value">thin</span>' =&gt; 258, '<span
class="opt-value">heavy</span>' =&gt; 522, '<span class="opt-value">total</span>' =&gt; 258),
);
<span class="opt-name">$TBS</span>-&gt;MergeBlock('<span class="opt-value">b</span>', <span
class="opt-name">$data</span>);
</pre>
            <p>Result:</p>
            <table class="border-1 decal" cellspacing="0" cellpadding="3">
              <tbody>
                <tr>
                  <td class="border-1" bgcolor="#DDDDDD">Category</td>
                  <td class="border-1" bgcolor="#DDDDDD">2013-10-13</td>
                  <td class="border-1" bgcolor="#DDDDDD">2013-10-14</td>
                  <td class="border-1" bgcolor="#DDDDDD">2013-10-15</td>
                  <td class="border-1" bgcolor="#DDDDDD">2013-10-16</td>
                </tr>
                <tr>
                  <td class="border-1">Thin</td>
                  <td class="border-1" align="right">156</td>
                  <td class="border-1" align="right">233</td>
                  <td class="border-1" align="right">110</td>
                  <td class="border-1" align="right">128</td>
                </tr>
                <tr>
                  <td class="border-1">Heavy</td>
                  <td class="border-1" align="right">128</td>
                  <td class="border-1" align="right">25</td>
                  <td class="border-1" align="right">412</td>
                  <td class="border-1" align="right">130</td>
                </tr>
                <tr>
                  <td class="border-1"><strong>Total</strong></td>
                  <td class="border-1" align="right"><strong>284</strong></td>
                  <td class="border-1" align="right"><strong>258</strong></td>
                  <td class="border-1" align="right"><strong>522</strong></td>
                  <td class="border-1" align="right"><strong>258</strong></td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>Remark: The parallel merge doesn't work with <a href="#html_block_section">headergrp
              and serial mode</a><a href="#html_block_subblock"></a>.</p>
          <h4>Define a new configuration: </h4>
          <pre class="txt-code"><span class="opt-name">$configuration</span> = array(
 <span class="opt-html">// Name of the parent entity. The process will be limited to this element and its childs.</span>
 '<span class="opt-value">parent</span>' =&gt; '<span class="opt-value">table</span>',
 <span class="opt-html">// Names of tags that must be simply ignored. Such start and ending tags are ignored but childs are not ignored.
 // For elements that must be completely ignored including childs, you just have to not mentioned it in the configuration.</span>
 '<span class="opt-value">ignore</span>' =&gt; array('<span class="opt-value">!--</span>', '<span
class="opt-value">caption</span>', '<span class="opt-value">thead</span>', '<span
class="opt-value">thbody</span>', '<span class="opt-value">thfoot</span>'),
 <span class="opt-html">// Names of entities recognized as column's definitions, and their span attributes</span><span
class="opt-html"> ('' for no span attribute)</span>.
 <span class="opt-html">// Such entities must always be placed before the row entities.</span>
 '<span class="opt-value">cols</span>'   =&gt; array(),
 <span class="opt-html">// Names of entities recognized as rows.</span>
 '<span class="opt-value">rows</span>'   =&gt; array('<span class="opt-value">tr</span>'),
 <span class="opt-html">// Names of entities recognized as cells, and their span attibute ('' for no span attribute).</span>
 '<span class="opt-value">cells</span>'  =&gt; array(
   '<span class="opt-value">td</span>' =&gt; '<span class="opt-value">colspan</span>',
   '<span class="opt-value">th</span>' =&gt; '<span class="opt-value">colspan</span>',
  ),
);
<span class="opt-html">// Save the new configuratin with its ID.</span>
<span class="opt-name">$TBS</span>-&gt;SetOption('<span class="opt-value">parallel_conf</span>', '<span
class="opt-value">tbs:table</span>',  <span class="opt-name">$configuration</span>);
    </pre>
        </div>
        <h3><a id="html_block_serial"></a>Serial display (in columns):</h3>
        <div class="norm">
          <p>The serial display enables you to display several records inside a
            block. For this, you have to use a main block and secondary blocks.
          </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-2" width="200" cellspacing="0" cellpadding="4">
              <tbody>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="0">
                      <tbody>
                        <tr>
                          <td class="border-1" height="14" width="25%">
                            <div align="center">Rec 1</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 2</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 3</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 4</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 5</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 6</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 7</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 8</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="25%">
                            <div align="center">Rec 9</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">...</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">...</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">...</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="txt-small">In this example, main blocks are the blue lines
              of the table, the secondary blocks are the pink cells.</p>
          </div>
          <h4>Syntax:</h4>
          <p>The main block and its secondary blocks are merged using only one
            call to the MergeBock() method. The main block must be defined using
            the parameter <span class="opt-name">serial</span>. The secondary
            blocks must be nested into the main block. The secondary block's
            names must be the name of the main block followed by "_" and a
            number indicating display order. </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-2" width="200" cellspacing="0" cellpadding="4">
              <tbody>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="25%">
                            <div align="center">[bx;block=tr;serial][bx_1.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_2.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_3.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_4.txt;block=td]</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <h4>Empty secondary block: </h4>
          <p>You can specify a special secondary block that will be used to
            replace unused secondary blocks (without records). This "Empty"
            secondary block must have the index 0. It can either be placed
            inside the main block with the normal secondary block, or alone
            inside another <span class="opt-name">serial</span> block. The
            "empty" secondary block is optional. </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-2" width="200" cellspacing="0" cellpadding="4">
              <tbody>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="25%">
                            <div align="center">[bx;block=tr;serial][bx_1.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_2.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_3.txt;block=td]</div>
                          </td>
                          <td class="border-1" width="25%">
                            <div align="center">[bx_4.txt;block=td]</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="border-2">
                    <table class="border-1" width="100%" cellspacing="0" cellpadding="2">
                      <tbody>
                        <tr>
                          <td class="border-1" width="25%">
                            <div align="center">[bx;block=tr;serial][bx_0;block=td]
                              <strong>No records found. </strong></div>
                          </td>
                          <td class="border-1" width="25%">&nbsp;</td>
                          <td class="border-1" width="25%">&nbsp;</td>
                          <td class="border-1" width="25%">&nbsp;</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <h4>Remarks:</h4>
          <ul>
            <li>The serial display also works with <a href="#html_block_section">sections
                of block</a>, <a href="#html_block_subauto">automatic subblocks</a>
              and <a href="#html_block_dynsb">subblocks with dynamic queries</a>.</li>
            <li>For any usage, it must be considered that the main block (named
              bx in the example above) cannot merge data directly and is used
              only to defined the scope of secondary blocks. And in an other
              hand, each secondary block (named bx_1, bx_2, ... in the example)
              behaves like a normal block relatively to the data. Thus, as an
              example, in order to use serial display combined with automatic
              subblock, parameter sub1 must be define on each secondary blocks,
              and has no effects if defined on the main block.</li>
          </ul>
        </div>
        <h3><a id="html_block_subblock"></a>Subblocks:</h3>
        <div class="norm">
          <p>A subblock is a TBS block nested into another TBS block and that
            should be displayed as a separated block for each record of its
            parent block. </p>
          <div class="decal">
            <p>Example:</p>
            <table class="border-2" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-2">Parent block record #1
                    <div class="decal">
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Subblock record #1.1</td>
                          </tr>
                          <tr>
                            <td class="border-1">Subblock record #1.2</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="border-2">Parent block record #2
                    <div class="decal">
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Subblock record #2.1</td>
                          </tr>
                          <tr>
                            <td class="border-1">Subblock record #2.2</td>
                          </tr>
                          <tr>
                            <td class="border-1">Subblock record #2.3</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="border-2">Parent block record #3
                    <div class="decal">
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Subblock record #3.1</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>They are two different ways to perform subblocks with TBS:</p>
          <ul>
            <li> Automatic subblock: (<span class="versioning">since TBS 3.5.0</span>)
              it is when the data of the parent block has a column which
              contains the ready-to-merge data for the subblock. Automatic
              subblocks are activated using parameter <span class="opt-name">sub1</span>
              in the parent block, and they are merged automatically during the
              merge of the parent block. No extra MergeBlock() are needed. See <a
                href="#html_block_subauto">Automatic subblocks</a> for more
              details.</li>
            <li> Subblock with dynamic query: it is when the data of the
              subblocks are retrieved using a query which can change for each
              record of the parent block. Subblocks with dynamic queries need an
              extra MergeBlock() to perform the merging with their dynamic
              query. Parameter <span class="opt-name">p1</span> is also needed
              in the subblock definition in order to set the values to inject in
              the dynamic query. See <a href="#html_block_dynsb">Subblocks with
                dynamic queries</a> for more details. </li>
          </ul>
        </div>
        <h3><a id="html_block_subauto"></a>Automatic subblocks:</h3>
        <div class="norm">
          <p class="versioning">Automatic subblock are supported since TBS
            version 3.5.0.</p>
          <p> You can use automatic subblocks when the data of the parent block
            has a column which contains the ready-to-merge subdata for the
            subblock. Set parameter <span class="opt-name">sub1</span>=<span class="opt-value">column</span>
            in the parent block to define the column which contain the data for
            the subblock. If you have several subblocks to merge in the same
            parent block then use parameters <span class="opt-name">sub2</span>,
            <span class="opt-name">sub3</span>, ... The name of the subblock
            must be the same as the parent block followed by the suffix <span class="opt-name">_sub1</span>,
            (or <span class="opt-name">_sub2</span>, <span class="opt-name">_sub3</span>,
            ...). </p>
          <p> The data of the parent block must have a column which contains the
            data of the subblock. Supported data types are:</p>
          <ul>
            <li> a PHP array</li>
            <li> an object supported by TBS (natively or with a plug-in) </li>
            <li> a text string of values separated by comas (,). </li>
          </ul>
          <div class="decal">
            <p>Example: </p>
            <table class="border-2" width="400" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-2"><span style="color:#336699">Name:</span>
                    [body.name;block=tr;sub1=spokenlg]
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1" width="200">[body_sub1.val;block=tr]</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
            <p class="txt-small">Corresponding PHP code:</p>
            <pre class="txt-code"><span class="opt-name">$data</span> = array(
  array('<span class="opt-value">name</span>'=&gt;'<span class="opt-value">Peter</span>', '<span
class="opt-value">spokenlg</span>'=&gt;array( '<span class="opt-value">US</span>', '<span
class="opt-value">FR</span>' ) ),
  array('<span class="opt-value">name</span>'=&gt;'<span class="opt-value">Paul</span>',  '<span
class="opt-value">spokenlg</span>'=&gt;array( '<span class="opt-value">US</span>' ) ),
  array('<span class="opt-value">name</span>'=&gt;'<span class="opt-value">Jack</span>',  '<span
class="opt-value">spokenlg</span>'=&gt;array( '<span class="opt-value">FR</span>', '<span
class="opt-value">ES</span>', '<span class="opt-value">IT</span>') ),
);
<span class="opt-name">$TBS</span>-&gt;MergeBlock('<span class="opt-value">body</span>', <span
class="opt-name">$data</span>);
</pre>
            <p><span class="txt-small">Result of the merge:</span> </p>
            <table class="border-2" width="400" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-2"><span style="color:#336699">Name:</span>
                    Peter
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1">US</td>
                        </tr>
                        <tr>
                          <td class="border-1" width="190">FR</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="border-2"><span style="color:#336699">Name:</span>
                    Paul
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1" width="190">US</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
                <tr>
                  <td class="border-2"><span style="color:#336699">Name: </span>Jack
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1">FR</td>
                        </tr>
                        <tr>
                          <td class="border-1">ES</td>
                        </tr>
                        <tr>
                          <td class="border-1" width="190">IT</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <h4>Have the column optional:</h4>
          <p> If you want no error message when the column is omitted in the
            parent data, then you can set it optional by using parenthesis. This
            is working only if the parent data is a PHP array. <span class="versioning">Optional
              column is supported since TBS version 3.6.0.</span> </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-2" width="400" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-2"><span style="color:#336699">Name:</span>
                    [body.name;block=tr;sub1=(spokenlg)]
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1" width="200">[body_sub1.val;block=tr]</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <h4> Direct subblocks (which are not saved under a column):</h4>
          <p>If you use parameter <span class="opt-name">sub1</span> by
            omitting the column name, then TBS will assume that the data for the
            subblock are available directly on the current record instead of
            under a column of this record. <span class="versioning">Direct
              subblocks are supported since TBS version 3.6.1.</span></p>
          <p>Example of data that can be merged with a direct subblock: </p>
          <pre class="decal">$data = array();
$data['group1'] = array();
$data['group1'][] = array('id'=&gt;1, 'name'=&gt;'peter');
$data['group1'][] = array('id'=&gt;2, 'name'=&gt;'paul');
$data['group2'] = array();
$data['group2'][] = array('id'=&gt;3, 'name'=&gt;'jules');
$data['group2'][] = array('id'=&gt;4, 'name'=&gt;'jim');</pre>
          <p> Example of direct subblock that can be merged with those data: </p>
          <div class="decal">
            <table class="border-2" width="400" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-2"><span style="color:#336699">Group :</span>
                    [body.$;block=tr;sub1]
                    <table class="border-1" cellspacing="0" cellpadding="1">
                      <tbody>
                        <tr>
                          <td class="border-1" width="200">[body_sub1.name;block=tr]</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <h4>Several levels of automatic subblocks:</h4>
          TBS supports several levels of automatic subblock. For example you can
          have blocks "<span class="opt-name">b</span>", '<span class="opt-name">b_sub1</span>",
          '<span class="opt-name">b_sub1_sub1</span>", '<span class="opt-name">b_sub1_sub1_sub1</span>"
          and so on.</div>
        <h3><a id="html_block_dynsb"></a>Subblocks with dynamic queries:</h3>
        <div class="norm">
          <h4>Principles of the dynamic queries:</h4>
          <p>It is possible to use the MergeBlock() method with a dynamic query.
            In your template, you have to define a block by adding the
            parameters <span class="opt-name">p1</span>, <span class="opt-name">p2</span>,
            <span class="opt-name">p3</span>,... with their values. The
            parameter $query given to the <a href="#php_mergeblock" class="opt-name">MergeBlock()</a>
            method must be a string and has to contain marks such as <span class="opt-value">%p1%</span>,
            <span class="opt-value">%p2%</span>, <span class="opt-value">%p3%</span>,
            ... in order to welcome the values of the parameters <span class="opt-name">p1</span>,
            <span class="opt-name">p2</span>, <span class="opt-name">p3</span>,...
            </p>
          <p>Note that you can also use a dynamic query with a PHP Array using a
            string that refers to a PHP Array stored in a global variable. See<a
              href="#php_mergeblock_array" class="opt-name"> Php data sources</a>.</p>
          <p> Each section of the block to be merged that contains a parameter <span
              class="opt-name">p1</span> will be computed as a separate block
            for which the dynamic query is re-executed. The sections of the
            block that have no parameter <span class="opt-name">p1</span> are
            combined with the previous section with a parameter <span class="opt-name">p1</span>.
          </p>
          <div class="decal">
            <p>Example: </p>
            <div class="decal">
              <p> Country: France</p>
              <table class="border-1" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-1" width="200">[blk.town;block=tr;p1='france']</td>
                    <td class="border-1" width="100">[blk.country]</td>
                  </tr>
                </tbody>
              </table>
              <p>Country: USA</p>
              <table class="border-1" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-1" width="200">[blk.town;block=tr;p1='us']</td>
                    <td class="border-1" width="100">[blk.country]</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Corresponding PHP code:</p>
            <pre class="decal">$TBS-&gt;MergeBlock('<span class="opt-value">blk</span>', $cnx_id, "<span
class="opt-value">SELECT town,country FROM t_geo WHERE (country='%p1%')</span>");</pre>
            <p>Or using an Array:</p>
            <pre class="decal">global $data_town; <span class="opt-html">// the coutry code is the main key of the array</span>
$TBS-&gt;MergeBlock('<span class="opt-value">blk</span>', '<span class="opt-value">array</span>', '<span
class="opt-value">data_town[%p1%]</span>');</pre>
            <p>Result of the merge:</p>
            <p></p>
            <div class="decal">
              <p> Country: France </p>
              <table class="border-1" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-1" width="200">Paris</td>
                    <td class="border-1" width="100">france</td>
                  </tr>
                  <tr>
                    <td class="border-1">Toulouse</td>
                    <td class="border-1">france</td>
                  </tr>
                </tbody>
              </table>
              <p>Country: USA </p>
              <table class="border-1" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-1" width="200">Washington</td>
                    <td class="border-1" width="100">us</td>
                  </tr>
                  <tr>
                    <td class="border-1">Boston</td>
                    <td class="border-1">us</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <h4>Use with subblocks:</h4>
          <p>Dynamic queries enable you to easily build a system of a main-block
            with subblocks. Here is how you can do it:</p>
          <ol>
            <li> Create a main block, and then a subblock inside the main block.</li>
            <li> Link them by adding to the subblock a parameter <span class="opt-name">p1</span>
              whose value is a field from the main block.</li>
            <li> At the PHP side, merge the main block first, and then the
              subblock.</li>
          </ol>
          <div class="decal">
            <p>Example: </p>
            <div class="decal">
              <table class="border-2" width="400" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-2"><span style="color:#336699">Country:</span>
                      [main.country;block=tr]<br>
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1" width="200">[sub.town;block=tr;p1=[main.cntr_id]]</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Corresponding PHP code:</p>
            <pre class="decal">$TBS-&gt;MergeBlock('<span class="opt-value">main</span>', $cnx_id, '<span
class="opt-value">SELECT country,cntr_id FROM t_country</span>');
$TBS-&gt;MergeBlock('<span class="opt-value">sub</span>', $cnx_id, '<span class="opt-value">SELECT town FROM t_town WHERE (cntr_id=%p1%)</span>';</pre>
            <p> Or using an Array:</p>
            <pre class="decal">$TBS-&gt;MergeBlock('<span class="opt-value">main</span>', $data_county);
global $data_town; <span class="opt-html">// the coutry code is the main key of the array</span>
$TBS-&gt;MergeBlock('<span class="opt-value">blk</span>', '<span class="opt-value">array</span>', '<span
class="opt-value">data_town[%p1%]</span>');</pre>
            <p>Result of the merge: </p>
            <div class="decal">
              <table class="border-2" width="400" cellspacing="0" cellpadding="2">
                <tbody>
                  <tr>
                    <td class="border-2"><span style="color:#336699">Country:</span>
                      France<br>
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Paris</td>
                          </tr>
                          <tr>
                            <td class="border-1" width="190">Toulouse</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                  <tr>
                    <td class="border-2"><span style="color:#336699">Country:</span>
                      Germany<br>
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Berlin</td>
                          </tr>
                          <tr>
                            <td class="border-1" width="190">Munich</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                  <tr>
                    <td class="border-2"><span style="color:#336699">Country: </span>Spain<br>
                      <table class="border-1" cellspacing="0" cellpadding="1">
                        <tbody>
                          <tr>
                            <td class="border-1">Madrid</td>
                          </tr>
                          <tr>
                            <td class="border-1" width="190">Barcelona</td>
                          </tr>
                        </tbody>
                      </table>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <p>Remarks:</p>
          <ul>
            <li> The parameter <span class="opt-name">strconv</span>=<span class="opt-value">esc</span>
              enables you to pass protected string values to the query.</li>
            <li> The dynamic queries also work with <a href="#html_block_section">sections
                of block</a> and <a href="#html_block_serial">serial display</a>.</li>
          </ul>
        </div>
        <h3><a id="html_block_auto"></a>Automatic blocks:</h3>
        <div class="norm">
          <p>Automatic blocks enable you to automatically merge conditional
            blocks when some events occur. </p>
          <p> There are two types of automatic blocks:</p>
          <ul>
            <li><span class="opt-name">[onload]</span> blocks which are merged
              automatically when the <a href="#php_loadtemplate">LoadTemplate()</a>
              method is called.</li>
            <li><span class="opt-name">[onshow]</span> blocks which are merged
              automatically when the <a href="#php_show">Show()</a> method is
              called. </li>
          </ul>
          <p> Automatic blocks are not merged with data ; that's why they cannot
            have normal sections (non conditional sections) and linked fields.
            Automatic blocks can have only conditional sections. Conditions are
            evaluated only once, and they can be expressions containing [var]
            fields. </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-1" width="460" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>light]=<span class="opt-value">1</span>]<span
                      class="opt-html">Light is ON.</span></td>
                </tr>
              </tbody>
            </table>
            <br>
            <table class="border-1" width="460" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1">[<span class="opt-name">onshow</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>user]=<span class="opt-value">1</span>]<span
                      class="opt-html"> User : [onshow.username]</span></td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>If you need to have a group of exclusive sections, with or without
            a default section, you can suffix the [onload] and [onshow] bloc's
            names with "_" followed by a subname. </p>
          <div class="decal">
            <p>Example: </p>
            <table class="border-1" width="400" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_ligth</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>light]=<span class="opt-value">1</span>]<span
                      class="opt-html"> Light is ON.</span></td>
                </tr>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_ligth</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>light]=<span class="opt-value">0</span>]<span
                      class="opt-html"> Light is OFF.</span></td>
                </tr>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_ligth</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">default</span>]
                    <span class="opt-html">Light is ?</span></td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>See <a href="#html_conditional_section">Conditional sections</a>
            for more details. </p>
        </div>
        <h3><a id="html_subtemplate"></a>Subtemplates:</h3>
        <div class="norm">
          <p>There are two ways to insert subtemplates in your main template. </p>
          <h4>Primary insertion using parameter <span class="opt-name">file</span>:</h4>
          <p>This is the best way to simply insert a part contained in another
            file, like usually done for headers and footers. </p>
          <p> The value given to parameter <span class="opt-name">file</span>
            must be the name of a file existing on the server. You can use an
            expression with [var] Fields and the [val] keyword which represent
            the value of the field. If the value is an empty string, then no
            error message is displayed, it is like parameter <span class="opt-name">file</span>
            is ignored. This can be used to manage conditional insertion. </p>
          <p>Examples: </p>
          <pre class="decal">[<span class="opt-name">onload</span>;<span class="opt-name">file</span>=header.htm]
[<span class="opt-name">onload</span>;<span class="opt-name">file</span>=[<span
class="opt-name">var</span>.file_header]]
[<span class="opt-name">onload</span>.sub1;<span class="opt-name">file</span>=[<span
class="opt-name">val</span>]]
[<span class="opt-name">onload</span>;<span class="opt-name">file</span>=[<span
class="opt-name">var</span>.<span class="opt-name">insert</span>;if [<span class="opt-name">val</span>]=1;<span
class="opt-name">then</span> <span class="opt-value">'header.html'</span>;<span
class="opt-name">else</span> <span class="opt-value">''</span>]]</pre>
          <p>Contents of the file is inserted at the place of the field, without
            no <a href="#html_field_prm_htmlconv">char conversion</a> and no <a
              href="#html_field_prm_protect">TBS protection</a>.<br>
            [onload] tags contained in the file are processed at the insertion.
            [onshow] tags will be merged on the Show() method because they
            became part of the main template.</p>
          <p> The subtemplate can contain any TBS fields, including [var] fields
            and blocks to be merged. If you intend to merge data with a block
            defined into a subtemplate, then it's suggested to use parameter <span
              class="opt-name">file</span> in an [onload] field in order to
            ensure that the subtemplate is inserted before you call
            MergeBlock(). </p>
          <p> You can create a subtemplate in an independent XML/HTML/Text file,
            and ask TBS to include in the main template only the <span class="opt-html">&lt;body&gt;</span>
            part (or another part). This can be done by adding parameter <a href="#html_field_prm_getpart"
              class="opt-name">getpart</a> to parameter <span class="opt-name">file</span>
            in the TBS field of the main template. This technique enables you to
            work <span class="contextual" title="What You See Is What You Get">WYSIWYG</span>
            with your subtemplates.</p>
          <h4>Insertion driven with Php code using parameter <span class="opt-name">subtpl</span>:
          </h4>
          <p>Parameter <span class="opt-name">subtpl</span> is useful to manage
            subtemplate insertion with Php code. Parameter <span class="opt-name">subtpl</span>
            is active only when used with a parameter<span class="opt-name">
              script</span> or <span class="opt-name">onformat.</span> It turns
            the current TBS instance in Subtemplate mode during the script or
            function execution and can act on a new template without
            deteriorating the main template. </p>
          <p> In the Subtemplate mode, a reference to the TBS instance is
            provided by local variable <span class="opt-name">$this</span> or <span
              class="opt-name">$TBS</span>, whether you use parameter <span class="opt-name">script</span>
            or <span class="opt-name">onformat</span>. This variable be used
            for new submerges without deteriorating the main template. The
            Show() method won't stop any script execution during the Subtemplate
            mode like it does by default in normal mode.</p>
          <p>When the script or the function ends, the TBS instance returns in
            normal mode with the main TBS template.</p>
          <p class="versioning">Versioning: since TBS version 3.8.3, the PHP
            direct outputs (such as those done with the command echo) are no
            longer diverted from the subtemplate to the main template. </p>
          <p> Example <span class="txt-small">with parameter <span class="opt-name">script</span>:</span></p>
          <div class="decal">
            <table width="100%" cellspacing="0" cellpadding="4" border="0">
              <tbody>
                <tr>
                  <th width="120">HTML:</th>
                  <td>
                    <pre>[<span class="opt-name">onload</span>.file;<span class="opt-name">script</span>=<span
class="opt-value">specialbox.php</span>;<span class="opt-name">subtpl</span>]</pre>
                  </td>
                </tr>
                <tr>
                  <th>
                    <p>PHP script:<br>
                    </p>
                  </th>
                  <td>
                    <pre class="txt-code"><span class="opt-html">&lt;?php</span>

<span class="opt-html">// script specialbox.php</span>

<span class="opt-name">$this</span>-&gt;LoadTemplate(<span class="opt-name">$CurrVal</span>);
<span class="opt-name">$this</span>-&gt;MergeBlock(<span class="opt-value">'blk1'</span>,<span
class="opt-name">$GLOBALS</span>[<span class="opt-value">'conn_id'</span>],<span
class="opt-value">'SELECT * FROM table1'</span>);
<span class="opt-name">$this</span>-&gt;Show(); 
<span class="opt-html"></span></pre>
                  </td>
                </tr>
                <tr>
                  <th>Remarks:</th>
                  <td class="txt-small"><span class="opt-name">$CurrVal</span>
                    is a local variable provided by TBS when using parameter <span
                      class="opt-name">script</span> ; this variable is a
                    reference to the value of the field currently merged. In the
                    example above, <span class="opt-name">$CurrVal</span> has
                    the value of the global variable <span class="opt-name">$file</span>.
                    You can replace it, for example, by the name of the
                    subtemplate to load (for example: <span class="opt-value">'mysubtpl.htm'</span>).
                    See parameter <a href="#html_field_prm_script" class="opt-name">script</a>
                    for more information. </td>
                </tr>
              </tbody>
            </table>
            <span class="txt-code"></span></div>
          <p>Example <span class="txt-small">with parameter <span class="opt-name">onformat</span>:</span></p>
          <div class="decal">
            <table width="100%" cellspacing="0" cellpadding="4" border="0">
              <tbody>
                <tr>
                  <th width="120">HTML:</th>
                  <td>
                    <pre>[<span class="opt-name">onload</span>.user_mode;<span class="opt-name">onformat</span>=<span
class="opt-value">f_user_info</span>;<span class="opt-name">subtpl</span>]</pre>
                  </td>
                </tr>
                <tr>
                  <th>PHP user function:</th>
                  <td>
                    <pre class="txt-code">function f_user_info(<span class="opt-name">$FieldName</span>,&amp;<span
class="opt-name">$CurrVal</span>,&amp;<span class="opt-name">$CurrPrm</span>,&amp;<span
class="opt-name">$TBS</span>) {
  if ($CurrVal==1) { <span class="opt-html">// User is logged in</span>
    <span class="opt-name">$TBS</span>-&gt;LoadTemplate(<span class="opt-value">'user_info.htm'</span>);
    <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-value">'blk1'</span>,<span
class="opt-name">$GLOBALS</span>[<span class="opt-value">'conn_id'</span>],<span
class="opt-value">'SELECT * FROM table1'</span>);
    <span class="opt-name">$TBS</span>-&gt;Show();
  } else { <span class="opt-html">// User not logged in</span>
    echo(<span class="opt-value">'You are not logged in.'</span>);
  }
}</pre>
                  </td>
                </tr>
                <tr>
                  <th>Remarks:</th>
                  <td><span class="txt-small"><span class="opt-name">$CurrVal</span>
                      is a variable declared as an argument of the function.
                      It's TBS that is in charge to call this function making <span
                        class="opt-name">$CurrVal</span> referring to the value
                      of the fields currently merged. In this example above, <span
                        class="opt-name">$CurrVal</span> is equal to the global
                      variable <span class="opt-name">$user_mode</span>. In the
                      same way, variable <span class="opt-name">$CurrPrm</span>
                      is a reference to the array of parameters of the field
                      currently merged, and <span class="opt-name">$TBS</span>
                      is a reference to the TinyButStrong instance currently
                      used. See parameter <a href="#html_field_prm_script" class="opt-name">onformat</a>
                      for more information. </span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <h3><a id="html_conditional"></a>Conditional display overview:</h3>
        <div class="norm">
          <p>TinyButStrong offers several tools for conditional display for both
            fields and blocks. </p>
          <h4>Conditional fields</h4>
          <p> For any TBS fields you can use parameters for conditional display,
            recalled below. </p>
          <div class="decal">
            <table cellspacing="0" cellpadding="2" border="0">
              <tbody>
                <tr>
                  <th>Parameter</th>
                  <th>Description</th>
                </tr>
                <tr>
                  <td valign="top">. (dot) </td>
                  <td valign="top">Display an Html unbreakable space if the
                    field value is empty.</td>
                </tr>
                <tr>
                  <td valign="top"><span class="opt-name">ifempty</span>=<span class="opt-value">value2</span></td>
                  <td valign="top">Display <span class="opt-value">value2</span>
                    if the field value is empty.</td>
                </tr>
                <tr>
                  <td valign="top"><span class="opt-name">magnet</span>=<span class="opt-value">tag</span></td>
                  <td valign="top">Delete a tag or a pair of tags if the field
                    value is empty.</td>
                </tr>
                <tr>
                  <td valign="top"><span class="opt-name">if</span> <span class="opt-value">condition</span><br>
                    <span class="opt-name">then</span> <span class="opt-value">value1</span><br>
                    <span class="opt-name">else</span> <span class="opt-value">value2</span></td>
                  <td valign="top">Display <span class="opt-value">value1</span>
                    or <span class="opt-value">value2</span> depending on
                    whether the condition is verified or not.</td>
                </tr>
                <tr>
                  <td valign="top"><span class="opt-name">frm</span>=<span class="opt-value">format1</span>|<span
                      class="opt-value">format2</span>|<span class="opt-value">format3</span>|<span
                      class="opt-value">format4</span></td>
                  <td valign="top">Changes the numeric format or date/time
                    format depending on whether the value is positive, negative,
                    zero or empty. </td>
                </tr>
              </tbody>
            </table>
          </div>
          <br>
          <div class="decal">Example:<br>
            [<span class="opt-name">onshow.error_id</span>;<span class="opt-name">if</span>
            <span class="opt-value">[val]=0</span>;<span class="opt-name">then</span>
            <span class="opt-value">'no error'</span>;<span class="opt-name">else</span>
            <span class="opt-value">'error found'</span>] </div>
          <h4><a id="html_conditional_section"></a>Conditional sections</h4>
          <p> You can use conditional sections any TBS block (<a href="#html_block">data
              block</a> or <a href="#html_block_auto">automatic block</a>). A
            conditional section is a section which has a parameter <span class="opt-name">when</span>
            defining a condition, or parameter <span class="opt-name">default</span>.
            At the block's merging, each <span class="opt-name">when</span>
            condition of conditional sections is evaluated until one is
            verified. As soon as one <span class="opt-name">when</span>
            condition is verified, its conditional section is kept and other
            conditional sections are deleted. If no <span class="opt-name">when</span>
            condition is verified, then the <span class="opt-name">default</span>
            section is displayed if it exists. </p>
          <h5>• The case of data blocks:</h5>
          <p> If it is a data block, it means a block merged with <a href="#php_mergeblock">MergeBlock()</a>,
            then the conditional sections are reassessed for each record. It is
            even possible to define a data block with only conditional sections,
            with no standard section.</p>
          <h5>• Defining the conditions:</h5>
          <p> The conditions defined into parameters <span class="opt-name">when</span>
            can be expressions that contain <a href="#html_field_auto">[var]
              fields</a> et and linked fields (if it is a data block). See <a href="#html_block_prm_when">parameter
              when</a> for more details about operators supported by TBS.</p>
          <h5>• Section exclusivity: </h5>
          <p> By default conditional sections are exclusive inside a block. It
            means only one conditional section of a block can be displayed. But
            if you want a block to have non-exclusive conditional sections, you
            can use parameter <span class="opt-name">several</span> on the
            first conditional section. With this parameter, all conditions are
            evaluated and each true condition makes its section to be displayed.</p>
          <p> Example with a <a href="#html_block">data block</a>: </p>
          <div class="decal">
            <table class="border-1" width="600" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1"><span class="opt-html">Name: </span>[<span
                      class="opt-name">b1</span>.Name;<span class="opt-name">block</span>=tr]</td>
                  <td class="opt-html" valign="top">standard section</td>
                </tr>
                <tr>
                  <td class="border-1"><span class="opt-html">Address:</span><br>
                    [<span class="opt-name">b1</span>.add_line1;<span class="opt-name">block</span>=tr;<span
                      class="opt-name">when</span> [<span class="opt-name">b1.</span>address]=<span
                      class="opt-value">1</span>]<br>
                    [<span class="opt-name">b1</span>.add_line2]<br>
                    [<span class="opt-name">b1</span>.add_zip] - [<span class="opt-name">b1</span>.add_town]</td>
                  <td class="opt-html" valign="top">conditional section</td>
                </tr>
                <tr>
                  <td class="border-1"><span class="opt-html">No address.</span>[<span
                      class="opt-name">b1</span>;<span class="opt-name">block</span>=tr;<span
                      class="opt-name">default</span><span class="opt-value"></span>]</td>
                  <td class="opt-html" valign="top">default conditional section
                    (optional)</td>
                </tr>
              </tbody>
            </table>
          </div>
          <p>Example with an <a href="#html_block_auto">automatic block</a>: </p>
          <div class="decal">
            <table class="border-1" cellspacing="0" cellpadding="2">
              <tbody>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_err</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>email]='';<span class="opt-name">several</span>]<span
                      class="opt-html"> Your email is empty.</span></td>
                </tr>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_err</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">when</span>
                    [<span class="opt-name">var.</span>name]=<span class="opt-value">0</span>]<span
                      class="opt-html"> Your name is empty.</span></td>
                </tr>
                <tr>
                  <td class="border-1">[<span class="opt-name">onload_err</span>;<span
                      class="opt-name">block</span>=tr;<span class="opt-name">default</span>]
                    <span class="opt-html">All is ok.</span></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <a id="coding"></a>
        <h2 class="pagebreak">Improve TBS by coding:</h2>
        <p>You can add features to TinyButStrong using plug-ins. The <strong>database
            plug-ins</strong> simply enable the method MergeBlock() to recognize
          new types of database. The <strong>other plug-ins</strong> enable you
          to add features to TBS or to modify its main methods in order to make
          it more specialized. </p>
        <p> In both cases, a plug-in is made of a set of PHP functions or one
          PHP class which have to fit with a special syntax expected by TBS.
          Some plug-ins are proposed for download at the <a href="http://www.tinybutstrong.com">TinyButStrong
            web site</a>. </p>
        <h3><a name="coding_extended_methods"></a>Extended methods:</h3>
        <div class="norm">
          <p>Extended methods are custom methods that you can add to a
            TinyButStrong instance. This can be usefull for a plug-in for
            example.</p>
          <p class="versioning">Versioning: Extended methods are supported since
            TBS version 3.8. The feature needs PHP 5.0 or higher.</p>
          <p> Examples:</p>
          <p>
            If you define:<br>
            <span class="txt-code decal"><span class="opt-name">$TBS</span>-&gt;ExtendedMethods[<span
                class="opt-value">'newMethod1'</span>] = array(&amp;<span class="opt-name">$myObject</span>,
              <span class="opt-value">'myMethod'</span>);</span><br>
            then if you call:<br>
            <span class="txt-code decal"><span class="opt-name">$TBS</span>-&gt;newMethod1(<span
                class="opt-name">$x</span>);</span><br>
            it whill run :<br>
            <span class="txt-code decal"><span class="opt-name">$myObject</span>-&gt;myMethod(<span
                class="opt-name">$x</span>);</span>
          </p>
          <p>
            If you define: <br>
            <span class="txt-code decal"><span class="opt-name">$TBS</span>-&gt;ExtendedMethods[<span
                class="opt-value">'newMethod2'</span>] = <span class="opt-value">'myFunction'</span>;</span><br>
            then if you call:<br>
            <span class="txt-code decal"><span class="opt-name">$TBS</span>-&gt;newMethod(<span
                class="opt-name">$x</span>);</span><br>
            it whill run :<br>
            <span class="txt-code decal">myFunction(<span class="opt-name">$x</span>);</span><br>
          </p>
        </div>
        <h3><a name="coding_block_alias"></a>Block alias:</h3>
        <div class="norm">
          <p>A block alias is a special name for a block definition, which will
            be replaced with another list of tags or which will call a custom
            function to find the block bounds.<br>
            Block alias really empower the way of defining blocks. It is useful
            for plug-ins or when you want to simplify the understanding of the
            template coder.</p>
          <p class="versioning">Versioning: Block alias are supported since TBS
            version 3.8.</p>
          <p> Examples:</p>
          <pre class="txt-code"><span class="opt-name">$TBS</span>-&gt;SetOption(<span
class="opt-value">'block_alias'</span>, <span class="opt-value">'row'</span>, <span
class="opt-value">'tr'</span>); // the alias replace one tag
<span class="opt-name">$TBS</span>-&gt;SetOption(<span class="opt-value">'block_alias'</span>, <span
class="opt-value">'dblrow'</span>, <span class="opt-value">'tr+tr'</span>); // the alias replace several tags
<span class="opt-name">$TBS</span>-&gt;SetOption(<span class="opt-value">'block_alias'</span>, <span
class="opt-value">'my_alias'</span>, array(<span class="opt-name">$myObj</span>, <span
class="opt-value">'findBounds'</span>) ); // the alias call a custom function to find the bounds</pre>
          <p>Use in the template :</p>
          <pre><span class="opt-html">[blk1;block=row]</span> or <span class="opt-html">[blk1;block=row+row]</span> or even <span
class="opt-html">[blk1;block=th+row]</span>
<span class="opt-html">[blk2;block=dblrow]</span>
<span class="opt-html">[blk3;block=my_alias]</span>
  </pre>
          <h4>Defining a block alias with a function:</h4>
          <p>Example :</p>
          <pre class="txt-code"><span class="opt-value">class</span> clsTest {
<span class="opt-html"> /** 
  * Function findBound() will be call two times for finding the bounds of the block. Once with $Forward=true, and once with $Forward=false.
  * It is supposed to return the position of the inner bounds of the block. 
  * It can return false if an error occurs of if the template source is inconsistent for finding the block at the given position.
  *
  * @param string  $Tag The name of the block alias
  * @param string  $Txt The source of the template
  * @param integer $Pos The position of the TBS field in $Txt
  * @param boolean $Forward The direction of the search
  * @param mixed   $LevelStop Encapsulation level in a block of the same type. Ignore this in your code if your block type does not support self-encapsulation. 
  * @return integer
  */</span>
	<span class="opt-value">function</span> findBound($Tag, $Txt, $Pos, $Forward, $LevelStop) {
		if ($Forward) {
			<span class="opt-value">return</span> strpos($Txt, <span class="opt-value">'}'</span>, $Pos);
		} else {
			<span class="opt-value">return</span> strrpos(substr($Txt, 0, $Pos+1), <span
class="opt-value">'{'</span>);
		}
	}
}</pre>
          <p>&nbsp;</p>
        </div>
        <h3></h3>
        <h3><a id="plugins_db"></a><a name="plugins_data_reader"></a>Data Reader
          Plug-ins:</h3>
        <div class="norm">
          <p><span class="versioning">Versioning: Data Reader plug-ins are
              supported since TBS version 1.8.</span></p>
          <p>When you use <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
              class="opt-name">$BlockName</span>, <span class="opt-name">$Source</span>,
            <span class="opt-name">$Query</span>), TBS is first examining <span
              class="opt-name">$Source</span> to see if it supported as a data
            source. </p>
          <p>A Data Reader plug-in enables TBS to to recognize new data sources.</p>
          <p>You can found several examples of Data Reader plug-in at the <a href="http://www.tinybutstrong.com/plugins.php#plugin_db">TinyButStrong
              web site</a>.</p>
          <h4> Data Reader plug-in made with 3 PHP functions</h4>
          <p> Synopsis:</p>
          <pre>function <span class="tbsname">tbsdb_XXX_open</span>(&amp;<span class="opt-name">$Source</span>, &amp;<span
class="opt-name">$Query</span>) </pre>
          <div class="decal">This function is called one time by the MergeBlock
            process, before the other user functions.<br>
            It is supposed to use <span class="opt-name">$Source</span> and <span
              class="opt-name">$Query</span> to open a recordset, and return a
            reference of that recordset. </div>
          <pre>function <span class="tbsname">tbsdb_XXX_fetch</span>(&amp;<span
class="opt-name">$Rs</span> [,<span class="opt-name">$RecNum</span>]) </pre>
          <div class="decal">This function is called several times by the
            MergeBlock process, as many times as there are data to fetch from
            the query. <br>
            This function should return the next record as an associative array
            (column name=&gt; value), or return <span class="opt-value">false</span>
            if there is no record left.<br>
            <span class="opt-name">$Rs</span> is the value provided by <span class="tbsname">tbsdb_XXX_open</span>().
            It is commonly a recordset's reference.<br>
            <span class="opt-name">$RecNum</span> can be useful for some
            database type such as Oracle, for which the number of the record is
            needed to retrieve it. </div>
          <pre>function <span class="tbsname">tbsdb_XXX_close</span>(&amp;<span
class="opt-name">$Rs</span>) </pre>
          <div class="decal">This function is called on time by the MergeBlock
            process, after the other user functions. <br>
            This function should close the recordset properly. <br>
            <span class="opt-name">$Rs</span> is the value provided by <span class="tbsname">tbsdb_XXX_open</span>().
            It is commonly a recordset's reference.</div>
          <p>TBS will automatically use this Data Reader plug-in for <span class="opt-name">$TBS</span>-&gt;MergeBlock(<span
              class="opt-name">$BlockName</span>, <span class="opt-name">$Source</span>,
            <span class="opt-name">$Query</span>) when:</p>
          <ul>
            <li><span class="opt-name">$Source</span> is equal the string 'XXX'.</li>
            or
            <li><span class="opt-name">$Source</span> is a PHP ressource which
              type is named 'XXX'. Spaces are deleted and '-' are replaces with
              '_'.</li>
            or
            <li><span class="opt-name">$Source</span> is a PHP object which
              class is named 'XXX'.</li>
          </ul>
          <h4>Data Reader plug-in made with a class</h4>
          <p> Example with a direct object:</p>
          <pre class="decal">class MyCustomClass {
  function tbsdb_open(&amp;<span class="opt-name">$Source</span>, &amp;<span class="opt-name">$Query</span>) {...}
  function tbsdb_fetch(&amp;<span class="opt-name">$Rs</span> ,<span class="opt-name">$RecNum</span>) {...}
  function tbsdb_close(&amp;<span class="opt-name">$Rs</span>) {...}
}
<span class="opt-name">$Source</span> = new MyCustomClass();
<span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-name">$BlockName</span>, <span
class="opt-name">$Source</span>,<span class="opt-name"> $Query</span>);    </pre>
          <p>When the MergeBlock process meet of value for <span class="opt-name">$Source</span>
            which is an object, and have at least 3 methods named<span class="tbsname">tbsdb_open()</span>,
            <span class="tbsname">tbsdb_fetch()</span> and <span class="tbsname">tbsdb_close()</span>,
            then it assumes that the object is a Data Reader plug-in. There can
            be other methods and properties, but those 3 methods must have the
            same syntax and the same feature as the user functions described
            above.</p>
          <h4>Database plug-in based on property ObjectRef:</h4>
          <p> Example with an objet saved in ObjectRef:</p>
          <pre class="decal">class MyCustomClass {

  function XXX_open(&amp;<span class="opt-name">$Source</span>, &amp;<span class="opt-name">$Query</span>) {...}
  function XXX_fetch(&amp;<span class="opt-name">$Rs</span> ,<span class="opt-name">$RecNum</span>) {...}
  function XXX_close(&amp;<span class="opt-name">$Rs</span>) {...}

  function YYY_open(&amp;<span class="opt-name">$Source</span>, &amp;<span class="opt-name">$Query</span>) {...}
  function YYY_fetch(&amp;<span class="opt-name">$Rs</span> ,<span class="opt-name">$RecNum</span>) {...}
  function YYY_close(&amp;<span class="opt-name">$Rs</span>) {...}

}
<span class="opt-name">$TBS</span>-&gt;ObjectRef = new MyCustomClass();
...
<span class="opt-name">$TBS</span>-&gt;MergeBlock(<span class="opt-name">$BlockName</span>, <span
class="opt-value">'~XXX'</span>, <span class="opt-name">$Query</span>);</pre>
          When the MergeBlock process meet a value for <span class="opt-name">$Source</span>
          which is a string beginning with '~' then it assumes that property <span
            class="opt-name">$TBS-</span>&gt;ObjectRef is a Data Reader plug-in
          based on an object (see <a href="#php_oop">OOP</a>). The object must
          have the same requirements as a Data Reader plug-in based on objet
          described above, but the names of the methods can be different.</div>
        <h3><a id="plugins_tbs"></a>Other plug-ins:</h3>
        <div class="norm">
          <p class="versioning">Versioning: plug-ins are supported since TBS
            version 3.0.</p>
          <h4><span class="zone-normal">Coding a plug-in using a PHP class:</span></h4>
          <h5>• Plug-in's key:</h5>
          <p><span class="zone-normal"> Each plug-in has a plug-in key which is
              the name of its Php class. This key must be given to the method <a
                href="#php_plugin">PlugIn()</a> when you use it. Thus, it is
              recommended to define a PHP constant for the plug-in's key (see
              example below).</span></p>
          <h5>• Plug-in events:</h5>
          <p><span class="zone-normal"> A TBS plug-in must be a PHP class which
              contains one or several specific methods that will be recognized
              and plugged by TBS. Those specific methods are called plug-in
              events because they are executed automatically by TBS when the
              corresponding event occurs. A TBS plug-in can also have other
              methods and properties for internal purpose. A TBS plug-in must
              have at least the OnInstall event. </span></p>
          <p><span class="zone-normal"> For example: </span> </p>
          <pre class="decal txt-code"><span class="opt-html">// TBS plug-in XXX </span>
<span class="opt-name">define</span>(<span class="opt-value">'TBS_XXX'</span>,<span
class="opt-value">'clsTbsPlugIng_XXX'</span>); <span class="opt-html">// That is the plug-in's key</span> 
<span class="opt-name">class</span> clsTbsPlugIng_XXX() {
  <span class="opt-name">function</span> OnInstall(...) {...} <span class="opt-html">// That is the OnInstall event</span> 
  ...
}</pre>
          <p><span class="zone-normal"> See the PHP file <span class="opt-html">"tbs_plugin_syntaxes"</span>
              to have all plug-in events, their usage and expected arguments.
              There is also a list of supported events at the bottom of this
              section. </span></p>
          <p><span class="zone-normal"> The OnInstall event is special. It has
              to return an array with all activated events for the current
              plug-in (see the PHP file <span class="opt-html">"tbs_plugin_syntaxes"</span>).
              The OnInstall event is called when the plug-in is installed at the
              TBS instance.</span></p>
          <p><span class="zone-normal"> This event can be called in three
              situations:</span></p>
          <ul>
            <li><span class="zone-normal"> When using method <a href="#php_plugin">PlugIn()
                  </a>with the plug-in's key for the first time.</span></li>
            <li><span class="zone-normal"> When using method PlugIn() with the
                plug-in's key and the argument TBS_INSTALL.</span></li>
            <li><span class="zone-normal"> When a new TBS instance is created,
                if the plug-in's key has be added to the global array <span class="opt-name">$_TBS_AutoInstallPlugIns[]</span>
                (see file <span class="opt-html">"tbs_plugin_syntaxes.php"</span>
                for more details). </span></li>
          </ul>
          <h5>• Property -&gt;TBS:</h5>
          <p> As soon as the plug-in is installed on the TBS instance, a
            property <span class="opt-name"><span class="txt-code">-&gt;TBS</span></span>
            is automatically added to the plug-in, its value is a reference to
            the parent TBS instance. Remember this because this property can be
            very useful inside the plug-in's code. </p>
          <h4>Coding a plug-in using PHP functions: </h4>
          <p> The plug-ins' key is a string that you choose and which will be
            used for naming the function. <span class="zone-normal">It is
              recommended to define a PHP constant for the plug-in's key (see
              example below).</span></p>
          <p> The plug-in events are coded using functions, and they names must
            be the string 'tbspi_', followed by the plug-in's key, followed by
            '_' and the event's name. </p>
          <p> Example: </p>
          <pre class="decal txt-code"><span class="opt-name">define</span>(<span
class="opt-value">'TBS_XXX'</span>,<span class="opt-value"> 'xxx'</span>);
<span class="opt-name">function</span> tbspi_xxx_OnInstall(...) {...}
...</pre>
          <p>All the rest works like for plug-in coded with a class. You must
            have at least the event OnInstall created, and it works the same
            way. </p>
          <p><em>Remark:</em> PHP functions are often faster than methods, but
            they don't let you having a -&gt;TBS property to reach the parent
            TBS instance.</p>
          <h5>• List of plug-in events:</h5>
          <table width="100%" cellspacing="0" cellpadding="4" border="0">
            <tbody>
              <tr>
                <th width="10">&nbsp;</th>
                <th width="120">Plug-in Events </th>
                <th>Description</th>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnInstall</td>
                <td>Executed automatically when the plug-in is called for the
                  first time, or when PlugIn() method is called with the
                  specific argument for installing. </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnCommand</td>
                <td>Executed when PlugIn() method is called. This is a way to
                  execute any user command specific to the plug-in. </td>
              </tr>
              <tr>
                <td width="10" valign="top">•</td>
                <td valign="top">BeforeLoadTemplate</td>
                <td>Executed when LoadTemplate() method is called. Can cancel
                  TBS basic process. </td>
              </tr>
              <tr>
                <td width="10" valign="top">•</td>
                <td valign="top">AfterLoadTemplate </td>
                <td>Executed at the end of LoadTemplate(). </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">BeforeShow</td>
                <td>Executed when Show() method is called. Can cancel TBS basic
                  process. </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">AfterShow</td>
                <td>Executed at the end of Show(). </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnData</td>
                <td>Executed each time a record of data is retrieved for a
                  MergeBlock() process. (similar to parameter 'ondata' but for
                  every block) </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnFormat</td>
                <td>Executed each time a fields is being merged. (similar to
                  parameter 'onformat' but for every fields) </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnOperation</td>
                <td>Executed each time parameter 'ope' is defined with an
                  unsupported keyword.</td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnCacheField</td>
                <td>Executed each time a field is put in the cache of a Block
                  definition. (<span class="versioning">supported since TBS
                    3.6.0</span>)</td>
              </tr>
              <tr>
                <td width="10" valign="top">•</td>
                <td valign="top">BeforeMergeBlock</td>
                <td>Executed when bounds of a block are founded. Can cancel TBS
                  basic process. </td>
              </tr>
              <tr>
                <td width="10" valign="top">•</td>
                <td valign="top">OnMergeSection</td>
                <td>Executed when a section is merged, and before it is added to
                  other sections. </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnMergeGroup</td>
                <td>Executed before a header, a footer or a splitter section is
                  merged. (<span class="versioning">supported since TBS 3.3.0</span>)</td>
              </tr>
              <tr>
                <td width="10" valign="top">•</td>
                <td valign="top">AfterMergeBlock</td>
                <td>Executed just before a merged block is inserted into the
                  template. </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnSpecialVar</td>
                <td>Executed when a non native Special Var Field (like
                  [onshow..now]) is met. </td>
              </tr>
              <tr>
                <td valign="top">•</td>
                <td valign="top">OnMergeField</td>
                <td>Executed on each field met when using the MergeField()
                  method.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <a id="summaries"></a>
        <h2 class="pagebreak">Summary:</h2>
        <h3><a id="appendix_field"></a>TBS Field's parameters:</h3>
        <div class="norm">
          <table width="100%" cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th width="80">Parameter</th>
                <th>Summary</th>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_strconv"
                    class="opt-name">strconv</a></td>
                <td align="left" valign="top">
                  <p>Char conversion Mode for the field's value.</p>
                </td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_htmlconv"
                    class="opt-name">htmlconv</a></td>
                <td align="left" valign="top">Deprecated, alias of <span class="opt-name">strconv</span>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_dot" class="opt-name">.
                  </a>(dot)</td>
                <td align="left" valign="top">If the value is empty, then
                  display an unbreakable space.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_ifempty"
                    class="opt-name">ifempty</a></td>
                <td align="left" valign="top">If the value is empty, then
                  display another value.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_att" class="opt-name">att</a></td>
                <td align="left" valign="top">Move the field into the attribute
                  of an XML/HTML tag.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;attadd</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">att</span>.
                  Indicate that the merged value must be added instead of be
                  replacing the attribute's value.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_atttrue" class="opt-name">atttrue</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">att</span>.
                  Indicate that the target attribute must be managed as a
                  boolean attribute.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_magnet" class="opt-name">magnet</a></td>
                <td align="left" valign="top">If the value is empty, then delete
                  surrounding element.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_mtype" class="opt-name">mtype</a></td>
                <td align="left" valign="top">Use with <a href="#html_field_prm_magnet"
                    class="opt-name">magnet</a>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_if" class="opt-name">if</a></td>
                <td align="left" valign="top">If the condition is verified, then
                  change the value.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_then" class="opt-name">
                  </a><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_then" class="opt-name">then</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">if</span>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_else" class="opt-name">
                  </a><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_else" class="opt-name">else</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">if</span>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_onformat"
                    class="opt-name">onformat</a></td>
                <td align="left" valign="top">Executes a Php user function to
                  modify the field merging.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_frm" class="opt-name">frm</a></td>
                <td align="left" valign="top">Apply a date-time or a numeric
                  format.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_combo" class="opt-name">combo</a></td>
                <td align="left" valign="top">Apply a set of predefined
                  parameters.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_tplfrms"
                    class="opt-name">tplfrms</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">onload
                    </span>fields only. Define template formats.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_tplvars"
                    class="opt-name">tplvars</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">onload
                    </span>fields only. Define template variables.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_protect"
                    class="opt-name">protect</a></td>
                <td align="left" valign="top">Protection mode for characters
                  '['.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_comm" class="opt-name">enlarge</a></td>
                <td align="left" valign="top">Enlarges the field's bounds up to
                  the Commentary tag that surround it.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_comm" class="opt-name">comm</a></td>
                <td align="left" valign="top">Deprecated, alias of <a href="#html_field_prm_comm"
                    class="opt-name">enlarge</a>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_noerr" class="opt-name">noerr</a></td>
                <td align="left" valign="top">Avoid some TBS error messages.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_file" class="opt-name">file</a></td>
                <td align="left" valign="top">Includes the contents of the file.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_script" class="opt-name">script</a></td>
                <td align="left" valign="top">Executes the Php script.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_getpart" class="opt-name">getpart</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">file</span>
                  or <span class="opt-name">script</span>. Insert only a part
                  of the subtemplate. </td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_getbody" class="opt-name">getbody</a></td>
                <td align="left" valign="top">Deprecated, alias of <span class="opt-name">getpart</span>.</td>
              </tr>
              <tr>
                <td align="left" valign="top"> <a href="#html_field_prm_attadd"
                    class="opt-name">&nbsp;&nbsp;&nbsp;</a><a href="#html_field_prm_store"
                    class="opt-name">store</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">file</span>
                  or <span class="opt-name">script</span>. Store a part of the
                  subtemplate in order to display it elsewhere.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_storename" class="opt-name">storename</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">store</span>.
                  Change the name of the store.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_rename" class="opt-name">rename</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">file</span>
                  or <span class="opt-name">script</span>. Rename TBS block and
                  fields in a subtemplate. </td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_field_prm_subtpl" class="opt-name">subtpl</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">script</span>
                  or <span class="opt-name">onformat</span>. Turns the TBS
                  instance into subtemplate mode. </td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3><a id="appendix_block"></a>TBS Block's parameters:</h3>
        <div class="norm">
          <table width="100%" cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th width="80">Parameter</th>
                <th>Summary</th>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_block" class="opt-name">block</a></td>
                <td align="left" valign="top">Defines the block's bounds.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_nodata" class="opt-name">nodata</a></td>
                <td align="left" valign="top">Indicates the section that is
                  displayed when there is no data in the data source.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_bmagnet"
                    class="opt-name">bmagnet</a></td>
                <td align="left" valign="top">If there is no data, then delete
                  the surrounding element.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_headergrp"
                    class="opt-name">headergrp</a></td>
                <td align="left" valign="top">Indicates a header section that is
                  displayed when the value of a column changes.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_footergrp"
                    class="opt-name">footergrp</a></td>
                <td align="left" valign="top">Indicates a footer section that is
                  displayed when the value of a column changes.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_splittergrp"
                    class="opt-name">splittergrp</a></td>
                <td align="left" valign="top">Indicates a splitter section that
                  is displayed when the value of a column changes.</td>
              </tr>
              <tr id="v202_parentgrp_sum">
                <td align="left" valign="top"><a href="#html_block_prm_parentgrp"
                    class="opt-name">parentgrp</a></td>
                <td align="left" valign="top">Indicates a parent section that is
                  displayed when the value of a column changes.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_splittergrp"
                    class="opt-name">firstingrp</a></td>
                <td align="left" valign="top">Indicates a section that replaces
                  the normal section when the value of a column changes.</td>
              </tr>
              <tr id="v202_parentgrp_sum2">
                <td align="left" valign="top"><a href="#html_block_prm_parentgrp"
                    class="opt-name">lastingrp</a></td>
                <td align="left" valign="top">Indicates a section that replaces
                  the normal section when the value of a column changes.</td>
              </tr>
              <tr id="v202_parentgrp_sum3">
                <td align="left" valign="top"><a href="#html_block_prm_singleingrp"
                    class="opt-name">singleingrp</a></td>
                <td align="left" valign="top">Indicates a section that replaces
                  the normal section when the value of a column changes.</td>
              </tr>
              <tr>
                <td class="opt-name" align="left" valign="top"><a href="#html_block_prm_parallel"
                    class="opt-name">parallel</a></td>
                <td align="left" valign="top">Indicates a configuration for
                  merging data in columns or with any custom parallel method.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_serial" class="opt-name">serial</a></td>
                <td align="left" valign="top">Indicates a section that contains
                  a series of several records.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_p1" class="opt-name">p1</a></td>
                <td align="left" valign="top">Sends a parameter to the dynamic
                  query for the data source.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_sub1" class="opt-name">sub1</a></td>
                <td align="left" valign="top">Define the column containing the
                  data for an automatic subblock.</td>
              </tr>
              <tr id="v205_ondata_sum">
                <td align="left" valign="top"><a href="#html_block_prm_ondata" class="opt-name">ondata</a></td>
                <td align="left" valign="top">Executes a Php user function to
                  modify the record when it has just been taken from the data
                  source.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_block_prm_when" class="opt-name">when</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">onload
                    </span>or <span class="opt-name">onshow</span>. Displays
                  the section when the condition is verified.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_block_prm_default" class="opt-name">default</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">onload
                    </span>or <span class="opt-name">onshow</span>. Displays
                  the section when no section is displayed.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_attadd" class="opt-name">&nbsp;&nbsp;&nbsp;</a><a
                    href="#html_block_prm_several" class="opt-name">several</a></td>
                <td align="left" valign="top">Use with <span class="opt-name">when</span>.
                  Indicate that several blocks of the group can be displayed.</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3><a id="appendix_specialname"></a>Names of Special Fields and Blocks:</h3>
        <div class="norm">
          <table cellspacing="0" cellpadding="5" border="0">
            <tbody>
              <tr>
                <th width="140">Name</th>
                <th>Summary</th>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_prm_if" class="opt-name">val</a></td>
                <td align="left" valign="top">The keyword [val] can be used in
                  field's parameters to represent the field's value.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#php_mergeblock_counting"
                    class="opt-name">#</a></td>
                <td align="left" valign="top">Virtual column name for a block.
                  It displays the record's number. </td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#php_mergeblock_counting"
                    class="opt-name">$</a></td>
                <td align="left" valign="top">Virtual column name for a block.
                  It displays the record's key if the data source is a Php
                  Array.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_auto" class="opt-name">onload</a></td>
                <td align="left" valign="top">Automatic field or block, merged
                  when the template is loaded.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_auto" class="opt-name">onshow</a></td>
                <td align="left" valign="top">Automatic field or block, merged
                  when the template is shown.</td>
              </tr>
              <tr>
                <td align="left" valign="top"><a href="#html_field_auto" class="opt-name">var</a></td>
                <td align="left" valign="top">Embedded automatic field.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </body>
</html>
